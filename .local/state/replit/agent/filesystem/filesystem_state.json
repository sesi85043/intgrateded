{"file_contents":{"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 220 15% 98%;\n  --foreground: 220 15% 12%;\n  --border: 220 15% 92%;\n  --card: 220 15% 97%;\n  --card-foreground: 220 15% 12%;\n  --card-border: 220 15% 94%;\n  --sidebar: 220 15% 95%;\n  --sidebar-foreground: 220 15% 12%;\n  --sidebar-border: 220 15% 91%;\n  --sidebar-primary: 217 91% 45%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 220 15% 88%;\n  --sidebar-accent-foreground: 220 15% 12%;\n  --sidebar-ring: 217 91% 45%;\n  --popover: 220 15% 94%;\n  --popover-foreground: 220 15% 12%;\n  --popover-border: 220 15% 90%;\n  --primary: 217 91% 45%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 220 15% 90%;\n  --secondary-foreground: 220 15% 12%;\n  --muted: 220 12% 93%;\n  --muted-foreground: 220 12% 35%;\n  --accent: 220 12% 91%;\n  --accent-foreground: 220 12% 12%;\n  --destructive: 0 84% 42%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 220 15% 75%;\n  --ring: 217 91% 45%;\n  --chart-1: 217 91% 35%;\n  --chart-2: 142 76% 30%;\n  --chart-3: 280 65% 38%;\n  --chart-4: 35 91% 40%;\n  --chart-5: 340 82% 38%;\n  --font-sans: Inter, system-ui, -apple-system, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 15% 12% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 15% 12% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 15% 12% / 0.00), 0px 1px 2px -1px hsl(220 15% 12% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 15% 12% / 0.00), 0px 1px 2px -1px hsl(220 15% 12% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 15% 12% / 0.00), 0px 2px 4px -1px hsl(220 15% 12% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 15% 12% / 0.00), 0px 4px 6px -1px hsl(220 15% 12% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 15% 12% / 0.00), 0px 8px 10px -1px hsl(220 15% 12% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 15% 12% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 220 15% 8%;\n  --foreground: 220 15% 95%;\n  --border: 220 15% 16%;\n  --card: 220 15% 10%;\n  --card-foreground: 220 15% 95%;\n  --card-border: 220 15% 13%;\n  --sidebar: 220 15% 12%;\n  --sidebar-foreground: 220 15% 95%;\n  --sidebar-border: 220 15% 16%;\n  --sidebar-primary: 217 91% 55%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 220 15% 18%;\n  --sidebar-accent-foreground: 220 15% 95%;\n  --sidebar-ring: 217 91% 55%;\n  --popover: 220 15% 14%;\n  --popover-foreground: 220 15% 95%;\n  --popover-border: 220 15% 18%;\n  --primary: 217 91% 45%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 220 15% 20%;\n  --secondary-foreground: 220 15% 95%;\n  --muted: 220 12% 18%;\n  --muted-foreground: 220 12% 70%;\n  --accent: 220 12% 16%;\n  --accent-foreground: 220 12% 95%;\n  --destructive: 0 84% 35%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 220 15% 30%;\n  --ring: 217 91% 55%;\n  --chart-1: 217 91% 70%;\n  --chart-2: 142 76% 65%;\n  --chart-3: 280 65% 70%;\n  --chart-4: 35 91% 68%;\n  --chart-5: 340 82% 68%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 15% 95% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 15% 95% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 15% 95% / 0.00), 0px 1px 2px -1px hsl(220 15% 95% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 15% 95% / 0.00), 0px 1px 2px -1px hsl(220 15% 95% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 15% 95% / 0.00), 0px 2px 4px -1px hsl(220 15% 95% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 15% 95% / 0.00), 0px 4px 6px -1px hsl(220 15% 95% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 15% 95% / 0.00), 0px 8px 10px -1px hsl(220 15% 95% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 15% 95% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":10798},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/pages/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { \n  Users, \n  Activity, \n  CheckCircle2, \n  AlertCircle, \n  RefreshCw, \n  Database, \n  MessageSquare, \n  FormInput, \n  Mail,\n  ClipboardList,\n  Clock,\n  Building2,\n  UserCheck,\n  BarChart3,\n  ArrowRight\n} from \"lucide-react\";\nimport type { ServiceConfig, ActivityLog, Task, TeamMember, Department } from \"@shared/schema\";\n\nfunction TechnicianDashboard() {\n  const { teamMember } = useAuth();\n\n  const { data: myTasks = [], isLoading: tasksLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\"],\n  });\n\n  const assignedToMe = myTasks.filter(t => t.assignedToId === teamMember?.id);\n  const pendingTasks = assignedToMe.filter(t => t.status === 'pending' || t.status === 'in_progress');\n  const completedTasks = assignedToMe.filter(t => t.status === 'completed');\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">\n          Welcome, {teamMember?.firstName}\n        </h1>\n        <p className=\"text-muted-foreground mt-1\">\n          {teamMember?.departmentName} Department - Technician Dashboard\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Assigned Tasks</CardTitle>\n            <ClipboardList className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-assigned-tasks\">\n              {assignedToMe.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Total assigned to you\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">In Progress</CardTitle>\n            <Clock className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-tasks\">\n              {pendingTasks.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Pending completion\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Completed</CardTitle>\n            <CheckCircle2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-tasks\">\n              {completedTasks.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Tasks finished\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n          <div>\n            <CardTitle>My Tasks</CardTitle>\n            <CardDescription>Tasks assigned to you</CardDescription>\n          </div>\n          <Link href=\"/tasks\">\n            <Button variant=\"outline\" size=\"sm\">\n              View All <ArrowRight className=\"ml-2 h-4 w-4\" />\n            </Button>\n          </Link>\n        </CardHeader>\n        <CardContent>\n          {tasksLoading ? (\n            <div className=\"space-y-3\">\n              {[1, 2, 3].map((i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          ) : pendingTasks.length > 0 ? (\n            <div className=\"space-y-3\">\n              {pendingTasks.slice(0, 5).map((task) => (\n                <div\n                  key={task.id}\n                  className=\"flex items-center justify-between p-3 rounded-md border border-border\"\n                  data-testid={`task-${task.id}`}\n                >\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium truncate\">{task.title}</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Priority: {task.priority} | Due: {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : 'No due date'}\n                    </p>\n                  </div>\n                  <Badge variant={task.status === 'in_progress' ? 'default' : 'secondary'}>\n                    {task.status.replace('_', ' ')}\n                  </Badge>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <CheckCircle2 className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n              <p>No pending tasks</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nfunction DepartmentAdminDashboard() {\n  const { teamMember } = useAuth();\n\n  const { data: tasks = [], isLoading: tasksLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\"],\n  });\n\n  const { data: teamMembers = [] } = useQuery<TeamMember[]>({\n    queryKey: [\"/api/team-members\"],\n  });\n\n  const deptTasks = tasks.filter(t => t.departmentId === teamMember?.departmentId);\n  const deptMembers = teamMembers.filter(m => m.departmentId === teamMember?.departmentId);\n  const activeTechnicians = deptMembers.filter(m => m.role === 'technician' && m.status === 'active');\n  const pendingTasks = deptTasks.filter(t => t.status === 'pending' || t.status === 'in_progress');\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">\n          {teamMember?.departmentName} Dashboard\n        </h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Department overview and management\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Team Members</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-team-members\">\n              {deptMembers.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              In your department\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active Technicians</CardTitle>\n            <UserCheck className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-technicians\">\n              {activeTechnicians.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Available for tasks\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Department Tasks</CardTitle>\n            <ClipboardList className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-dept-tasks\">\n              {deptTasks.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Total tasks\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Pending Tasks</CardTitle>\n            <Clock className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-dept-tasks\">\n              {pendingTasks.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Need attention\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <div>\n              <CardTitle>Team Members</CardTitle>\n              <CardDescription>Your department team</CardDescription>\n            </div>\n            <Link href=\"/team\">\n              <Button variant=\"outline\" size=\"sm\">\n                Manage <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </Link>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {deptMembers.slice(0, 5).map((member) => (\n                <div\n                  key={member.id}\n                  className=\"flex items-center justify-between p-3 rounded-md border border-border\"\n                  data-testid={`member-${member.id}`}\n                >\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium\">{member.firstName} {member.lastName}</p>\n                    <p className=\"text-xs text-muted-foreground capitalize\">{member.role}</p>\n                  </div>\n                  <Badge variant={member.status === 'active' ? 'default' : 'secondary'}>\n                    {member.status}\n                  </Badge>\n                </div>\n              ))}\n              {deptMembers.length === 0 && (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Users className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                  <p>No team members</p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <div>\n              <CardTitle>Recent Tasks</CardTitle>\n              <CardDescription>Department task activity</CardDescription>\n            </div>\n            <Link href=\"/tasks\">\n              <Button variant=\"outline\" size=\"sm\">\n                View All <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </Link>\n          </CardHeader>\n          <CardContent>\n            {tasksLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3].map((i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : deptTasks.length > 0 ? (\n              <div className=\"space-y-3\">\n                {deptTasks.slice(0, 5).map((task) => (\n                  <div\n                    key={task.id}\n                    className=\"flex items-center justify-between p-3 rounded-md border border-border\"\n                    data-testid={`task-${task.id}`}\n                  >\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"font-medium truncate\">{task.title}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        Priority: {task.priority}\n                      </p>\n                    </div>\n                    <Badge variant={task.status === 'completed' ? 'default' : 'secondary'}>\n                      {task.status.replace('_', ' ')}\n                    </Badge>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <ClipboardList className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>No tasks yet</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\nfunction ManagementDashboard() {\n  const { data: services, isLoading: servicesLoading } = useQuery<ServiceConfig[]>({\n    queryKey: [\"/api/services\"],\n  });\n\n  const { data: recentActivity, isLoading: activityLoading } = useQuery<ActivityLog[]>({\n    queryKey: [\"/api/activity/recent\"],\n  });\n\n  const { data: stats } = useQuery<{\n    totalUsers: number;\n    activeUsers: number;\n    totalActivities: number;\n    servicesEnabled: number;\n  }>({\n    queryKey: [\"/api/stats\"],\n  });\n\n  const { data: departments = [] } = useQuery<Department[]>({\n    queryKey: [\"/api/departments\"],\n  });\n\n  const { data: teamMembers = [] } = useQuery<TeamMember[]>({\n    queryKey: [\"/api/team-members\"],\n  });\n\n  const { data: tasks = [] } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\"],\n  });\n\n  const platformIcons = {\n    metabase: Database,\n    chatwoot: MessageSquare,\n    typebot: FormInput,\n    mailcow: Mail,\n  };\n\n  const activeDepts = departments.filter(d => d.status === 'active');\n  const totalTechnicians = teamMembers.filter(m => m.role === 'technician').length;\n  const pendingTasks = tasks.filter(t => t.status === 'pending' || t.status === 'in_progress');\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">Global Dashboard</h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Management overview across all departments\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Departments</CardTitle>\n            <Building2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-departments\">\n              {activeDepts.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Active departments\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Team Members</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-team\">\n              {teamMembers.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {totalTechnicians} technicians\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Tasks</CardTitle>\n            <ClipboardList className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-tasks\">\n              {tasks.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {pendingTasks.length} pending\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Services Online</CardTitle>\n            <RefreshCw className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-services-online\">\n              {stats?.servicesEnabled ?? 0}/4\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Connected platforms\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <div>\n              <CardTitle>Departments</CardTitle>\n              <CardDescription>Organization structure</CardDescription>\n            </div>\n            <Link href=\"/departments\">\n              <Button variant=\"outline\" size=\"sm\">\n                Manage <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </Link>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {departments.map((dept) => {\n                const deptMembers = teamMembers.filter(m => m.departmentId === dept.id);\n                const deptTasks = tasks.filter(t => t.departmentId === dept.id);\n                return (\n                  <div\n                    key={dept.id}\n                    className=\"p-3 rounded-md border border-border\"\n                    data-testid={`dept-${dept.id}`}\n                  >\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"font-medium\">{dept.name}</p>\n                      <Badge variant=\"outline\">{dept.code}</Badge>\n                    </div>\n                    <div className=\"flex gap-4 text-xs text-muted-foreground\">\n                      <span>{deptMembers.length} members</span>\n                      <span>{deptTasks.length} tasks</span>\n                    </div>\n                  </div>\n                );\n              })}\n              {departments.length === 0 && (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Building2 className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                  <p>No departments</p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Service Status</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {servicesLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {services?.map((service) => {\n                  const Icon = platformIcons[service.serviceName as keyof typeof platformIcons] || Database;\n                  return (\n                    <div\n                      key={service.id}\n                      className=\"flex items-center justify-between p-3 rounded-md border border-border\"\n                      data-testid={`service-status-${service.serviceName}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-muted\">\n                          <Icon className=\"h-5 w-5 text-muted-foreground\" />\n                        </div>\n                        <div>\n                          <p className=\"font-medium capitalize\">{service.serviceName}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {service.lastSyncAt\n                              ? `Synced ${new Date(service.lastSyncAt).toLocaleString()}`\n                              : \"Never synced\"}\n                          </p>\n                        </div>\n                      </div>\n                      <Badge variant={service.enabled ? \"default\" : \"secondary\"}>\n                        {service.enabled ? \"Active\" : \"Inactive\"}\n                      </Badge>\n                    </div>\n                  );\n                })}\n                {(!services || services.length === 0) && (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <AlertCircle className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                    <p>No services configured</p>\n                    <Link href=\"/config\">\n                      <Button variant=\"ghost\" className=\"mt-2\">\n                        Configure Services\n                      </Button>\n                    </Link>\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n            <div>\n              <CardTitle>Recent Activity</CardTitle>\n              <CardDescription>System-wide activity</CardDescription>\n            </div>\n            <Link href=\"/activity\">\n              <Button variant=\"outline\" size=\"sm\">\n                View All <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </Link>\n          </CardHeader>\n          <CardContent>\n            {activityLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4, 5].map((i) => (\n                  <Skeleton key={i} className=\"h-12 w-full\" />\n                ))}\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {recentActivity?.slice(0, 5).map((activity) => (\n                  <div\n                    key={activity.id}\n                    className=\"flex items-start gap-3 p-3 rounded-md border border-border\"\n                    data-testid={`activity-${activity.id}`}\n                  >\n                    <Activity className=\"h-4 w-4 text-muted-foreground mt-0.5\" />\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm font-medium truncate\">{activity.action}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {activity.platform && <span className=\"capitalize\">{activity.platform}</span>}\n                        {activity.platform && \" | \"}\n                        {activity.createdAt && new Date(activity.createdAt).toLocaleTimeString()}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n                {(!recentActivity || recentActivity.length === 0) && (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Activity className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                    <p>No recent activity</p>\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\nexport default function Dashboard() {\n  const { isManagement, isDepartmentAdmin, isTechnician, isLoading, teamMember } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <Skeleton className=\"h-10 w-64\" />\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <Skeleton key={i} className=\"h-32 w-full\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (!teamMember) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\n          <h2 className=\"text-xl font-semibold\">Access Denied</h2>\n          <p className=\"text-muted-foreground mt-2\">\n            Your account is not linked to a team member profile.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (isManagement) {\n    return <ManagementDashboard />;\n  }\n\n  if (isDepartmentAdmin) {\n    return <DepartmentAdminDashboard />;\n  }\n\n  if (isTechnician) {\n    return <TechnicianDashboard />;\n  }\n\n  return <TechnicianDashboard />;\n}\n","size_bytes":23966},"client/src/pages/analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  BarChart3,\n  TrendingUp,\n  TrendingDown,\n  Database,\n  MessageSquare,\n  FormInput,\n  Mail,\n} from \"lucide-react\";\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, LineChart, Line } from \"recharts\";\n\nexport default function Analytics() {\n  const { data: metrics, isLoading } = useQuery<any>({\n    queryKey: [\"/api/analytics/metrics\"],\n  });\n\n  const platformData = [\n    { name: \"Metabase\", users: metrics?.metabase?.users || 0, active: metrics?.metabase?.active || 0, icon: Database },\n    { name: \"Chatwoot\", users: metrics?.chatwoot?.users || 0, active: metrics?.chatwoot?.active || 0, icon: MessageSquare },\n    { name: \"Typebot\", users: metrics?.typebot?.users || 0, active: metrics?.typebot?.active || 0, icon: FormInput },\n    { name: \"Mailcow\", users: metrics?.mailcow?.users || 0, active: metrics?.mailcow?.active || 0, icon: Mail },\n  ];\n\n  const conversationData = [\n    { month: \"Jan\", count: 45 },\n    { month: \"Feb\", count: 52 },\n    { month: \"Mar\", count: 61 },\n    { month: \"Apr\", count: 55 },\n    { month: \"May\", count: 67 },\n    { month: \"Jun\", count: 73 },\n  ];\n\n  const submissionData = [\n    { day: \"Mon\", count: 12 },\n    { day: \"Tue\", count: 19 },\n    { day: \"Wed\", count: 15 },\n    { day: \"Thu\", count: 22 },\n    { day: \"Fri\", count: 18 },\n    { day: \"Sat\", count: 8 },\n    { day: \"Sun\", count: 6 },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">Analytics</h1>\n        <p className=\"text-muted-foreground mt-1\">Monitor platform performance and user engagement</p>\n      </div>\n\n      <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"overview\" data-testid=\"tab-overview\">Overview</TabsTrigger>\n          <TabsTrigger value=\"metabase\" data-testid=\"tab-metabase\">Metabase</TabsTrigger>\n          <TabsTrigger value=\"chatwoot\" data-testid=\"tab-chatwoot\">Chatwoot</TabsTrigger>\n          <TabsTrigger value=\"typebot\" data-testid=\"tab-typebot\">Typebot</TabsTrigger>\n          <TabsTrigger value=\"mailcow\" data-testid=\"tab-mailcow\">Mailcow</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"overview\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            {platformData.map((platform) => {\n              const Icon = platform.icon;\n              const growth = platform.active > 0\n                ? ((platform.active / platform.users) * 100).toFixed(1)\n                : \"0\";\n              return (\n                <Card key={platform.name}>\n                  <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">{platform.name}</CardTitle>\n                    <Icon className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{platform.users}</div>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {platform.active} active\n                      </Badge>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {growth}%\n                      </span>\n                    </div>\n                  </CardContent>\n                </Card>\n              );\n            })}\n          </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Conversations Trend</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <Skeleton className=\"h-80 w-full\" />\n                ) : (\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <LineChart data={conversationData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-border\" />\n                      <XAxis\n                        dataKey=\"month\"\n                        className=\"text-xs\"\n                        tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                      />\n                      <YAxis\n                        className=\"text-xs\"\n                        tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                      />\n                      <Tooltip\n                        contentStyle={{\n                          backgroundColor: \"hsl(var(--popover))\",\n                          border: \"1px solid hsl(var(--border))\",\n                          borderRadius: \"6px\",\n                        }}\n                      />\n                      <Line\n                        type=\"monotone\"\n                        dataKey=\"count\"\n                        stroke=\"hsl(var(--primary))\"\n                        strokeWidth={2}\n                        dot={{ fill: \"hsl(var(--primary))\", r: 4 }}\n                      />\n                    </LineChart>\n                  </ResponsiveContainer>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Form Submissions</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <Skeleton className=\"h-80 w-full\" />\n                ) : (\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <BarChart data={submissionData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-border\" />\n                      <XAxis\n                        dataKey=\"day\"\n                        className=\"text-xs\"\n                        tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                      />\n                      <YAxis\n                        className=\"text-xs\"\n                        tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                      />\n                      <Tooltip\n                        contentStyle={{\n                          backgroundColor: \"hsl(var(--popover))\",\n                          border: \"1px solid hsl(var(--border))\",\n                          borderRadius: \"6px\",\n                        }}\n                      />\n                      <Bar dataKey=\"count\" fill=\"hsl(var(--primary))\" radius={[4, 4, 0, 0]} />\n                    </BarChart>\n                  </ResponsiveContainer>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Platform Comparison</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {platformData.map((platform) => {\n                  const Icon = platform.icon;\n                  const percentage = platform.users > 0\n                    ? ((platform.active / platform.users) * 100).toFixed(0)\n                    : \"0\";\n                  return (\n                    <div key={platform.name} className=\"flex items-center gap-4\">\n                      <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-muted\">\n                        <Icon className=\"h-5 w-5 text-muted-foreground\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center justify-between mb-1\">\n                          <span className=\"font-medium\">{platform.name}</span>\n                          <span className=\"text-sm text-muted-foreground\">\n                            {platform.active} / {platform.users}\n                          </span>\n                        </div>\n                        <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                          <div\n                            className=\"h-full bg-primary transition-all\"\n                            style={{ width: `${percentage}%` }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {[\"metabase\", \"chatwoot\", \"typebot\", \"mailcow\"].map((platform) => (\n          <TabsContent key={platform} value={platform} className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Total Users</CardTitle>\n                  <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">\n                    {metrics?.[platform]?.users || 0}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    All registered users\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Active Users</CardTitle>\n                  <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">\n                    {metrics?.[platform]?.active || 0}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Currently enabled\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Activity Rate</CardTitle>\n                  <BarChart3 className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">\n                    {metrics?.[platform]?.users > 0\n                      ? ((metrics[platform].active / metrics[platform].users) * 100).toFixed(1)\n                      : \"0\"}%\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Engagement rate\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"capitalize\">{platform} Analytics</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <BarChart3 className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                  <p>Detailed {platform} analytics coming soon</p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        ))}\n      </Tabs>\n    </div>\n  );\n}\n","size_bytes":11470},"QUICK_START_LOCAL.md":{"content":"# Quick Start: Running Admin Hub Locally\n\n##  What I Just Set Up For You\n\nI've implemented **Development Bypass Authentication** - the fastest way to test the app locally!\n\n##  How to Use It\n\n### On Replit (Right Now)\n\n**Just click this link to login:**\n Visit: `/api/dev-login` (or click the \"Sign In\" button and it will redirect you)\n\nYou'll be instantly logged in as:\n- **Email:** admin@localhost.dev\n- **Name:** Admin User\n\n### On Your Local PC (VS Code)\n\nFollow these steps:\n\n#### 1. Download the Project\n- Click the three dots () in Replit\n- Select \"Download as ZIP\"\n- Extract to your desired folder\n- Open in VS Code\n\n#### 2. Set Up Database\n\nInstall PostgreSQL, then create the database:\n\n```bash\n# Create database\npsql -U postgres -c \"CREATE DATABASE admin_hub;\"\n\n# Create .env file with your database credentials\n```\n\nCreate `.env` file:\n```env\nDATABASE_URL=postgresql://postgres:yourpassword@localhost:5432/admin_hub\nSESSION_SECRET=your-random-secret-string-here\nNODE_ENV=development\n```\n\n#### 3. Install Dependencies\n\n```bash\nnpm install\n```\n\n#### 4. Initialize Database\n\n```bash\nnpm run db:push\n```\n\n#### 5. Start the App\n\n```bash\nnpm run dev\n```\n\n#### 6. Login\n\nOpen browser to: `http://localhost:5000/api/dev-login`\n\n**That's it!** You're logged in and can use the dashboard.\n\n##  What Changed\n\nI modified the app to use simple development authentication instead of Replit Auth:\n\n1. **Created:** `server/devAuth.ts` - Development authentication module\n2. **Modified:** `server/routes.ts` - Now uses devAuth instead of replitAuth\n\n##  Key Endpoints\n\n| Endpoint | Purpose |\n|----------|---------|\n| `/api/dev-login` | Auto-login (instant access) |\n| `/api/auth/user` | Get current user info |\n| `/api/logout` | Logout |\n| `/` | Dashboard (requires login) |\n\n##  Switching Between Dev and Production\n\nWhen you want to deploy to Replit with real authentication:\n\n1. Open `server/routes.ts`\n2. Change line 5 from:\n   ```typescript\n   import { setupAuth, isAuthenticated } from \"./devAuth\";\n   ```\n   To:\n   ```typescript\n   import { setupAuth, isAuthenticated } from \"./replitAuth\";\n   ```\n\n##  Quick Test on Replit\n\nTry these URLs right now on Replit:\n\n1. **Login:** Click \"Sign In\" or visit `/api/dev-login`\n2. **Check User:** Visit `/api/auth/user` (should show your user data)\n3. **Dashboard:** Visit `/` (should show the admin dashboard)\n\n##  Troubleshooting\n\n### \"Unauthorized\" error\n- **Solution:** Visit `/api/dev-login` first to create your session\n\n### Can't access dashboard\n- **Solution:** Clear your browser cookies and visit `/api/dev-login` again\n\n### Database errors\n- **Solution:** Run `npm run db:push` to create tables\n\n### Port 5000 in use (local PC)\n```bash\n# Windows\nnetstat -ano | findstr :5000\ntaskkill /PID <PID> /F\n\n# Mac/Linux\nlsof -i :5000\nkill -9 <PID>\n```\n\n##  Development Workflow\n\n1. Make code changes in VS Code\n2. Save (auto-reload happens)\n3. Refresh browser\n4. Test features\n\n##  What's Included\n\nThis dev auth setup includes:\n-  Auto-login endpoint\n-  Session management\n-  User creation in database\n-  Compatible with all existing API routes\n-  Works on Replit AND local PC\n\n##  Security Note\n\n**This is for development only!** \n\nFor production:\n- Use the real Replit Auth (already configured)\n- Or implement OAuth (Google, GitHub, etc.)\n- Or use Auth0/Supabase/Firebase\n\n## Next Steps\n\nNow that you're logged in, you can:\n\n1.  Add service configurations (Metabase, Chatwoot, etc.)\n2.  Create and manage users\n3.  View analytics\n4.  Check activity logs\n5.  Configure platform settings\n\n## Need More Help?\n\n- See `AUTH_SETUP_GUIDE.md` for other authentication options\n- See `SETUP.md` for full local development setup\n- Check the logs if something goes wrong\n\n**Happy coding!** \n","size_bytes":3811},"AUTH_SETUP_GUIDE.md":{"content":"# Authentication Setup Guide for Local Development\n\nThis guide provides multiple solutions for handling authentication when running the Admin Hub locally on your PC.\n\n## The Challenge\n\nThis project uses **Replit Auth** (OpenID Connect), which only works on Replit's platform. When running locally, you need an alternative authentication method.\n\n## Solution Options\n\nChoose one of these approaches based on your needs:\n\n---\n\n## Option 1: Development Bypass (Quick Testing) \n\n**Best for:** Testing features quickly without worrying about auth  \n**Time:** 5 minutes  \n**Security:** NOT for production!\n\n### Step 1: Create a Development Auth File\n\nCreate a new file `server/devAuth.ts`:\n\n```typescript\nimport type { Express, RequestHandler } from \"express\";\nimport session from \"express-session\";\n\n// Mock user for development\nconst DEV_USER = {\n  id: \"dev-user-123\",\n  email: \"admin@localhost.dev\",\n  firstName: \"Admin\",\n  lastName: \"User\",\n  profileImageUrl: null,\n};\n\nexport function getSession() {\n  return session({\n    secret: process.env.SESSION_SECRET || \"dev-secret-change-in-production\",\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: false, // Set to false for localhost\n      maxAge: 7 * 24 * 60 * 60 * 1000, // 1 week\n    },\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.use(getSession());\n\n  // Auto-login route for development\n  app.get(\"/api/dev-login\", (req: any, res) => {\n    req.session.user = DEV_USER;\n    res.redirect(\"/\");\n  });\n\n  // Mock auth user endpoint\n  app.get(\"/api/auth/user\", (req: any, res) => {\n    if (req.session.user) {\n      res.json(req.session.user);\n    } else {\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n\n  // Mock logout\n  app.get(\"/api/logout\", (req: any, res) => {\n    req.session.destroy(() => {\n      res.redirect(\"/\");\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req: any, res, next) => {\n  if (req.session?.user) {\n    // Attach user to request for compatibility\n    req.user = { claims: { sub: req.session.user.id } };\n    return next();\n  }\n  res.status(401).json({ message: \"Unauthorized\" });\n};\n```\n\n### Step 2: Update server/routes.ts\n\nAt the top of `server/routes.ts`, change the import:\n\n```typescript\n// Comment out the Replit Auth import\n// import { setupAuth, isAuthenticated } from \"./replitAuth\";\n\n// Use dev auth instead\nimport { setupAuth, isAuthenticated } from \"./devAuth\";\n```\n\n### Step 3: Create Test User in Database\n\nRun this SQL to create a test user (optional but recommended):\n\n```bash\npsql -U postgres -d admin_hub\n```\n\n```sql\nINSERT INTO users (id, email, first_name, last_name) \nVALUES ('dev-user-123', 'admin@localhost.dev', 'Admin', 'User')\nON CONFLICT (id) DO NOTHING;\n```\n\nOr just run:\n```bash\nnpm run dev\n```\n\nAnd visit `http://localhost:5000/api/dev-login` - this will create your session automatically.\n\n### Step 4: Test It\n\n1. Start the server: `npm run dev`\n2. Visit: `http://localhost:5000/api/dev-login`\n3. You'll be redirected to the dashboard, logged in!\n\n** Pros:**\n- Fast setup\n- No external dependencies\n- Easy to test features\n\n** Cons:**\n- No real security\n- No login UI\n- Don't use in production!\n\n---\n\n## Option 2: Simple Local Auth with Email/Password \n\n**Best for:** More realistic local development with proper login flow  \n**Time:** 30 minutes  \n**Security:** Good for local testing\n\n### Step 1: Install passport-local\n\nAlready installed! It's in your package.json.\n\n### Step 2: Create Local Auth File\n\nCreate `server/localAuth.ts`:\n\n```typescript\nimport type { Express, RequestHandler } from \"express\";\nimport passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport session from \"express-session\";\nimport { storage } from \"./storage\";\n\n// Simple password hashing (use bcrypt in production!)\nfunction hashPassword(password: string): string {\n  // For development only - use bcrypt in production\n  return Buffer.from(password).toString('base64');\n}\n\nfunction verifyPassword(password: string, hash: string): boolean {\n  return hashPassword(password) === hash;\n}\n\nexport function getSession() {\n  return session({\n    secret: process.env.SESSION_SECRET || \"dev-secret-change-in-production\",\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: false,\n      maxAge: 7 * 24 * 60 * 60 * 1000,\n    },\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Configure passport-local\n  passport.use(\n    new LocalStrategy(\n      { usernameField: \"email\" },\n      async (email, password, done) => {\n        try {\n          // For development: accept any email with password \"admin123\"\n          if (password === \"admin123\") {\n            // Get or create user\n            let user = await storage.getUserByEmail(email);\n            \n            if (!user) {\n              // Create new user\n              const newUser = await storage.upsertUser({\n                id: `local-${Date.now()}`,\n                email,\n                firstName: email.split(\"@\")[0],\n                lastName: \"User\",\n              });\n              user = newUser;\n            }\n\n            return done(null, user);\n          } else {\n            return done(null, false, { message: \"Invalid password\" });\n          }\n        } catch (error) {\n          return done(error);\n        }\n      }\n    )\n  );\n\n  passport.serializeUser((user: any, done) => {\n    done(null, user.id);\n  });\n\n  passport.deserializeUser(async (id: string, done) => {\n    try {\n      const user = await storage.getUser(id);\n      done(null, user);\n    } catch (error) {\n      done(error);\n    }\n  });\n\n  // Login endpoint\n  app.post(\"/api/login\", passport.authenticate(\"local\"), (req, res) => {\n    res.json({ success: true, user: req.user });\n  });\n\n  // Get current user\n  app.get(\"/api/auth/user\", (req, res) => {\n    if (req.isAuthenticated()) {\n      res.json(req.user);\n    } else {\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n\n  // Logout\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.json({ success: true });\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = (req, res, next) => {\n  if (req.isAuthenticated()) {\n    // Make compatible with Replit Auth format\n    const user = req.user as any;\n    (req as any).user = {\n      claims: { sub: user.id },\n      ...user,\n    };\n    return next();\n  }\n  res.status(401).json({ message: \"Unauthorized\" });\n};\n```\n\n### Step 3: Add getUserByEmail to Storage\n\nEdit `server/storage.ts` and add this method to the `IStorage` interface:\n\n```typescript\ngetUserByEmail(email: string): Promise<User | null>;\n```\n\nThen implement it in the `MemStorage` or database storage class:\n\n```typescript\nasync getUserByEmail(email: string): Promise<User | null> {\n  const [user] = await db\n    .select()\n    .from(users)\n    .where(eq(users.email, email))\n    .limit(1);\n  return user || null;\n}\n```\n\n### Step 4: Create Login UI Component\n\nCreate `client/src/components/LoginForm.tsx`:\n\n```typescript\nimport { useState } from \"react\";\nimport { useNavigate } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport function LoginForm() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [, navigate] = useNavigate();\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const response = await fetch(\"/api/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, password }),\n        credentials: \"include\",\n      });\n\n      if (response.ok) {\n        toast({ title: \"Login successful!\" });\n        navigate(\"/\");\n        window.location.reload(); // Refresh to load user data\n      } else {\n        toast({\n          title: \"Login failed\",\n          description: \"Invalid email or password\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to login\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <CardTitle>Admin Login</CardTitle>\n          <CardDescription>\n            Enter your credentials to access the admin dashboard\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder=\"admin@example.com\"\n                required\n                data-testid=\"input-email\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"Enter password\"\n                required\n                data-testid=\"input-password\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Development mode: Use password \"admin123\"\n              </p>\n            </div>\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={loading}\n              data-testid=\"button-login\"\n            >\n              {loading ? \"Logging in...\" : \"Login\"}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n```\n\n### Step 5: Update Landing Page\n\nEdit `client/src/pages/landing.tsx` to show the login form:\n\n```typescript\nimport { LoginForm } from \"@/components/LoginForm\";\n\nexport default function Landing() {\n  return <LoginForm />;\n}\n```\n\n### Step 6: Update routes.ts\n\nChange the import at the top:\n\n```typescript\n// import { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { setupAuth, isAuthenticated } from \"./localAuth\";\n```\n\n### Step 7: Test It\n\n1. Start server: `npm run dev`\n2. Visit: `http://localhost:5000`\n3. Enter any email and password: `admin123`\n4. You're logged in!\n\n** Pros:**\n- Realistic login flow\n- Works like production\n- Can test login/logout\n\n** Cons:**\n- Simple password (not secure)\n- Still need real auth for production\n\n---\n\n## Option 3: Environment-Based Auth Switching \n\n**Best for:** Switching between local and Replit easily  \n**Time:** 10 minutes (after setting up Option 1 or 2)\n\n### Create an Auth Router\n\nCreate `server/auth.ts`:\n\n```typescript\nexport function getAuthModule() {\n  if (process.env.NODE_ENV === \"development\" && !process.env.REPL_ID) {\n    // Local development\n    console.log(\" Using local development auth\");\n    return require(\"./localAuth\"); // or \"./devAuth\"\n  } else {\n    // Replit production\n    console.log(\" Using Replit Auth\");\n    return require(\"./replitAuth\");\n  }\n}\n\nexport const { setupAuth, isAuthenticated, getSession } = getAuthModule();\n```\n\n### Update routes.ts\n\n```typescript\nimport { setupAuth, isAuthenticated } from \"./auth\";\n```\n\nNow it automatically uses the right auth based on your environment!\n\n---\n\n## Quick Reference\n\n| Method | Setup Time | Best For | Security |\n|--------|-----------|----------|----------|\n| Development Bypass | 5 min | Quick testing | Low |\n| Local Auth | 30 min | Realistic dev | Medium |\n| Environment Switch | 10 min | Both local & Replit | Varies |\n\n## Recommended Approach\n\n1. **Start with Development Bypass** (Option 1) - Get up and running fast\n2. **Upgrade to Local Auth** (Option 2) - When you need proper login flow\n3. **Add Environment Switching** (Option 3) - To easily deploy to Replit\n\n## Testing Your Setup\n\nAfter setting up auth, test these endpoints:\n\n```bash\n# Check if auth is working\ncurl http://localhost:5000/api/auth/user\n\n# Should return 401 Unauthorized if not logged in\n# Should return user data if logged in\n```\n\n## Troubleshooting\n\n### \"Unauthorized\" errors\n\n- For Option 1: Visit `/api/dev-login` first\n- For Option 2: Make sure you logged in at `/`\n- Check browser console for errors\n\n### Session not persisting\n\n- Make sure SESSION_SECRET is set in `.env`\n- Check cookie settings (secure: false for localhost)\n- Clear browser cookies and try again\n\n### Database errors\n\n- Make sure you ran `npm run db:push`\n- Check DATABASE_URL is correct\n- Verify PostgreSQL is running\n\n## Next Steps\n\nOnce you have auth working:\n\n1. Create some test users\n2. Test the dashboard features\n3. Configure your platform services\n4. Build your admin workflows!\n\n## Need Help?\n\n- Check server logs for errors\n- Verify environment variables\n- Make sure all files are in the right place\n- Test with curl or Postman first\n\n---\n\nRemember: These are **development solutions**. For production, use proper authentication with:\n- OAuth providers (Google, GitHub)\n- Auth0, Supabase, or Firebase\n- Proper password hashing (bcrypt)\n- HTTPS and secure cookies\n","size_bytes":13701},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"server/replitAuth.ts":{"content":"// Replit Auth integration for admin authentication\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":4524},"server/devAuth.ts":{"content":"import type { Express, RequestHandler } from \"express\";\nimport session from \"express-session\";\nimport { storage } from \"./storage\";\nimport { getTeamMemberWithPermissions, seedRolesAndPermissions, seedDefaultDepartments, type AuthenticatedTeamMember } from \"./rbac\";\nimport { db } from \"./db\";\nimport { roles, teamMembers, departments, ROLE_TYPES } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\nimport bcrypt from \"bcryptjs\";\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    user: {\n      id: string;\n      email: string;\n      firstName: string | null;\n      lastName: string | null;\n      profileImageUrl: string | null;\n    };\n    teamMemberId?: string;\n  }\n}\n\nconst DEV_USER = {\n  id: \"dev-user-123\",\n  email: \"admin@localhost.dev\",\n  firstName: \"Admin\",\n  lastName: \"User\",\n  profileImageUrl: null,\n};\n\nexport function getSession() {\n  return session({\n    secret: process.env.SESSION_SECRET || \"dev-secret-change-in-production\",\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: false,\n      maxAge: 7 * 24 * 60 * 60 * 1000,\n    },\n  });\n}\n\nasync function ensureDevTeamMember(): Promise<string | null> {\n  await seedRolesAndPermissions();\n  await seedDefaultDepartments();\n\n  const existingMember = await storage.getTeamMemberByEmail(DEV_USER.email);\n  if (existingMember) {\n    return existingMember.id;\n  }\n\n  const [mgmtRole] = await db.select().from(roles).where(eq(roles.code, ROLE_TYPES.MANAGEMENT));\n  const [dept] = await db.select().from(departments).limit(1);\n\n  if (!mgmtRole || !dept) {\n    console.error(\"Cannot create dev team member: missing role or department\");\n    return null;\n  }\n\n  const passwordHash = await bcrypt.hash(\"devpassword\", 10);\n  const member = await storage.createTeamMember({\n    userId: DEV_USER.id,\n    departmentId: dept.id,\n    roleId: mgmtRole.id,\n    email: DEV_USER.email,\n    firstName: DEV_USER.firstName || \"Admin\",\n    lastName: DEV_USER.lastName || \"User\",\n    role: \"management\",\n    passwordHash,\n    status: \"active\",\n  });\n\n  return member.id;\n}\n\nexport async function setupAuth(app: Express) {\n  app.use(getSession());\n\n  app.get(\"/api/dev-login\", async (req: any, res) => {\n    await storage.upsertUser(DEV_USER);\n    const teamMemberId = await ensureDevTeamMember();\n    req.session.user = DEV_USER;\n    req.session.teamMemberId = teamMemberId || undefined;\n    res.redirect(\"/\");\n  });\n\n  app.post(\"/api/auth/login\", async (req: any, res) => {\n    try {\n      const { email, password } = req.body;\n      \n      if (!email || !password) {\n        return res.status(400).json({ message: \"Email and password are required\" });\n      }\n\n      const member = await storage.getTeamMemberByEmail(email);\n      if (!member) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n\n      if (member.status !== \"active\") {\n        return res.status(401).json({ message: \"Account is deactivated\" });\n      }\n\n      if (!member.passwordHash) {\n        return res.status(401).json({ message: \"Password not set for this account\" });\n      }\n\n      const isValid = await bcrypt.compare(password, member.passwordHash);\n      if (!isValid) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n\n      await storage.updateTeamMember(member.id, { lastLoginAt: new Date() } as any);\n\n      const user = {\n        id: member.id,\n        email: member.email,\n        firstName: member.firstName,\n        lastName: member.lastName,\n        profileImageUrl: null,\n      };\n\n      req.session.user = user;\n      req.session.teamMemberId = member.id;\n\n      const memberWithPerms = await getTeamMemberWithPermissions(member.id);\n      \n      res.json({ \n        user,\n        teamMember: memberWithPerms,\n      });\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      res.status(500).json({ message: \"Login failed\" });\n    }\n  });\n\n  app.get(\"/api/auth/user\", async (req: any, res) => {\n    if (req.session.user) {\n      let teamMember: AuthenticatedTeamMember | null = null;\n      \n      if (req.session.teamMemberId) {\n        teamMember = await getTeamMemberWithPermissions(req.session.teamMemberId);\n      }\n\n      res.json({\n        ...req.session.user,\n        teamMember,\n      });\n    } else {\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n\n  app.get(\"/api/auth/me\", async (req: any, res) => {\n    if (!req.session.teamMemberId) {\n      return res.status(401).json({ message: \"Not authenticated as team member\" });\n    }\n\n    const teamMember = await getTeamMemberWithPermissions(req.session.teamMemberId);\n    if (!teamMember) {\n      return res.status(401).json({ message: \"Team member not found\" });\n    }\n\n    res.json(teamMember);\n  });\n\n  app.get(\"/api/logout\", (req: any, res) => {\n    req.session.destroy(() => {\n      res.redirect(\"/\");\n    });\n  });\n\n  app.post(\"/api/logout\", (req: any, res) => {\n    req.session.destroy(() => {\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.get(\"/api/login\", (req, res) => {\n    res.redirect(\"/api/dev-login\");\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req: any, res, next) => {\n  if (req.session?.user) {\n    req.user = { claims: { sub: req.session.user.id } };\n    \n    if (req.session.teamMemberId) {\n      const teamMember = await getTeamMemberWithPermissions(req.session.teamMemberId);\n      if (teamMember) {\n        req.teamMember = teamMember;\n      }\n    }\n    \n    return next();\n  }\n  res.status(401).json({ message: \"Unauthorized\" });\n};\n\nexport const isTeamMemberAuthenticated: RequestHandler = async (req: any, res, next) => {\n  if (!req.session?.teamMemberId) {\n    return res.status(401).json({ message: \"Team member authentication required\" });\n  }\n\n  const teamMember = await getTeamMemberWithPermissions(req.session.teamMemberId);\n  if (!teamMember) {\n    return res.status(401).json({ message: \"Team member not found\" });\n  }\n\n  if (teamMember.status !== \"active\") {\n    return res.status(401).json({ message: \"Account is deactivated\" });\n  }\n\n  req.teamMember = teamMember;\n  req.user = { claims: { sub: req.session.user?.id } };\n  \n  next();\n};\n","size_bytes":6181},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useEffect, useState } from \"react\";\n\nexport function ThemeToggle() {\n  const [theme, setTheme] = useState<\"light\" | \"dark\">(\"light\");\n\n  useEffect(() => {\n    const savedTheme = localStorage.getItem(\"theme\") as \"light\" | \"dark\" | null;\n    const initialTheme = savedTheme || \"light\";\n    setTheme(initialTheme);\n    document.documentElement.classList.toggle(\"dark\", initialTheme === \"dark\");\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === \"light\" ? \"dark\" : \"light\";\n    setTheme(newTheme);\n    localStorage.setItem(\"theme\", newTheme);\n    document.documentElement.classList.toggle(\"dark\", newTheme === \"dark\");\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n      aria-label=\"Toggle theme\"\n    >\n      {theme === \"light\" ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n    </Button>\n  );\n}\n","size_bytes":1056},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/pages/config.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Database, MessageSquare, FormInput, Mail, Save, TestTube } from \"lucide-react\";\nimport type { ServiceConfig, InsertServiceConfig } from \"@shared/schema\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\nconst platformConfigs = [\n  {\n    name: \"metabase\",\n    title: \"Metabase\",\n    description: \"Business intelligence and analytics platform\",\n    icon: Database,\n    defaultUrl: \"https://metabase.yourdomain.com\",\n  },\n  {\n    name: \"chatwoot\",\n    title: \"Chatwoot\",\n    description: \"Customer engagement and support platform\",\n    icon: MessageSquare,\n    defaultUrl: \"https://chatwoot.yourdomain.com\",\n  },\n  {\n    name: \"typebot\",\n    title: \"Typebot\",\n    description: \"Conversational forms and chatbot builder\",\n    icon: FormInput,\n    defaultUrl: \"https://typebot.yourdomain.com\",\n  },\n  {\n    name: \"mailcow\",\n    title: \"Mailcow\",\n    description: \"Email server management platform\",\n    icon: Mail,\n    defaultUrl: \"https://mail.yourdomain.com\",\n  },\n];\n\nexport default function Config() {\n  const { toast } = useToast();\n  const [testingService, setTestingService] = useState<string | null>(null);\n\n  const { data: services, isLoading } = useQuery<ServiceConfig[]>({\n    queryKey: [\"/api/services\"],\n  });\n\n  const saveMutation = useMutation({\n    mutationFn: async (data: { serviceName: string; config: InsertServiceConfig }) => {\n      const existingService = services?.find(s => s.serviceName === data.serviceName);\n      if (existingService) {\n        return await apiRequest(`/api/services/${existingService.id}`, \"PATCH\", data.config);\n      } else {\n        return await apiRequest(\"/api/services\", \"POST\", data.config);\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      toast({\n        title: \"Configuration saved\",\n        description: \"Service configuration has been updated successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to save configuration. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const testConnectionMutation = useMutation({\n    mutationFn: async (serviceName: string) => {\n      return await apiRequest(`/api/services/${serviceName}/test`, \"POST\", undefined);\n    },\n    onSuccess: (_, serviceName) => {\n      toast({\n        title: \"Connection successful\",\n        description: `Successfully connected to ${serviceName}.`,\n      });\n      setTestingService(null);\n    },\n    onError: (error: Error, serviceName) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Connection failed\",\n        description: `Failed to connect to ${serviceName}. Check your configuration.`,\n        variant: \"destructive\",\n      });\n      setTestingService(null);\n    },\n  });\n\n  const getServiceConfig = (serviceName: string): ServiceConfig | undefined => {\n    return services?.find(s => s.serviceName === serviceName);\n  };\n\n  const handleSave = (serviceName: string, formData: FormData) => {\n    const config: InsertServiceConfig = {\n      serviceName,\n      apiUrl: formData.get(\"apiUrl\") as string,\n      apiKey: formData.get(\"apiKey\") as string,\n      enabled: formData.get(\"enabled\") === \"true\",\n    };\n\n    saveMutation.mutate({ serviceName, config });\n  };\n\n  const handleTestConnection = (serviceName: string) => {\n    setTestingService(serviceName);\n    testConnectionMutation.mutate(serviceName);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">Configuration</h1>\n        <p className=\"text-muted-foreground mt-1\">Configure API connections for all platforms</p>\n      </div>\n\n      <Accordion type=\"single\" collapsible className=\"space-y-4\">\n        {platformConfigs.map((platform) => {\n          const Icon = platform.icon;\n          const serviceConfig = getServiceConfig(platform.name);\n\n          return (\n            <AccordionItem\n              key={platform.name}\n              value={platform.name}\n              className=\"border border-border rounded-md\"\n            >\n              <AccordionTrigger\n                className=\"px-6 hover:no-underline hover-elevate\"\n                data-testid={`accordion-${platform.name}`}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-muted\">\n                    <Icon className=\"h-5 w-5 text-muted-foreground\" />\n                  </div>\n                  <div className=\"text-left\">\n                    <h3 className=\"font-semibold\">{platform.title}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{platform.description}</p>\n                  </div>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"px-6 pb-6\">\n                {isLoading ? (\n                  <div className=\"space-y-4\">\n                    <Skeleton className=\"h-10 w-full\" />\n                    <Skeleton className=\"h-10 w-full\" />\n                    <Skeleton className=\"h-10 w-full\" />\n                  </div>\n                ) : (\n                  <form\n                    onSubmit={(e) => {\n                      e.preventDefault();\n                      handleSave(platform.name, new FormData(e.currentTarget));\n                    }}\n                    className=\"space-y-4\"\n                  >\n                    <div className=\"space-y-2\">\n                      <Label htmlFor={`${platform.name}-url`}>API URL</Label>\n                      <Input\n                        id={`${platform.name}-url`}\n                        name=\"apiUrl\"\n                        type=\"url\"\n                        placeholder={platform.defaultUrl}\n                        defaultValue={serviceConfig?.apiUrl || \"\"}\n                        data-testid={`input-${platform.name}-url`}\n                      />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label htmlFor={`${platform.name}-key`}>API Key</Label>\n                      <Input\n                        id={`${platform.name}-key`}\n                        name=\"apiKey\"\n                        type=\"password\"\n                        placeholder=\"Enter API key\"\n                        defaultValue={serviceConfig?.apiKey || \"\"}\n                        data-testid={`input-${platform.name}-key`}\n                      />\n                    </div>\n\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Switch\n                          id={`${platform.name}-enabled`}\n                          name=\"enabled\"\n                          value=\"true\"\n                          defaultChecked={serviceConfig?.enabled ?? true}\n                          data-testid={`switch-${platform.name}-enabled`}\n                        />\n                        <Label htmlFor={`${platform.name}-enabled`} className=\"cursor-pointer\">\n                          Enable this service\n                        </Label>\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-2 pt-4\">\n                      <Button\n                        type=\"submit\"\n                        disabled={saveMutation.isPending}\n                        data-testid={`button-save-${platform.name}`}\n                      >\n                        <Save className=\"h-4 w-4 mr-2\" />\n                        {saveMutation.isPending ? \"Saving...\" : \"Save Configuration\"}\n                      </Button>\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        onClick={() => handleTestConnection(platform.name)}\n                        disabled={testingService === platform.name || !serviceConfig}\n                        data-testid={`button-test-${platform.name}`}\n                      >\n                        <TestTube className=\"h-4 w-4 mr-2\" />\n                        {testingService === platform.name ? \"Testing...\" : \"Test Connection\"}\n                      </Button>\n                    </div>\n                  </form>\n                )}\n              </AccordionContent>\n            </AccordionItem>\n          );\n        })}\n      </Accordion>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Setup Instructions</CardTitle>\n          <CardDescription>How to obtain API credentials for each platform</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-semibold mb-2\">Metabase</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              Generate an API key from Settings  Admin  API Keys in your Metabase instance.\n            </p>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-2\">Chatwoot</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              Create an access token from Profile Settings  Access Token in Chatwoot.\n            </p>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-2\">Typebot</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              Generate an API token from your Typebot dashboard settings.\n            </p>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-2\">Mailcow</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              Create an API key from Mailcow Admin  Configuration  API.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":11020},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/pages/landing.tsx":{"content":"import { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { LayoutDashboard, Users, BarChart3, Shield, Zap, Database } from \"lucide-react\";\n\nexport default function Landing() {\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border\">\n        <div className=\"container mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-primary text-primary-foreground\">\n                <LayoutDashboard className=\"h-6 w-6\" />\n              </div>\n              <span className=\"text-xl font-semibold\">Admin Hub</span>\n            </div>\n            <Link href=\"/login\">\n              <Button data-testid=\"button-login\">\n                Sign In\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-6 py-16\">\n        <div className=\"max-w-4xl mx-auto text-center space-y-8\">\n          <div className=\"space-y-4\">\n            <h1 className=\"text-5xl font-bold tracking-tight\">\n              Unified Platform Management\n            </h1>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n              Centralize control over Metabase, Chatwoot, Typebot, and Mailcow.\n              Manage users, monitor analytics, and streamline operations from one powerful dashboard.\n            </p>\n          </div>\n\n          <div className=\"flex justify-center gap-4\">\n            <Link href=\"/login\">\n              <Button size=\"lg\" data-testid=\"button-get-started\">\n                Get Started\n              </Button>\n            </Link>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mt-16\">\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex flex-col items-center text-center space-y-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-md bg-primary/10 text-primary\">\n                    <Users className=\"h-6 w-6\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold\">User Management</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Create, edit, and manage user accounts across all platforms from a single interface.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex flex-col items-center text-center space-y-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-md bg-primary/10 text-primary\">\n                    <BarChart3 className=\"h-6 w-6\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold\">Analytics Dashboard</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Monitor key metrics, track conversations, and visualize platform performance.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex flex-col items-center text-center space-y-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-md bg-primary/10 text-primary\">\n                    <Shield className=\"h-6 w-6\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold\">Activity Tracking</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Comprehensive audit logs for all admin actions and platform changes.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          <div className=\"mt-16 pt-16 border-t border-border\">\n            <h2 className=\"text-2xl font-semibold mb-8\">Supported Platforms</h2>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <Database className=\"h-8 w-8 text-primary\" />\n                    <span className=\"font-medium\">Metabase</span>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <Zap className=\"h-8 w-8 text-primary\" />\n                    <span className=\"font-medium\">Chatwoot</span>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <LayoutDashboard className=\"h-8 w-8 text-primary\" />\n                    <span className=\"font-medium\">Typebot</span>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <Shield className=\"h-8 w-8 text-primary\" />\n                    <span className=\"font-medium\">Mailcow</span>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      <footer className=\"border-t border-border mt-24\">\n        <div className=\"container mx-auto px-6 py-8\">\n          <p className=\"text-center text-sm text-muted-foreground\">\n             2024 Admin Hub. All rights reserved.\n          </p>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":5924},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"SETUP.md":{"content":"# Local Development Setup Guide\n\nThis guide will help you set up and run the Admin Hub project on your local PC using VS Code.\n\n## Prerequisites\n\nBefore you begin, make sure you have the following installed:\n\n1. **Node.js** (v20.x or later)\n   - Download from: https://nodejs.org/\n   - Verify installation: `node --version`\n\n2. **PostgreSQL** (v14 or later)\n   - Download from: https://www.postgresql.org/download/\n   - Verify installation: `psql --version`\n\n3. **VS Code**\n   - Download from: https://code.visualstudio.com/\n\n4. **Git** (optional, for cloning)\n   - Download from: https://git-scm.com/\n\n## Step 1: Download the Project\n\n### Option A: Export from Replit\n1. In your Replit project, click on the three dots menu ()\n2. Select \"Download as ZIP\"\n3. Extract the ZIP file to your desired location\n4. Open the extracted folder in VS Code\n\n### Option B: Clone from GitHub (if connected)\n```bash\ngit clone <your-repository-url>\ncd <project-folder>\ncode .\n```\n\n## Step 2: Install Dependencies\n\nOpen the terminal in VS Code (View > Terminal or Ctrl+`) and run:\n\n```bash\nnpm install\n```\n\nThis will install all required packages from package.json.\n\n## Step 3: Set Up PostgreSQL Database\n\n### Create a Database\n\n1. Open PostgreSQL command line or use pgAdmin\n2. Create a new database:\n\n```sql\nCREATE DATABASE admin_hub;\n```\n\n3. Note your database connection details:\n   - Host: `localhost`\n   - Port: `5432` (default)\n   - Username: your PostgreSQL username\n   - Password: your PostgreSQL password\n   - Database: `admin_hub`\n\n## Step 4: Configure Environment Variables\n\nCreate a `.env` file in the root of your project:\n\n```bash\n# Database Configuration\nDATABASE_URL=postgresql://username:password@localhost:5432/admin_hub\n\n# PostgreSQL Connection Details (individual variables)\nPGHOST=localhost\nPGPORT=5432\nPGUSER=your_postgres_username\nPGPASSWORD=your_postgres_password\nPGDATABASE=admin_hub\n\n# Session Secret (generate a random string)\nSESSION_SECRET=your_super_secret_random_string_here_make_it_long_and_random\n\n# Replit Configuration (for local development, use test values)\nREPL_ID=local-dev\nISSUER_URL=https://replit.com\n\n# Optional: Development Domain\nREPLIT_DEV_DOMAIN=localhost:5000\n```\n\n### Important Notes:\n\n- **DATABASE_URL**: Replace `username` and `password` with your PostgreSQL credentials\n- **SESSION_SECRET**: Use a long random string. Generate one with:\n  ```bash\n  node -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n  ```\n- **Authentication**: This project uses Replit Auth. For local development, you'll need to modify the authentication system or set up a test OAuth provider.\n\n## Step 5: Initialize Database Schema\n\nRun the database migration to create all necessary tables:\n\n```bash\nnpm run db:push\n```\n\nYou should see output confirming that tables were created:\n- sessions\n- users\n- service_configs\n- managed_users\n- activity_logs\n- analytics_metrics\n\n## Step 6: Run the Development Server\n\nStart the development server:\n\n```bash\nnpm run dev\n```\n\nYou should see:\n```\n[express] serving on port 5000\n```\n\n## Step 7: Access the Application\n\nOpen your browser and navigate to:\n```\nhttp://localhost:5000\n```\n\nYou should see the Admin Hub landing page.\n\n## Authentication Setup for Local Development\n\n**Important:** This project uses Replit Auth (OpenID Connect) which won't work directly on localhost. You have two options:\n\n### Option 1: Mock Authentication (Quick Testing)\n\nTemporarily modify `server/routes.ts` to bypass authentication:\n\n1. Comment out the `isAuthenticated` middleware on routes you want to test\n2. Add a mock user to the request object for testing\n\n### Option 2: Set Up Local OAuth (Production-like)\n\nConsider implementing a local authentication provider:\n- Auth0 (has a free tier)\n- Supabase Auth\n- Firebase Auth\n- Simple email/password with passport-local\n\n## Project Structure\n\n```\nadmin-hub/\n client/              # Frontend React application\n    src/\n       components/  # UI components\n       pages/       # Page components\n       lib/         # Utilities and config\n       App.tsx      # Main app component\n    public/          # Static assets\n server/              # Backend Express application\n    app.ts           # Express app setup\n    routes.ts        # API routes\n    db.ts            # Database connection\n    storage.ts       # Data access layer\n    index-dev.ts     # Development server\n shared/              # Shared types and schemas\n    schema.ts        # Database schema\n package.json         # Dependencies\n```\n\n## Available Scripts\n\n```bash\n# Development\nnpm run dev              # Start dev server with hot reload\n\n# Database\nnpm run db:push          # Push schema changes to database\n\n# Type Checking\nnpm run check            # Run TypeScript type checking\n\n# Production Build\nnpm run build            # Build for production\nnpm start                # Run production server\n```\n\n## Common Issues & Solutions\n\n### Issue: Port 5000 Already in Use\n\n**Solution:** Kill the process using port 5000 or change the port in `server/app.ts`:\n\n```bash\n# Find process on Windows\nnetstat -ano | findstr :5000\n\n# Find process on Mac/Linux\nlsof -i :5000\n\n# Kill the process (use the PID from above)\nkill -9 <PID>\n```\n\n### Issue: Database Connection Failed\n\n**Solutions:**\n1. Verify PostgreSQL is running\n2. Check your DATABASE_URL is correct\n3. Ensure the database exists: `psql -U postgres -c \"CREATE DATABASE admin_hub;\"`\n4. Test connection: `psql -U postgres -d admin_hub`\n\n### Issue: \"relation does not exist\" Error\n\n**Solution:** Run the database migration:\n```bash\nnpm run db:push\n```\n\n### Issue: npm install fails\n\n**Solutions:**\n1. Clear npm cache: `npm cache clean --force`\n2. Delete `node_modules` and `package-lock.json`\n3. Run `npm install` again\n4. Make sure you're using Node.js v20 or later\n\n### Issue: TypeScript Errors\n\n**Solution:** Run type checking to see all errors:\n```bash\nnpm run check\n```\n\n## VS Code Recommended Extensions\n\nInstall these extensions for the best development experience:\n\n1. **ESLint** - Code linting\n2. **Prettier** - Code formatting\n3. **TypeScript Vue Plugin (Volar)** - TypeScript support\n4. **Tailwind CSS IntelliSense** - Tailwind autocomplete\n5. **PostgreSQL** - Database management\n6. **REST Client** - API testing\n\n## Development Workflow\n\n1. Make code changes in VS Code\n2. Save files (hot reload will update automatically)\n3. View changes in browser at `http://localhost:5000`\n4. Check terminal for any errors\n5. Use browser DevTools for debugging\n\n## Database Management\n\n### View Database Tables\n\n```bash\n# Connect to database\npsql -U postgres -d admin_hub\n\n# List all tables\n\\dt\n\n# View table structure\n\\d table_name\n\n# Query data\nSELECT * FROM users;\n\n# Exit psql\n\\q\n```\n\n### Reset Database (if needed)\n\n```bash\n# Drop and recreate database\npsql -U postgres -c \"DROP DATABASE admin_hub;\"\npsql -U postgres -c \"CREATE DATABASE admin_hub;\"\n\n# Push schema again\nnpm run db:push\n```\n\n## Next Steps\n\n1. **Configure Service Connections**: Add API credentials for Metabase, Chatwoot, Typebot, and Mailcow in the Configuration page\n2. **Set Up Authentication**: Implement a local auth provider for full functionality\n3. **Create Test Data**: Add some test users and services to explore the dashboard\n4. **Explore Features**: \n   - User Management\n   - Analytics Dashboard\n   - Activity Logs\n   - Service Configuration\n\n## Need Help?\n\n- Check the logs in the terminal for error messages\n- Review the browser console (F12) for frontend errors\n- Verify environment variables are set correctly\n- Ensure PostgreSQL is running and accessible\n\n## Additional Resources\n\n- [Node.js Documentation](https://nodejs.org/docs/)\n- [PostgreSQL Documentation](https://www.postgresql.org/docs/)\n- [Express.js Guide](https://expressjs.com/en/guide/routing.html)\n- [React Documentation](https://react.dev/)\n- [Drizzle ORM](https://orm.drizzle.team/)\n- [Vite Documentation](https://vitejs.dev/)\n\n---\n\n**Happy Coding!** If you run into any issues, review the troubleshooting section above or check the application logs for specific error messages.\n","size_bytes":8241},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/lib/authUtils.ts":{"content":"// Replit Auth utility functions\nexport function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":149},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/app-sidebar.tsx":{"content":"import { LayoutDashboard, Users, BarChart3, Activity, Settings, Database, MessageSquare, FormInput, Mail, Building2, UserCog, ClipboardList, Shield } from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n  SidebarFooter,\n} from \"@/components/ui/sidebar\";\nimport { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n  const { teamMember, hasPermission, isManagement, isDepartmentAdmin, isTechnician, PERMISSION_TYPES } = useAuth();\n\n  const mainMenuItems = [\n    {\n      title: \"Dashboard\",\n      url: \"/\",\n      icon: LayoutDashboard,\n      testId: \"nav-dashboard\",\n      show: true,\n    },\n    {\n      title: \"Tasks\",\n      url: \"/tasks\",\n      icon: ClipboardList,\n      testId: \"nav-tasks\",\n      show: hasPermission(PERMISSION_TYPES.VIEW_TASKS),\n    },\n    {\n      title: \"Departments\",\n      url: \"/departments\",\n      icon: Building2,\n      testId: \"nav-departments\",\n      show: hasPermission(PERMISSION_TYPES.VIEW_ALL_DEPARTMENTS) || hasPermission(PERMISSION_TYPES.VIEW_OWN_DEPARTMENT),\n    },\n    {\n      title: \"Team Members\",\n      url: \"/team\",\n      icon: UserCog,\n      testId: \"nav-team\",\n      show: hasPermission(PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS) || hasPermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS),\n    },\n    {\n      title: \"User Management\",\n      url: \"/users\",\n      icon: Users,\n      testId: \"nav-users\",\n      show: hasPermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS),\n    },\n    {\n      title: \"Analytics\",\n      url: \"/analytics\",\n      icon: BarChart3,\n      testId: \"nav-analytics\",\n      show: hasPermission(PERMISSION_TYPES.VIEW_ANALYTICS),\n    },\n    {\n      title: \"Activity Logs\",\n      url: \"/activity\",\n      icon: Activity,\n      testId: \"nav-activity\",\n      show: hasPermission(PERMISSION_TYPES.VIEW_DEPARTMENT_LOGS) || hasPermission(PERMISSION_TYPES.VIEW_ALL_LOGS),\n    },\n    {\n      title: \"Configuration\",\n      url: \"/config\",\n      icon: Settings,\n      testId: \"nav-config\",\n      show: hasPermission(PERMISSION_TYPES.MANAGE_SERVICE_CONFIG),\n    },\n  ];\n\n  const visibleMenuItems = mainMenuItems.filter(item => item.show);\n\n  const platformItems = [\n    {\n      title: \"Metabase\",\n      icon: Database,\n    },\n    {\n      title: \"Chatwoot\",\n      icon: MessageSquare,\n    },\n    {\n      title: \"Typebot\",\n      icon: FormInput,\n    },\n    {\n      title: \"Mailcow\",\n      icon: Mail,\n    },\n  ];\n\n  const getRoleBadge = () => {\n    if (isManagement) return { label: \"Management\", variant: \"default\" as const };\n    if (isDepartmentAdmin) return { label: \"Dept Admin\", variant: \"secondary\" as const };\n    if (isTechnician) return { label: \"Technician\", variant: \"outline\" as const };\n    return null;\n  };\n\n  const roleBadge = getRoleBadge();\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4 border-b border-sidebar-border\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"flex h-9 w-9 items-center justify-center rounded-md bg-primary text-primary-foreground\">\n            <LayoutDashboard className=\"h-5 w-5\" />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h2 className=\"text-lg font-semibold text-sidebar-foreground\">Admin Hub</h2>\n            <div className=\"flex items-center gap-2\">\n              {roleBadge && (\n                <Badge variant={roleBadge.variant} className=\"text-xs\">\n                  {roleBadge.label}\n                </Badge>\n              )}\n              {teamMember?.departmentCode && (\n                <span className=\"text-xs text-muted-foreground\">{teamMember.departmentCode}</span>\n              )}\n            </div>\n          </div>\n        </div>\n      </SidebarHeader>\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {visibleMenuItems.map((item) => {\n                const isActive = location === item.url;\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton asChild isActive={isActive} data-testid={item.testId}>\n                      <Link href={item.url}>\n                        <item.icon className=\"h-4 w-4\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        {isManagement && (\n          <SidebarGroup>\n            <SidebarGroupLabel>Platforms</SidebarGroupLabel>\n            <SidebarGroupContent>\n              <SidebarMenu>\n                {platformItems.map((item) => (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                ))}\n              </SidebarMenu>\n            </SidebarGroupContent>\n          </SidebarGroup>\n        )}\n      </SidebarContent>\n      <SidebarFooter className=\"p-4 border-t border-sidebar-border\">\n        <div className=\"space-y-1\">\n          {teamMember && (\n            <p className=\"text-xs text-muted-foreground truncate\">\n              {teamMember.firstName} {teamMember.lastName}\n            </p>\n          )}\n          <p className=\"text-xs text-muted-foreground\">\n            v1.0.0 RBAC\n          </p>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","size_bytes":5818},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"replit.md":{"content":"# Admin Dashboard - Multi-Platform Management System\n\n## Overview\n\nThis is a unified admin dashboard application for managing multiple self-hosted platforms (Metabase, Chatwoot, Typebot, and Mailcow) from a single interface. The dashboard provides centralized user management, analytics monitoring, activity logging, and service configuration across all integrated platforms.\n\nThe application enables administrators to:\n- Create, edit, and deactivate user accounts across multiple platforms\n- Monitor analytics and metrics from integrated services\n- Track administrative actions through activity logs\n- Configure API connections and credentials for external services\n- Access a unified interface for multi-platform operations\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React with TypeScript, using Vite as the build tool and development server.\n\n**UI Component System**: \n- Built on shadcn/ui (Radix UI primitives with Tailwind CSS)\n- Design system follows Material Design principles with Carbon Design data patterns\n- Component library located in `client/src/components/ui/`\n- Custom application components in `client/src/components/`\n\n**Styling Approach**:\n- Tailwind CSS for utility-first styling\n- Custom CSS variables for theme management (light/dark mode support)\n- Design tokens defined in `client/src/index.css`\n- Typography uses Inter font family via Google Fonts\n- Responsive design with mobile-first breakpoints\n\n**State Management**:\n- TanStack Query (React Query) for server state management\n- Query client configuration in `client/src/lib/queryClient.ts`\n- Custom hooks for authentication (`useAuth`) and other features\n- Form state managed with React Hook Form and Zod validation\n\n**Routing**: \n- Wouter for client-side routing (lightweight React router)\n- Main routes: Dashboard, Users, Analytics, Activity, Configuration\n- Protected routes requiring authentication\n\n**Key Pages**:\n- Landing page for unauthenticated users\n- Dashboard with overview statistics and service status\n- User management with CRUD operations\n- Analytics visualization using Recharts\n- Activity logs for audit trail\n- Service configuration for API connections\n\n### Backend Architecture\n\n**Runtime**: Node.js with Express.js framework\n\n**Development vs Production**:\n- Development: Vite middleware integration for hot module replacement (`server/index-dev.ts`)\n- Production: Serves pre-built static assets (`server/index-prod.ts`)\n\n**API Design**:\n- RESTful API endpoints defined in `server/routes.ts`\n- Route handlers organized by feature (auth, services, users, activity, analytics)\n- Middleware for authentication using Replit Auth\n- Error handling with appropriate HTTP status codes\n\n**Session Management**:\n- Express session with PostgreSQL session store (connect-pg-simple)\n- Sessions table in database for persistence\n- Cookie-based authentication with httpOnly and secure flags\n- 7-day session timeout\n\n**Storage Layer** (`server/storage.ts`):\n- Interface-based design for database operations\n- Abstracts Drizzle ORM queries\n- Operations grouped by entity type (users, services, managed users, activity logs, analytics)\n- Supports both authentication user records and managed platform users\n\n### Database Architecture\n\n**ORM**: Drizzle ORM with PostgreSQL dialect\n\n**Database Provider**: Neon Serverless PostgreSQL (configured for serverless deployment)\n\n**Schema Design** (`shared/schema.ts`):\n\n1. **sessions**: Express session storage (required for authentication)\n2. **users**: Administrator accounts from Replit Auth (stores OIDC user profile data)\n3. **serviceConfigs**: API configuration for external platforms (Metabase, Chatwoot, Typebot, Mailcow)\n   - Stores API URLs, keys, enabled status\n   - Tracks last sync timestamp\n4. **managedUsers**: User accounts managed across integrated platforms\n   - Email, display name, platform assignments\n   - Active/inactive status\n   - Creation metadata\n5. **activityLogs**: Audit trail for administrative actions\n   - Admin user ID, action type, target entity\n   - Platform-specific details in JSON field\n6. **analyticsMetrics**: Time-series metrics data\n   - Platform-specific metric types\n   - Timestamp-based for trend analysis\n\n**Migration Strategy**:\n- Drizzle Kit for schema migrations\n- Migration files stored in `migrations/` directory\n- Schema defined in TypeScript, pushed to database via `db:push` script\n\n### Authentication & Authorization\n\n**Authentication Provider**: Dual authentication system\n- Replit Auth (OpenID Connect) for production\n- Development bypass with team member login (`server/devAuth.ts`)\n\n**RBAC Implementation** (`server/rbac.ts`):\n- Three-tier role hierarchy: Technician  Department Admin  Management\n- 16 granular permissions covering tasks, departments, users, and analytics\n- Role-permission mappings stored in database\n- Department-based data segregation\n\n**Roles**:\n1. **Management**: Full platform access, cross-department visibility\n2. **Department Admin**: Department-scoped access, team management\n3. **Technician**: Task execution, limited department access\n\n**Key Permissions**:\n- Task management: view_tasks, create_task, update_task, delete_task, assign_task\n- Department access: view_own_department, view_all_departments\n- User management: manage_department_users, manage_global_users\n- Analytics/Logs: view_analytics, view_department_logs, view_all_logs\n- Configuration: manage_service_config\n\n**Authorization Middleware**:\n- `isAuthenticated`: Basic authentication check\n- `isTeamMemberAuthenticated`: Team member with permissions\n- `requirePermission`: Single permission enforcement\n- `requireAnyPermission`: Any of multiple permissions\n\n**User Flow**:\n1. Unauthenticated users see landing page\n2. Login via Replit Auth or dev login endpoint\n3. Team member record linked to user account\n4. Permissions loaded from role-permission mappings\n5. Protected routes check authentication and permissions\n\n### External Dependencies\n\n**Third-Party Services**:\n- **Metabase**: Business intelligence and analytics platform\n- **Chatwoot**: Customer engagement and support platform\n- **Typebot**: Conversational forms and chatbot builder\n- **Mailcow**: Email server management platform\n\n**Integration Approach**:\n- Service configurations stored in `serviceConfigs` table\n- API URLs and keys configurable per service\n- Enable/disable toggle for each platform\n- Last sync tracking for data synchronization\n- Future implementation: API clients for each platform to manage users and fetch analytics\n\n**UI Libraries**:\n- Radix UI primitives for accessible component foundations\n- Recharts for data visualization\n- Lucide React for iconography\n- date-fns for date formatting\n- cmdk for command palette functionality\n\n**Development Tools**:\n- TypeScript for type safety\n- Vite for fast development builds\n- Drizzle Kit for database migrations\n- ESBuild for production bundling\n\n**Deployment Platform**:\n- Designed for Replit deployment\n- Replit-specific plugins for development experience\n- Environment variable configuration via `.env`\n- PostgreSQL provisioned through Replit\n\n### Build & Deployment\n\n**Scripts**:\n- `dev`: Development server with Vite middleware and hot reload\n- `build`: Production build (Vite for client, ESBuild for server)\n- `start`: Production server serving static assets\n- `db:push`: Apply database schema changes\n\n**Static Asset Handling**:\n- Client built to `dist/public/`\n- Server bundled to `dist/index.js`\n- Single-page application with client-side routing\n- All routes fall through to `index.html` for client-side navigation\n\n**Environment Requirements**:\n- `DATABASE_URL`: PostgreSQL connection string\n- `SESSION_SECRET`: Express session encryption key\n- `REPL_ID`: Replit workspace identifier\n- `ISSUER_URL`: OIDC provider URL (defaults to Replit)","size_bytes":7866},"client/src/pages/tasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Plus, \n  Clock, \n  CheckCircle2, \n  AlertCircle, \n  Pause, \n  XCircle,\n  Calendar,\n  User\n} from \"lucide-react\";\nimport type { Task, Department, TeamMember } from \"@shared/schema\";\n\nconst statusIcons = {\n  pending: Clock,\n  in_progress: AlertCircle,\n  completed: CheckCircle2,\n  on_hold: Pause,\n  cancelled: XCircle,\n};\n\nconst statusColors = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200\",\n  in_progress: \"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\",\n  completed: \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200\",\n  on_hold: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\",\n};\n\nconst priorityColors = {\n  low: \"bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200\",\n  medium: \"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\",\n  high: \"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200\",\n  urgent: \"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\",\n};\n\nexport default function Tasks() {\n  const { teamMember, hasPermission, PERMISSION_TYPES, isManagement, isDepartmentAdmin } = useAuth();\n  const { toast } = useToast();\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [selectedStatus, setSelectedStatus] = useState<string>(\"all\");\n\n  const { data: tasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\"],\n  });\n\n  const { data: departments = [] } = useQuery<Department[]>({\n    queryKey: [\"/api/departments\"],\n  });\n\n  const { data: teamMembers = [] } = useQuery<TeamMember[]>({\n    queryKey: [\"/api/team-members\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: Partial<Task>) => {\n      const res = await apiRequest(\"/api/tasks\", \"POST\", data);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks\"] });\n      setIsCreateOpen(false);\n      toast({ title: \"Task created successfully\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to create task\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: string; status: string }) => {\n      const res = await apiRequest(`/api/tasks/${id}`, \"PATCH\", { status });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks\"] });\n      toast({ title: \"Task status updated\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Failed to update task\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const canCreateTask = hasPermission(PERMISSION_TYPES.CREATE_TASK) || hasPermission(PERMISSION_TYPES.ASSIGN_TASK);\n  const canUpdateTask = hasPermission(PERMISSION_TYPES.UPDATE_TASK);\n\n  const filteredTasks = selectedStatus === \"all\" \n    ? tasks \n    : tasks.filter(task => task.status === selectedStatus);\n\n  const handleCreateTask = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    createMutation.mutate({\n      title: formData.get(\"title\") as string,\n      description: formData.get(\"description\") as string,\n      priority: formData.get(\"priority\") as string || \"medium\",\n      departmentId: formData.get(\"departmentId\") as string || teamMember?.departmentId,\n      assignedToId: formData.get(\"assignedToId\") as string || undefined,\n    });\n  };\n\n  const getDepartmentName = (departmentId: string) => {\n    const dept = departments.find(d => d.id === departmentId);\n    return dept?.name || dept?.code || \"Unknown\";\n  };\n\n  const getAssigneeName = (assignedToId: string | null) => {\n    if (!assignedToId) return \"Unassigned\";\n    const member = teamMembers.find(m => m.id === assignedToId);\n    return member ? `${member.firstName} ${member.lastName}` : \"Unknown\";\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-muted-foreground\">Loading tasks...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h1 className=\"text-2xl font-bold\" data-testid=\"text-page-title\">Tasks</h1>\n          <p className=\"text-muted-foreground\">\n            {isManagement ? \"All tasks across departments\" : \n             isDepartmentAdmin ? `Tasks in ${teamMember?.departmentName || \"your department\"}` :\n             \"Your assigned tasks\"}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <Select value={selectedStatus} onValueChange={setSelectedStatus}>\n            <SelectTrigger className=\"w-[150px]\" data-testid=\"select-status-filter\">\n              <SelectValue placeholder=\"Filter status\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Status</SelectItem>\n              <SelectItem value=\"pending\">Pending</SelectItem>\n              <SelectItem value=\"in_progress\">In Progress</SelectItem>\n              <SelectItem value=\"completed\">Completed</SelectItem>\n              <SelectItem value=\"on_hold\">On Hold</SelectItem>\n              <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n            </SelectContent>\n          </Select>\n          {canCreateTask && (\n            <Dialog open={isCreateOpen} onOpenChange={setIsCreateOpen}>\n              <DialogTrigger asChild>\n                <Button data-testid=\"button-create-task\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  New Task\n                </Button>\n              </DialogTrigger>\n              <DialogContent>\n                <DialogHeader>\n                  <DialogTitle>Create New Task</DialogTitle>\n                  <DialogDescription>\n                    Add a new task to be assigned to a technician.\n                  </DialogDescription>\n                </DialogHeader>\n                <form onSubmit={handleCreateTask} className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"title\">Title</Label>\n                    <Input \n                      id=\"title\" \n                      name=\"title\" \n                      placeholder=\"Task title\" \n                      required \n                      data-testid=\"input-task-title\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"description\">Description</Label>\n                    <Textarea \n                      id=\"description\" \n                      name=\"description\" \n                      placeholder=\"Task description\" \n                      data-testid=\"input-task-description\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"priority\">Priority</Label>\n                    <Select name=\"priority\" defaultValue=\"medium\">\n                      <SelectTrigger data-testid=\"select-task-priority\">\n                        <SelectValue placeholder=\"Select priority\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"low\">Low</SelectItem>\n                        <SelectItem value=\"medium\">Medium</SelectItem>\n                        <SelectItem value=\"high\">High</SelectItem>\n                        <SelectItem value=\"urgent\">Urgent</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {isManagement && (\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"departmentId\">Department</Label>\n                      <Select name=\"departmentId\" defaultValue={teamMember?.departmentId}>\n                        <SelectTrigger data-testid=\"select-task-department\">\n                          <SelectValue placeholder=\"Select department\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {departments.map(dept => (\n                            <SelectItem key={dept.id} value={dept.id}>\n                              {dept.name} ({dept.code})\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n                  {(isManagement || isDepartmentAdmin) && (\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"assignedToId\">Assign To</Label>\n                      <Select name=\"assignedToId\">\n                        <SelectTrigger data-testid=\"select-task-assignee\">\n                          <SelectValue placeholder=\"Select team member\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {teamMembers\n                            .filter(m => isManagement || m.departmentId === teamMember?.departmentId)\n                            .map(member => (\n                            <SelectItem key={member.id} value={member.id}>\n                              {member.firstName} {member.lastName}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n                  <Button type=\"submit\" className=\"w-full\" disabled={createMutation.isPending} data-testid=\"button-submit-task\">\n                    {createMutation.isPending ? \"Creating...\" : \"Create Task\"}\n                  </Button>\n                </form>\n              </DialogContent>\n            </Dialog>\n          )}\n        </div>\n      </div>\n\n      {filteredTasks.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Clock className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <p className=\"text-muted-foreground\">No tasks found</p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4\">\n          {filteredTasks.map(task => {\n            const StatusIcon = statusIcons[task.status as keyof typeof statusIcons] || Clock;\n            return (\n              <Card key={task.id} data-testid={`card-task-${task.id}`}>\n                <CardHeader className=\"pb-2\">\n                  <div className=\"flex items-start justify-between gap-4 flex-wrap\">\n                    <div className=\"space-y-1\">\n                      <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                      {task.description && (\n                        <CardDescription>{task.description}</CardDescription>\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-2 flex-wrap\">\n                      <Badge className={priorityColors[task.priority as keyof typeof priorityColors] || priorityColors.medium}>\n                        {task.priority}\n                      </Badge>\n                      <Badge className={statusColors[task.status as keyof typeof statusColors] || statusColors.pending}>\n                        <StatusIcon className=\"h-3 w-3 mr-1\" />\n                        {task.status.replace(\"_\", \" \")}\n                      </Badge>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center justify-between gap-4 flex-wrap text-sm text-muted-foreground\">\n                    <div className=\"flex items-center gap-4 flex-wrap\">\n                      <span className=\"flex items-center gap-1\">\n                        <User className=\"h-4 w-4\" />\n                        {getAssigneeName(task.assignedToId)}\n                      </span>\n                      <span>\n                        {getDepartmentName(task.departmentId)}\n                      </span>\n                      {task.dueDate && (\n                        <span className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-4 w-4\" />\n                          {new Date(task.dueDate).toLocaleDateString()}\n                        </span>\n                      )}\n                    </div>\n                    {canUpdateTask && (\n                      <Select \n                        value={task.status} \n                        onValueChange={(status) => updateStatusMutation.mutate({ id: task.id, status })}\n                      >\n                        <SelectTrigger className=\"w-[140px]\" data-testid={`select-status-${task.id}`}>\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"pending\">Pending</SelectItem>\n                          <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                          <SelectItem value=\"completed\">Completed</SelectItem>\n                          <SelectItem value=\"on_hold\">On Hold</SelectItem>\n                          <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":14336},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/pages/activity.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Activity, Calendar } from \"lucide-react\";\nimport type { ActivityLog } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\nexport default function ActivityPage() {\n  const { data: activities, isLoading } = useQuery<ActivityLog[]>({\n    queryKey: [\"/api/activity\"],\n  });\n\n  const getActionBadgeVariant = (action: string) => {\n    if (action.includes(\"create\")) return \"default\";\n    if (action.includes(\"delete\")) return \"destructive\";\n    if (action.includes(\"update\")) return \"secondary\";\n    return \"outline\";\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold text-foreground\">Activity Logs</h1>\n        <p className=\"text-muted-foreground mt-1\">Track all administrative actions and changes</p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Recent Activities</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-md border border-border\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Timestamp</TableHead>\n                  <TableHead>Action</TableHead>\n                  <TableHead>Platform</TableHead>\n                  <TableHead>Target</TableHead>\n                  <TableHead>Details</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {isLoading ? (\n                  Array.from({ length: 8 }).map((_, i) => (\n                    <TableRow key={i}>\n                      <TableCell><Skeleton className=\"h-4 w-32\" /></TableCell>\n                      <TableCell><Skeleton className=\"h-6 w-24\" /></TableCell>\n                      <TableCell><Skeleton className=\"h-6 w-20\" /></TableCell>\n                      <TableCell><Skeleton className=\"h-4 w-28\" /></TableCell>\n                      <TableCell><Skeleton className=\"h-4 w-40\" /></TableCell>\n                    </TableRow>\n                  ))\n                ) : activities && activities.length > 0 ? (\n                  activities.map((activity) => (\n                    <TableRow key={activity.id} data-testid={`activity-row-${activity.id}`}>\n                      <TableCell className=\"text-sm\">\n                        <div className=\"flex items-center gap-2\">\n                          <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                          {format(new Date(activity.createdAt), \"MMM dd, yyyy HH:mm\")}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <Badge variant={getActionBadgeVariant(activity.action)}>\n                          {activity.action}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>\n                        {activity.platform ? (\n                          <Badge variant=\"outline\" className=\"capitalize\">\n                            {activity.platform}\n                          </Badge>\n                        ) : (\n                          <span className=\"text-muted-foreground text-sm\">N/A</span>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-sm\">\n                        {activity.targetType || \"N/A\"}\n                      </TableCell>\n                      <TableCell className=\"text-sm text-muted-foreground max-w-md truncate\">\n                        {activity.details\n                          ? typeof activity.details === \"string\"\n                            ? activity.details\n                            : JSON.stringify(activity.details)\n                          : \"No additional details\"}\n                      </TableCell>\n                    </TableRow>\n                  ))\n                ) : (\n                  <TableRow>\n                    <TableCell colSpan={5} className=\"text-center py-12\">\n                      <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\n                        <Activity className=\"h-12 w-12 opacity-50\" />\n                        <p>No activity logs found</p>\n                        <p className=\"text-sm\">Admin actions will appear here</p>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                )}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4754},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"DEPARTMENT_TEAM_GUIDE.md":{"content":"# Department & Team Member Management Guide\n\n##  What I've Implemented For You\n\nI've added a complete department and team member management system to your Admin Hub! This allows you to organize your company structure with:\n\n- **Departments**: HA (Home Appliances), DTV, HHP\n- **Team Members**: Admins and Technicians in each department\n- **Login Credentials**: Generated for each team member with their role and department info\n\n##  Database Structure\n\n### New Tables Created:\n\n#### 1. **departments** table\n- **id**: Unique identifier\n- **name**: Full department name (e.g., \"Home Appliances\")\n- **code**: Short code (e.g., \"HA\", \"DTV\", \"HHP\")\n- **description**: Optional description\n- **status**: active/inactive\n- **createdAt/updatedAt**: Timestamps\n\n#### 2. **team_members** table\n- **id**: Unique identifier\n- **userId**: Link to user account (optional, for login access)\n- **departmentId**: Which department they belong to\n- **employeeId**: Employee number (e.g., \"EMP001\", \"HA-TEC-001\")\n- **email**: Employee email\n- **firstName/lastName**: Full name\n- **role**: \"admin\" or \"technician\"\n- **phone**: Contact number (optional)\n- **status**: active/inactive\n- **createdAt/updatedAt**: Timestamps\n\n##  API Endpoints Available\n\n### Department Endpoints:\n\n```\nGET    /api/departments           - Get all departments\nPOST   /api/departments           - Create new department\nPATCH  /api/departments/:id       - Update department\nDELETE /api/departments/:id       - Delete department\n```\n\n### Team Member Endpoints:\n\n```\nGET    /api/team-members          - Get all team members\nGET    /api/team-members?departmentId=xxx  - Get members by department\nPOST   /api/team-members          - Create new team member\nPATCH  /api/team-members/:id      - Update team member\nDELETE /api/team-members/:id      - Delete team member\n```\n\n##  How to Use It\n\n### Step 1: Create Your Departments\n\nUse the API or create a setup script to add your departments:\n\n```bash\n# Example using curl (make sure you're logged in first)\n\n# Create HA Department\ncurl -X POST http://localhost:5000/api/departments \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Home Appliances\",\n    \"code\": \"HA\",\n    \"description\": \"Home appliances division\",\n    \"status\": \"active\"\n  }'\n\n# Create DTV Department\ncurl -X POST http://localhost:5000/api/departments \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Digital TV\",\n    \"code\": \"DTV\",\n    \"description\": \"Digital TV and entertainment systems\",\n    \"status\": \"active\"\n  }'\n\n# Create HHP Department\ncurl -X POST http://localhost:5000/api/departments \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Handheld Products\",\n    \"code\": \"HHP\",\n    \"description\": \"Mobile and handheld devices\",\n    \"status\": \"active\"\n  }'\n```\n\n### Step 2: Add Team Members\n\nAfter creating departments, add your team members:\n\n```bash\n# Add an Admin to HA Department\ncurl -X POST http://localhost:5000/api/team-members \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"departmentId\": \"<department-id-from-step-1>\",\n    \"employeeId\": \"HA-ADM-001\",\n    \"email\": \"john.admin@company.com\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Admin\",\n    \"role\": \"admin\",\n    \"phone\": \"+1234567890\",\n    \"status\": \"active\"\n  }'\n\n# Add a Technician to HA Department\ncurl -X POST http://localhost:5000/api/team-members \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"departmentId\": \"<department-id-from-step-1>\",\n    \"employeeId\": \"HA-TEC-001\",\n    \"email\": \"jane.tech@company.com\",\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Technician\",\n    \"role\": \"technician\",\n    \"phone\": \"+1234567891\",\n    \"status\": \"active\"\n  }'\n```\n\n##  Login Credentials Generation\n\n### Option 1: Manual Employee ID Assignment\n\nWhen creating team members, you can assign custom employee IDs:\n\n```javascript\n{\n  \"employeeId\": \"HA-ADM-001\",      // Format: DEPT-ROLE-NUMBER\n  \"email\": \"john@company.com\",\n  \"role\": \"admin\",\n  \"departmentId\": \"xxx\"\n}\n```\n\n**Employee ID Format Examples:**\n- `HA-ADM-001`  Home Appliances, Admin, #001\n- `HA-TEC-001`  Home Appliances, Technician, #001\n- `DTV-ADM-001`  Digital TV, Admin, #001\n- `DTV-TEC-001`  Digital TV, Technician, #001\n- `HHP-ADM-001`  Handheld Products, Admin, #001\n\n### Option 2: Auto-Generate Employee IDs\n\nYou can create a helper function to auto-generate IDs:\n\n```typescript\nfunction generateEmployeeId(departmentCode: string, role: string, count: number): string {\n  const roleCode = role === 'admin' ? 'ADM' : 'TEC';\n  const number = String(count + 1).padStart(3, '0');\n  return `${departmentCode}-${roleCode}-${number}`;\n}\n\n// Example usage:\n// HA-ADM-001, HA-ADM-002, etc.\n```\n\n### Option 3: Link to User Authentication\n\nIf you want team members to have login access:\n\n1. Create a user account first (or they login via dev auth)\n2. Link the team member to that user:\n\n```javascript\n{\n  \"userId\": \"user-id-from-auth\",   // Links to users table\n  \"departmentId\": \"dept-id\",\n  \"employeeId\": \"HA-ADM-001\",\n  \"email\": \"john@company.com\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Admin\",\n  \"role\": \"admin\"\n}\n```\n\n##  Example Usage Scenarios\n\n### Scenario 1: View all HA Department Members\n\n```bash\nGET /api/team-members?departmentId=<ha-department-id>\n```\n\nResponse:\n```json\n[\n  {\n    \"id\": \"member-1\",\n    \"employeeId\": \"HA-ADM-001\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Admin\",\n    \"email\": \"john@company.com\",\n    \"role\": \"admin\",\n    \"status\": \"active\"\n  },\n  {\n    \"id\": \"member-2\",\n    \"employeeId\": \"HA-TEC-001\",\n    \"firstName\": \"Jane\",\n    \"lastName\": \"Technician\",\n    \"email\": \"jane@company.com\",\n    \"role\": \"technician\",\n    \"status\": \"active\"\n  }\n]\n```\n\n### Scenario 2: Generate Team Report\n\nQuery all departments and their members:\n\n```javascript\n// Get all departments\nconst departments = await fetch('/api/departments').then(r => r.json());\n\n// For each department, get members\nfor (const dept of departments) {\n  const members = await fetch(\n    `/api/team-members?departmentId=${dept.id}`\n  ).then(r => r.json());\n  \n  console.log(`${dept.name} (${dept.code}): ${members.length} members`);\n  console.log(`  Admins: ${members.filter(m => m.role === 'admin').length}`);\n  console.log(`  Technicians: ${members.filter(m => m.role === 'technician').length}`);\n}\n```\n\n##  UI Integration (Next Steps)\n\nYou can create UI pages for:\n\n### 1. **Departments Page** (`/departments`)\n- List all departments\n- Add/edit/delete departments\n- View department statistics\n\n### 2. **Team Members Page** (`/team`)\n- List all team members\n- Filter by department\n- Filter by role (admin/technician)\n- Add/edit/delete team members\n- Bulk import via CSV\n\n### 3. **Employee Dashboard**\n- Show employee details\n- Department assignment\n- Role and permissions\n- Activity history\n\n##  Integration with Existing Features\n\n### Activity Logs\nAll department and team member actions are automatically logged:\n- `created_department`\n- `updated_department`\n- `deleted_department`\n- `created_team_member`\n- `updated_team_member`\n- `deleted_team_member`\n\n### Analytics Integration\nYou can add department-specific analytics:\n```javascript\n// Get metrics by department\nconst metrics = await storage.getAnalyticsMetrics();\n// Filter by department or team member actions\n```\n\n##  Best Practices\n\n### Employee ID Naming Convention:\n```\n[DEPT_CODE]-[ROLE]-[NUMBER]\n\nExamples:\n  HA-ADM-001    (Home Appliances, Admin, #001)\n  HA-TEC-001    (Home Appliances, Technician, #001)\n  DTV-ADM-001   (Digital TV, Admin, #001)\n  HHP-TEC-005   (Handheld Products, Technician, #005)\n```\n\n### Status Management:\n- Use `\"active\"` for current employees\n- Use `\"inactive\"` for temporarily unavailable employees\n- Delete only when permanently removing records\n\n### Email Requirements:\n- Each team member must have a unique email\n- Use company email format: `firstname.lastname@company.com`\n- Email is used for notifications and login (if userId is linked)\n\n##  Quick Setup Script\n\nHere's a complete setup script to get you started:\n\n```javascript\n// setup-departments.js\nasync function setupDepartmentsAndTeam() {\n  const departments = [\n    { name: \"Home Appliances\", code: \"HA\", description: \"Home appliances division\" },\n    { name: \"Digital TV\", code: \"DTV\", description: \"Digital TV and entertainment\" },\n    { name: \"Handheld Products\", code: \"HHP\", description: \"Mobile devices division\" }\n  ];\n\n  // Create departments\n  for (const dept of departments) {\n    const response = await fetch('/api/departments', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ ...dept, status: 'active' })\n    });\n    const created = await response.json();\n    console.log(`Created department: ${created.name} (${created.code})`);\n\n    // Add sample team members\n    await createTeamMember(created.id, created.code, 'admin', 1);\n    await createTeamMember(created.id, created.code, 'technician', 1);\n    await createTeamMember(created.id, created.code, 'technician', 2);\n  }\n}\n\nasync function createTeamMember(deptId, deptCode, role, num) {\n  const roleCode = role === 'admin' ? 'ADM' : 'TEC';\n  const employeeId = `${deptCode}-${roleCode}-${String(num).padStart(3, '0')}`;\n  \n  const member = {\n    departmentId: deptId,\n    employeeId: employeeId,\n    email: `${employeeId.toLowerCase()}@company.com`,\n    firstName: `${roleCode}${num}`,\n    lastName: `User`,\n    role: role,\n    status: 'active'\n  };\n\n  const response = await fetch('/api/team-members', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(member)\n  });\n\n  const created = await response.json();\n  console.log(`  Added ${role}: ${created.employeeId}`);\n}\n\n// Run setup\nsetupDepartmentsAndTeam();\n```\n\n##  Summary\n\nYou now have a complete department and team member management system with:\n\n Department structure (HA, DTV, HHP)  \n Team member roles (Admin, Technician)  \n Employee ID system  \n Full CRUD APIs  \n Activity logging  \n Status management  \n\n## Next Steps\n\n1. **Create the UI pages** for department and team management\n2. **Add bulk import** functionality (CSV/Excel)\n3. **Generate printable employee cards** with credentials\n4. **Add role-based permissions** (restrict features by role)\n5. **Create department dashboards** with metrics\n\nWould you like me to help with any of these next steps?\n","size_bytes":10355},"client/src/pages/departments.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Plus, Pencil, Trash2, Users } from \"lucide-react\";\nimport type { Department } from \"@shared/schema\";\n\nexport default function Departments() {\n  const { toast } = useToast();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingDept, setEditingDept] = useState<Department | null>(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    code: \"\",\n    description: \"\",\n    status: \"active\"\n  });\n\n  const { data: departments = [], isLoading } = useQuery<Department[]>({\n    queryKey: [\"/api/departments\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => apiRequest(\"/api/departments\", \"POST\", data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/departments\"] });\n      toast({ title: \"Department created successfully\" });\n      closeDialog();\n    },\n    onError: (error: any) => {\n      const errorMsg = error?.response?.data?.error || error?.message || \"Failed to create department\";\n      toast({ title: \"Failed to create department\", description: errorMsg, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) =>\n      apiRequest(`/api/departments/${id}`, \"PATCH\", data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/departments\"] });\n      toast({ title: \"Department updated successfully\" });\n      closeDialog();\n    },\n    onError: () => {\n      toast({ title: \"Failed to update department\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(`/api/departments/${id}`, \"DELETE\"),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/departments\"] });\n      toast({ title: \"Department deleted successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Failed to delete department\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingDept) {\n      updateMutation.mutate({ id: editingDept.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const openEditDialog = (dept: Department) => {\n    setEditingDept(dept);\n    setFormData({\n      name: dept.name,\n      code: dept.code,\n      description: dept.description || \"\",\n      status: dept.status,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const closeDialog = () => {\n    setIsDialogOpen(false);\n    setEditingDept(null);\n    setFormData({ name: \"\", code: \"\", description: \"\", status: \"active\" });\n  };\n\n  if (isLoading) {\n    return <div className=\"p-6\">Loading departments...</div>;\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Departments</h1>\n          <p className=\"text-muted-foreground\">Manage company departments and divisions</p>\n        </div>\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-department\">\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Department\n            </Button>\n          </DialogTrigger>\n          <DialogContent>\n            <form onSubmit={handleSubmit}>\n              <DialogHeader>\n                <DialogTitle>\n                  {editingDept ? \"Edit Department\" : \"Add Department\"}\n                </DialogTitle>\n                <DialogDescription>\n                  {editingDept ? \"Update department information\" : \"Create a new department\"}\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Department Name</Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    placeholder=\"Home Appliances\"\n                    required\n                    data-testid=\"input-dept-name\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"code\">Department Code</Label>\n                  <Input\n                    id=\"code\"\n                    value={formData.code}\n                    onChange={(e) => setFormData({ ...formData, code: e.target.value.toUpperCase() })}\n                    placeholder=\"HA\"\n                    maxLength={10}\n                    required\n                    data-testid=\"input-dept-code\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    placeholder=\"Department description...\"\n                    data-testid=\"input-dept-description\"\n                  />\n                </div>\n              </div>\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={closeDialog}>\n                  Cancel\n                </Button>\n                <Button type=\"submit\" data-testid=\"button-submit-department\">\n                  {editingDept ? \"Update\" : \"Create\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n        {departments.map((dept) => (\n          <Card key={dept.id} data-testid={`card-department-${dept.code}`}>\n            <CardHeader>\n              <div className=\"flex items-start justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <span className=\"text-2xl font-bold text-primary\">{dept.code}</span>\n                  </CardTitle>\n                  <CardDescription className=\"mt-1\">{dept.name}</CardDescription>\n                </div>\n                <div className=\"flex gap-1\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => openEditDialog(dept)}\n                    data-testid={`button-edit-${dept.code}`}\n                  >\n                    <Pencil className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => {\n                      if (confirm(`Delete ${dept.name}?`)) {\n                        deleteMutation.mutate(dept.id);\n                      }\n                    }}\n                    data-testid={`button-delete-${dept.code}`}\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-sm text-muted-foreground mb-4\">\n                {dept.description || \"No description\"}\n              </p>\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"flex items-center gap-1\">\n                  <Users className=\"w-4 h-4\" />\n                  Status: {dept.status}\n                </span>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {departments.length === 0 && (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Users className=\"w-12 h-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">No departments yet</h3>\n            <p className=\"text-sm text-muted-foreground mb-4\">\n              Create your first department to get started\n            </p>\n            <Button onClick={() => setIsDialogOpen(true)}>\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Department\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","size_bytes":8886},"client/src/pages/users.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { insertManagedUserSchema, type ManagedUser, type InsertManagedUser } from \"@shared/schema\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Plus, Search, Edit, Trash2, UserX, UserCheck } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\nexport default function Users() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [platformFilter, setPlatformFilter] = useState<string>(\"all\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [editingUser, setEditingUser] = useState<ManagedUser | null>(null);\n  const [deletingUser, setDeletingUser] = useState<ManagedUser | null>(null);\n\n  const { data: users, isLoading } = useQuery<ManagedUser[]>({\n    queryKey: [\"/api/users\"],\n  });\n\n  const form = useForm<InsertManagedUser>({\n    resolver: zodResolver(insertManagedUserSchema),\n    defaultValues: {\n      email: \"\",\n      fullName: \"\",\n      platform: \"\",\n      role: \"\",\n      status: \"active\",\n      platformUserId: \"\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertManagedUser) => {\n      return await apiRequest(\"/api/users\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      setIsCreateOpen(false);\n      form.reset();\n      toast({\n        title: \"User created\",\n        description: \"The user has been created successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to create user. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: InsertManagedUser }) => {\n      return await apiRequest(`/api/users/${id}`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      setEditingUser(null);\n      form.reset();\n      toast({\n        title: \"User updated\",\n        description: \"The user has been updated successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to update user. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/users/${id}`, \"DELETE\", undefined);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      setDeletingUser(null);\n      toast({\n        title: \"User deleted\",\n        description: \"The user has been deleted successfully.\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete user. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredUsers = users?.filter((user) => {\n    const matchesSearch =\n      user.fullName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      user.email.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesPlatform = platformFilter === \"all\" || user.platform === platformFilter;\n    const matchesStatus = statusFilter === \"all\" || user.status === statusFilter;\n    return matchesSearch && matchesPlatform && matchesStatus;\n  });\n\n  const handleCreate = () => {\n    form.reset({\n      email: \"\",\n      fullName: \"\",\n      platform: \"\",\n      role: \"\",\n      status: \"active\",\n      platformUserId: \"\",\n    });\n    setIsCreateOpen(true);\n  };\n\n  const handleEdit = (user: ManagedUser) => {\n    form.reset({\n      email: user.email,\n      fullName: user.fullName,\n      platform: user.platform,\n      role: user.role || \"\",\n      status: user.status,\n      platformUserId: user.platformUserId || \"\",\n    });\n    setEditingUser(user);\n  };\n\n  const onSubmit = (data: InsertManagedUser) => {\n    if (editingUser) {\n      updateMutation.mutate({ id: editingUser.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold text-foreground\">User Management</h1>\n          <p className=\"text-muted-foreground mt-1\">Manage users across all platforms</p>\n        </div>\n        <Button onClick={handleCreate} data-testid=\"button-add-user\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add User\n        </Button>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search by name or email...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pl-9\"\n            data-testid=\"input-search\"\n          />\n        </div>\n        <Select value={platformFilter} onValueChange={setPlatformFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"select-platform-filter\">\n            <SelectValue placeholder=\"Filter by platform\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Platforms</SelectItem>\n            <SelectItem value=\"metabase\">Metabase</SelectItem>\n            <SelectItem value=\"chatwoot\">Chatwoot</SelectItem>\n            <SelectItem value=\"typebot\">Typebot</SelectItem>\n            <SelectItem value=\"mailcow\">Mailcow</SelectItem>\n          </SelectContent>\n        </Select>\n        <Select value={statusFilter} onValueChange={setStatusFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"select-status-filter\">\n            <SelectValue placeholder=\"Filter by status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Statuses</SelectItem>\n            <SelectItem value=\"active\">Active</SelectItem>\n            <SelectItem value=\"inactive\">Inactive</SelectItem>\n            <SelectItem value=\"suspended\">Suspended</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"rounded-md border border-border\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Name</TableHead>\n              <TableHead>Email</TableHead>\n              <TableHead>Platform</TableHead>\n              <TableHead>Role</TableHead>\n              <TableHead>Status</TableHead>\n              <TableHead className=\"text-right\">Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {isLoading ? (\n              Array.from({ length: 5 }).map((_, i) => (\n                <TableRow key={i}>\n                  <TableCell><Skeleton className=\"h-4 w-32\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-4 w-40\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-4 w-24\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-4 w-20\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-6 w-16\" /></TableCell>\n                  <TableCell className=\"text-right\"><Skeleton className=\"h-8 w-20 ml-auto\" /></TableCell>\n                </TableRow>\n              ))\n            ) : filteredUsers && filteredUsers.length > 0 ? (\n              filteredUsers.map((user) => (\n                <TableRow key={user.id} data-testid={`user-row-${user.id}`}>\n                  <TableCell className=\"font-medium\">{user.fullName}</TableCell>\n                  <TableCell>{user.email}</TableCell>\n                  <TableCell>\n                    <Badge variant=\"outline\" className=\"capitalize\">\n                      {user.platform}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"capitalize\">{user.role || \"N/A\"}</TableCell>\n                  <TableCell>\n                    <Badge\n                      variant={\n                        user.status === \"active\"\n                          ? \"default\"\n                          : user.status === \"suspended\"\n                          ? \"destructive\"\n                          : \"secondary\"\n                      }\n                      className=\"capitalize\"\n                    >\n                      {user.status}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex justify-end gap-2\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => handleEdit(user)}\n                        data-testid={`button-edit-${user.id}`}\n                      >\n                        <Edit className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => setDeletingUser(user)}\n                        data-testid={`button-delete-${user.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))\n            ) : (\n              <TableRow>\n                <TableCell colSpan={6} className=\"text-center py-12\">\n                  <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\n                    <UserX className=\"h-12 w-12 opacity-50\" />\n                    <p>No users found</p>\n                    {(searchQuery || platformFilter !== \"all\" || statusFilter !== \"all\") && (\n                      <Button\n                        variant=\"link\"\n                        onClick={() => {\n                          setSearchQuery(\"\");\n                          setPlatformFilter(\"all\");\n                          setStatusFilter(\"all\");\n                        }}\n                      >\n                        Clear filters\n                      </Button>\n                    )}\n                  </div>\n                </TableCell>\n              </TableRow>\n            )}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Create/Edit Dialog */}\n      <Dialog open={isCreateOpen || !!editingUser} onOpenChange={(open) => {\n        if (!open) {\n          setIsCreateOpen(false);\n          setEditingUser(null);\n          form.reset();\n        }\n      }}>\n        <DialogContent data-testid=\"dialog-user-form\">\n          <DialogHeader>\n            <DialogTitle>{editingUser ? \"Edit User\" : \"Create User\"}</DialogTitle>\n            <DialogDescription>\n              {editingUser ? \"Update user information\" : \"Add a new user to the platform\"}\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"fullName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Full Name</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"John Doe\" data-testid=\"input-fullname\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input {...field} type=\"email\" placeholder=\"john@example.com\" data-testid=\"input-email\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"platform\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Platform</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-platform\">\n                          <SelectValue placeholder=\"Select platform\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"metabase\">Metabase</SelectItem>\n                        <SelectItem value=\"chatwoot\">Chatwoot</SelectItem>\n                        <SelectItem value=\"typebot\">Typebot</SelectItem>\n                        <SelectItem value=\"mailcow\">Mailcow</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"role\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Role</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"Admin, Agent, Viewer, etc.\" data-testid=\"input-role\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"status\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Status</FormLabel>\n                    <Select onValueChange={field.onChange} value={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-status\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"active\">Active</SelectItem>\n                        <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        <SelectItem value=\"suspended\">Suspended</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => {\n                    setIsCreateOpen(false);\n                    setEditingUser(null);\n                    form.reset();\n                  }}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={createMutation.isPending || updateMutation.isPending}\n                  data-testid=\"button-save-user\"\n                >\n                  {createMutation.isPending || updateMutation.isPending ? \"Saving...\" : \"Save\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog open={!!deletingUser} onOpenChange={(open) => !open && setDeletingUser(null)}>\n        <DialogContent data-testid=\"dialog-delete-confirm\">\n          <DialogHeader>\n            <DialogTitle>Delete User</DialogTitle>\n            <DialogDescription>\n              Are you sure you want to delete {deletingUser?.fullName}? This action cannot be undone.\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setDeletingUser(null)}\n              data-testid=\"button-cancel-delete\"\n            >\n              Cancel\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={() => deletingUser && deleteMutation.mutate(deletingUser.id)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":18534},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":635},"client/src/pages/team.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Plus, Pencil, Trash2, UserPlus } from \"lucide-react\";\nimport type { TeamMember, Department, Role } from \"@shared/schema\";\n\nexport default function Team() {\n  const { toast } = useToast();\n  const { teamMember, isManagement, isDepartmentAdmin, hasPermission, PERMISSION_TYPES } = useAuth();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingMember, setEditingMember] = useState<TeamMember | null>(null);\n  const [filterDept, setFilterDept] = useState<string>(\"all\");\n  const [formData, setFormData] = useState({\n    departmentId: \"\",\n    roleId: \"\",\n    employeeId: \"\",\n    email: \"\",\n    firstName: \"\",\n    lastName: \"\",\n    role: \"technician\",\n    phone: \"\",\n    status: \"active\",\n    password: \"\",\n  });\n\n  const { data: departments = [] } = useQuery<Department[]>({\n    queryKey: [\"/api/departments\"],\n  });\n\n  const { data: roles = [] } = useQuery<Role[]>({\n    queryKey: [\"/api/roles\"],\n  });\n\n  const { data: allMembers = [], isLoading } = useQuery<TeamMember[]>({\n    queryKey: [\"/api/team-members\"],\n  });\n\n  const canManageUsers = hasPermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS) || hasPermission(PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS);\n  const canManageAllDepts = hasPermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS);\n\n  const filteredMembers = (() => {\n    let result = allMembers;\n    \n    if (!isManagement && !canManageAllDepts && teamMember?.departmentId) {\n      result = result.filter(m => m.departmentId === teamMember.departmentId);\n    }\n    \n    if (filterDept !== \"all\") {\n      result = result.filter(m => m.departmentId === filterDept);\n    }\n    \n    return result;\n  })();\n\n  const members = filteredMembers;\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => apiRequest(\"/api/team-members\", \"POST\", data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/team-members\"] });\n      toast({ title: \"Team member created successfully\" });\n      closeDialog();\n    },\n    onError: (error: any) => {\n      const errorMsg = error?.response?.data?.error || error?.message || \"Failed to create team member\";\n      toast({ title: \"Failed to create team member\", description: errorMsg, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) =>\n      apiRequest(`/api/team-members/${id}`, \"PATCH\", data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/team-members\"] });\n      toast({ title: \"Team member updated successfully\" });\n      closeDialog();\n    },\n    onError: () => {\n      toast({ title: \"Failed to update team member\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(`/api/team-members/${id}`, \"DELETE\"),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/team-members\"] });\n      toast({ title: \"Team member deleted successfully\" });\n    },\n    onError: () => {\n      toast({ title: \"Failed to delete team member\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingMember) {\n      updateMutation.mutate({ id: editingMember.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const openEditDialog = (member: TeamMember) => {\n    setEditingMember(member);\n    setFormData({\n      departmentId: member.departmentId,\n      roleId: member.roleId || \"\",\n      employeeId: member.employeeId || \"\",\n      email: member.email,\n      firstName: member.firstName,\n      lastName: member.lastName,\n      role: member.role,\n      phone: member.phone || \"\",\n      status: member.status,\n      password: \"\",\n    });\n    setIsDialogOpen(true);\n  };\n\n  const closeDialog = () => {\n    setIsDialogOpen(false);\n    setEditingMember(null);\n    setFormData({\n      departmentId: \"\",\n      roleId: \"\",\n      employeeId: \"\",\n      email: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      role: \"technician\",\n      phone: \"\",\n      status: \"active\",\n      password: \"\",\n    });\n  };\n\n  const getDeptName = (deptId: string) => {\n    const dept = departments.find(d => d.id === deptId);\n    return dept ? `${dept.code} - ${dept.name}` : \"Unknown\";\n  };\n\n  if (isLoading) {\n    return <div className=\"p-6\">Loading team members...</div>;\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Team Members</h1>\n          <p className=\"text-muted-foreground\">Manage employees across all departments</p>\n        </div>\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-member\">\n              <UserPlus className=\"w-4 h-4 mr-2\" />\n              Add Team Member\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-2xl\">\n            <form onSubmit={handleSubmit}>\n              <DialogHeader>\n                <DialogTitle>\n                  {editingMember ? \"Edit Team Member\" : \"Add Team Member\"}\n                </DialogTitle>\n                <DialogDescription>\n                  {editingMember ? \"Update team member information\" : \"Add a new team member\"}\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"grid grid-cols-2 gap-4 py-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"firstName\">First Name</Label>\n                  <Input\n                    id=\"firstName\"\n                    value={formData.firstName}\n                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n                    required\n                    data-testid=\"input-first-name\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"lastName\">Last Name</Label>\n                  <Input\n                    id=\"lastName\"\n                    value={formData.lastName}\n                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n                    required\n                    data-testid=\"input-last-name\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                    required\n                    data-testid=\"input-email\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"phone\">Phone</Label>\n                  <Input\n                    id=\"phone\"\n                    value={formData.phone}\n                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                    data-testid=\"input-phone\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"department\">Department</Label>\n                  <Select\n                    value={formData.departmentId}\n                    onValueChange={(value) => setFormData({ ...formData, departmentId: value })}\n                    required\n                  >\n                    <SelectTrigger data-testid=\"select-department\">\n                      <SelectValue placeholder=\"Select department\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {departments.map((dept) => (\n                        <SelectItem key={dept.id} value={dept.id}>\n                          {dept.code} - {dept.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"role\">Role</Label>\n                  <Select\n                    value={formData.role}\n                    onValueChange={(value) => setFormData({ ...formData, role: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-role\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"admin\">Admin</SelectItem>\n                      <SelectItem value=\"technician\">Technician</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2 col-span-2\">\n                  <Label htmlFor=\"employeeId\">Employee ID</Label>\n                  <Input\n                    id=\"employeeId\"\n                    value={formData.employeeId}\n                    onChange={(e) => setFormData({ ...formData, employeeId: e.target.value })}\n                    placeholder=\"e.g., HA-ADM-001\"\n                    data-testid=\"input-employee-id\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Format: DEPT-ROLE-NUMBER (e.g., HA-ADM-001)\n                  </p>\n                </div>\n              </div>\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={closeDialog}>\n                  Cancel\n                </Button>\n                <Button type=\"submit\" data-testid=\"button-submit-member\">\n                  {editingMember ? \"Update\" : \"Create\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <div className=\"flex gap-2\">\n        <Select value={filterDept} onValueChange={setFilterDept}>\n          <SelectTrigger className=\"w-64\" data-testid=\"select-filter-dept\">\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Departments</SelectItem>\n            {departments.map((dept) => (\n              <SelectItem key={dept.id} value={dept.id}>\n                {dept.code} - {dept.name}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <Card>\n        <CardContent className=\"p-0\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Employee ID</TableHead>\n                <TableHead>Name</TableHead>\n                <TableHead>Email</TableHead>\n                <TableHead>Department</TableHead>\n                <TableHead>Role</TableHead>\n                <TableHead>Phone</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead className=\"w-20\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {members.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={8} className=\"text-center py-12\">\n                    <UserPlus className=\"w-12 h-12 text-muted-foreground mx-auto mb-4\" />\n                    <h3 className=\"text-lg font-semibold mb-2\">No team members yet</h3>\n                    <p className=\"text-sm text-muted-foreground mb-4\">\n                      Add your first team member to get started\n                    </p>\n                    <Button onClick={() => setIsDialogOpen(true)}>\n                      <Plus className=\"w-4 h-4 mr-2\" />\n                      Add Team Member\n                    </Button>\n                  </TableCell>\n                </TableRow>\n              ) : (\n                members.map((member) => (\n                  <TableRow key={member.id} data-testid={`row-member-${member.employeeId}`}>\n                    <TableCell className=\"font-mono text-sm\">{member.employeeId || \"\"}</TableCell>\n                    <TableCell className=\"font-medium\">\n                      {member.firstName} {member.lastName}\n                    </TableCell>\n                    <TableCell>{member.email}</TableCell>\n                    <TableCell>{getDeptName(member.departmentId)}</TableCell>\n                    <TableCell>\n                      <Badge variant={member.role === \"admin\" ? \"default\" : \"secondary\"}>\n                        {member.role}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>{member.phone || \"\"}</TableCell>\n                    <TableCell>\n                      <Badge variant={member.status === \"active\" ? \"default\" : \"outline\"}>\n                        {member.status}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"flex gap-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => openEditDialog(member)}\n                          data-testid={`button-edit-member-${member.employeeId}`}\n                        >\n                          <Pencil className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (confirm(`Delete ${member.firstName} ${member.lastName}?`)) {\n                              deleteMutation.mutate(member.id);\n                            }\n                          }}\n                          data-testid={`button-delete-member-${member.employeeId}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":14779},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"server/rbac.ts":{"content":"import { RequestHandler, Request, Response, NextFunction } from \"express\";\nimport { db } from \"./db\";\nimport { \n  roles, \n  permissions, \n  rolePermissions, \n  teamMembers,\n  departments,\n  ROLE_TYPES,\n  PERMISSION_TYPES,\n  type Role,\n  type Permission,\n  type TeamMember,\n  type PermissionType,\n  type RoleType,\n} from \"@shared/schema\";\nimport { eq, and, inArray } from \"drizzle-orm\";\n\nexport interface AuthenticatedTeamMember extends TeamMember {\n  roleName?: string;\n  roleCode?: RoleType;\n  roleLevel?: number;\n  departmentCode?: string;\n  departmentName?: string;\n  permissions?: string[];\n}\n\ndeclare global {\n  namespace Express {\n    interface Request {\n      teamMember?: AuthenticatedTeamMember;\n    }\n  }\n}\n\nexport async function getTeamMemberWithPermissions(teamMemberId: string): Promise<AuthenticatedTeamMember | null> {\n  const [member] = await db\n    .select()\n    .from(teamMembers)\n    .where(eq(teamMembers.id, teamMemberId));\n  \n  if (!member) return null;\n\n  let roleData: Role | undefined;\n  let departmentData: { code: string; name: string } | undefined;\n  let memberPermissions: string[] = [];\n\n  if (member.roleId) {\n    const [role] = await db.select().from(roles).where(eq(roles.id, member.roleId));\n    roleData = role;\n\n    if (role) {\n      const rolePerms = await db\n        .select({ code: permissions.code })\n        .from(rolePermissions)\n        .innerJoin(permissions, eq(rolePermissions.permissionId, permissions.id))\n        .where(eq(rolePermissions.roleId, role.id));\n      \n      memberPermissions = rolePerms.map(p => p.code);\n    }\n  }\n\n  const [dept] = await db\n    .select({ code: departments.code, name: departments.name })\n    .from(departments)\n    .where(eq(departments.id, member.departmentId));\n  departmentData = dept;\n\n  return {\n    ...member,\n    roleName: roleData?.name,\n    roleCode: roleData?.code as RoleType,\n    roleLevel: roleData?.level,\n    departmentCode: departmentData?.code,\n    departmentName: departmentData?.name,\n    permissions: memberPermissions,\n  };\n}\n\nexport function hasPermission(member: AuthenticatedTeamMember, permission: PermissionType): boolean {\n  if (!member.permissions) return false;\n  return member.permissions.includes(permission);\n}\n\nexport function hasAnyPermission(member: AuthenticatedTeamMember, permissions: PermissionType[]): boolean {\n  if (!member.permissions) return false;\n  return permissions.some(p => member.permissions?.includes(p));\n}\n\nexport function hasAllPermissions(member: AuthenticatedTeamMember, permissions: PermissionType[]): boolean {\n  if (!member.permissions) return false;\n  return permissions.every(p => member.permissions?.includes(p));\n}\n\nexport function isRole(member: AuthenticatedTeamMember, roleCode: RoleType): boolean {\n  return member.roleCode === roleCode;\n}\n\nexport function isRoleOrHigher(member: AuthenticatedTeamMember, roleCode: RoleType): boolean {\n  const roleLevels: Record<RoleType, number> = {\n    [ROLE_TYPES.TECHNICIAN]: 1,\n    [ROLE_TYPES.DEPARTMENT_ADMIN]: 2,\n    [ROLE_TYPES.MANAGEMENT]: 3,\n  };\n  \n  const requiredLevel = roleLevels[roleCode];\n  return (member.roleLevel ?? 0) >= requiredLevel;\n}\n\nexport function canAccessDepartment(member: AuthenticatedTeamMember, departmentId: string): boolean {\n  if (isRole(member, ROLE_TYPES.MANAGEMENT)) return true;\n  return member.departmentId === departmentId;\n}\n\nexport const requirePermission = (permission: PermissionType): RequestHandler => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const member = req.teamMember;\n    \n    if (!member) {\n      return res.status(401).json({ message: \"Authentication required\" });\n    }\n\n    if (!hasPermission(member, permission)) {\n      return res.status(403).json({ \n        message: \"Access denied\",\n        required: permission,\n      });\n    }\n\n    next();\n  };\n};\n\nexport const requireAnyPermission = (...permissions: PermissionType[]): RequestHandler => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const member = req.teamMember;\n    \n    if (!member) {\n      return res.status(401).json({ message: \"Authentication required\" });\n    }\n\n    if (!hasAnyPermission(member, permissions)) {\n      return res.status(403).json({ \n        message: \"Access denied\",\n        required: permissions,\n      });\n    }\n\n    next();\n  };\n};\n\nexport const requireRole = (roleCode: RoleType): RequestHandler => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const member = req.teamMember;\n    \n    if (!member) {\n      return res.status(401).json({ message: \"Authentication required\" });\n    }\n\n    if (!isRole(member, roleCode)) {\n      return res.status(403).json({ \n        message: \"Access denied\",\n        requiredRole: roleCode,\n      });\n    }\n\n    next();\n  };\n};\n\nexport const requireRoleOrHigher = (roleCode: RoleType): RequestHandler => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const member = req.teamMember;\n    \n    if (!member) {\n      return res.status(401).json({ message: \"Authentication required\" });\n    }\n\n    if (!isRoleOrHigher(member, roleCode)) {\n      return res.status(403).json({ \n        message: \"Access denied\",\n        minimumRole: roleCode,\n      });\n    }\n\n    next();\n  };\n};\n\nexport const requireDepartmentAccess = (getDepartmentId: (req: Request) => string | undefined): RequestHandler => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const member = req.teamMember;\n    \n    if (!member) {\n      return res.status(401).json({ message: \"Authentication required\" });\n    }\n\n    const departmentId = getDepartmentId(req);\n    if (!departmentId) {\n      return res.status(400).json({ message: \"Department ID required\" });\n    }\n\n    if (!canAccessDepartment(member, departmentId)) {\n      return res.status(403).json({ \n        message: \"Access denied to this department\",\n      });\n    }\n\n    next();\n  };\n};\n\nexport async function seedRolesAndPermissions(): Promise<void> {\n  const existingRoles = await db.select().from(roles);\n  if (existingRoles.length > 0) {\n    console.log(\"Roles already seeded, skipping...\");\n    return;\n  }\n\n  console.log(\"Seeding roles and permissions...\");\n\n  const roleData = [\n    { name: \"Technician\", code: ROLE_TYPES.TECHNICIAN, description: \"Field technician with task execution access\", level: 1 },\n    { name: \"Department Admin\", code: ROLE_TYPES.DEPARTMENT_ADMIN, description: \"Department administrator with department-level management\", level: 2 },\n    { name: \"Management\", code: ROLE_TYPES.MANAGEMENT, description: \"Global management with full system access\", level: 3 },\n  ];\n\n  const insertedRoles = await db.insert(roles).values(roleData).returning();\n  console.log(`Inserted ${insertedRoles.length} roles`);\n\n  const permissionData = [\n    { name: \"View Tasks\", code: PERMISSION_TYPES.VIEW_TASKS, category: \"tasks\" },\n    { name: \"Create Task\", code: PERMISSION_TYPES.CREATE_TASK, category: \"tasks\" },\n    { name: \"Update Task\", code: PERMISSION_TYPES.UPDATE_TASK, category: \"tasks\" },\n    { name: \"Delete Task\", code: PERMISSION_TYPES.DELETE_TASK, category: \"tasks\" },\n    { name: \"Assign Task\", code: PERMISSION_TYPES.ASSIGN_TASK, category: \"tasks\" },\n    { name: \"View Own Department\", code: PERMISSION_TYPES.VIEW_OWN_DEPARTMENT, category: \"departments\" },\n    { name: \"View All Departments\", code: PERMISSION_TYPES.VIEW_ALL_DEPARTMENTS, category: \"departments\" },\n    { name: \"View Department Dashboard\", code: PERMISSION_TYPES.VIEW_DEPARTMENT_DASHBOARD, category: \"dashboard\" },\n    { name: \"View Global Dashboard\", code: PERMISSION_TYPES.VIEW_GLOBAL_DASHBOARD, category: \"dashboard\" },\n    { name: \"Manage Department Users\", code: PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS, category: \"users\" },\n    { name: \"Manage Global Users\", code: PERMISSION_TYPES.MANAGE_GLOBAL_USERS, category: \"users\" },\n    { name: \"View Department Logs\", code: PERMISSION_TYPES.VIEW_DEPARTMENT_LOGS, category: \"logs\" },\n    { name: \"View All Logs\", code: PERMISSION_TYPES.VIEW_ALL_LOGS, category: \"logs\" },\n    { name: \"Manage Service Config\", code: PERMISSION_TYPES.MANAGE_SERVICE_CONFIG, category: \"settings\" },\n    { name: \"View Analytics\", code: PERMISSION_TYPES.VIEW_ANALYTICS, category: \"analytics\" },\n    { name: \"Submit Worklog\", code: PERMISSION_TYPES.SUBMIT_WORKLOG, category: \"tasks\" },\n  ];\n\n  const insertedPermissions = await db.insert(permissions).values(permissionData).returning();\n  console.log(`Inserted ${insertedPermissions.length} permissions`);\n\n  const permissionMap = new Map(insertedPermissions.map(p => [p.code, p.id]));\n  const roleMap = new Map(insertedRoles.map(r => [r.code, r.id]));\n\n  const technicianPerms = [\n    PERMISSION_TYPES.VIEW_TASKS,\n    PERMISSION_TYPES.UPDATE_TASK,\n    PERMISSION_TYPES.VIEW_OWN_DEPARTMENT,\n    PERMISSION_TYPES.SUBMIT_WORKLOG,\n  ];\n\n  const deptAdminPerms = [\n    ...technicianPerms,\n    PERMISSION_TYPES.CREATE_TASK,\n    PERMISSION_TYPES.ASSIGN_TASK,\n    PERMISSION_TYPES.VIEW_DEPARTMENT_DASHBOARD,\n    PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS,\n    PERMISSION_TYPES.VIEW_DEPARTMENT_LOGS,\n    PERMISSION_TYPES.VIEW_ANALYTICS,\n  ];\n\n  const managementPerms = [\n    ...Object.values(PERMISSION_TYPES),\n  ];\n\n  const rolePermissionData: { roleId: string; permissionId: string }[] = [];\n\n  const techRoleId = roleMap.get(ROLE_TYPES.TECHNICIAN);\n  const deptAdminRoleId = roleMap.get(ROLE_TYPES.DEPARTMENT_ADMIN);\n  const mgmtRoleId = roleMap.get(ROLE_TYPES.MANAGEMENT);\n\n  if (techRoleId) {\n    technicianPerms.forEach(perm => {\n      const permId = permissionMap.get(perm);\n      if (permId) rolePermissionData.push({ roleId: techRoleId, permissionId: permId });\n    });\n  }\n\n  if (deptAdminRoleId) {\n    deptAdminPerms.forEach(perm => {\n      const permId = permissionMap.get(perm);\n      if (permId) rolePermissionData.push({ roleId: deptAdminRoleId, permissionId: permId });\n    });\n  }\n\n  if (mgmtRoleId) {\n    managementPerms.forEach(perm => {\n      const permId = permissionMap.get(perm);\n      if (permId) rolePermissionData.push({ roleId: mgmtRoleId, permissionId: permId });\n    });\n  }\n\n  await db.insert(rolePermissions).values(rolePermissionData);\n  console.log(`Inserted ${rolePermissionData.length} role-permission mappings`);\n\n  console.log(\"Roles and permissions seeded successfully!\");\n}\n\nexport async function seedDefaultDepartments(): Promise<void> {\n  const existingDepts = await db.select().from(departments);\n  if (existingDepts.length > 0) {\n    console.log(\"Departments already seeded, skipping...\");\n    return;\n  }\n\n  console.log(\"Seeding default departments...\");\n\n  const deptData = [\n    { name: \"Home Appliances\", code: \"HA\", description: \"Home Appliances Department\" },\n    { name: \"Home Healthcare Products\", code: \"HHP\", description: \"Home Healthcare Products Department\" },\n    { name: \"Digital TV\", code: \"DTV\", description: \"Digital TV Department\" },\n  ];\n\n  const insertedDepts = await db.insert(departments).values(deptData).returning();\n  console.log(`Inserted ${insertedDepts.length} departments`);\n}\n","size_bytes":11006},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  boolean,\n  integer,\n  serial,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Role types for the system\nexport const ROLE_TYPES = {\n  TECHNICIAN: 'technician',\n  DEPARTMENT_ADMIN: 'department_admin',\n  MANAGEMENT: 'management',\n} as const;\n\nexport type RoleType = typeof ROLE_TYPES[keyof typeof ROLE_TYPES];\n\n// Permission types for granular access control\nexport const PERMISSION_TYPES = {\n  VIEW_TASKS: 'view_tasks',\n  CREATE_TASK: 'create_task',\n  UPDATE_TASK: 'update_task',\n  DELETE_TASK: 'delete_task',\n  ASSIGN_TASK: 'assign_task',\n  VIEW_OWN_DEPARTMENT: 'view_own_department',\n  VIEW_ALL_DEPARTMENTS: 'view_all_departments',\n  VIEW_DEPARTMENT_DASHBOARD: 'view_department_dashboard',\n  VIEW_GLOBAL_DASHBOARD: 'view_global_dashboard',\n  MANAGE_DEPARTMENT_USERS: 'manage_department_users',\n  MANAGE_GLOBAL_USERS: 'manage_global_users',\n  VIEW_DEPARTMENT_LOGS: 'view_department_logs',\n  VIEW_ALL_LOGS: 'view_all_logs',\n  MANAGE_SERVICE_CONFIG: 'manage_service_config',\n  VIEW_ANALYTICS: 'view_analytics',\n  SUBMIT_WORKLOG: 'submit_worklog',\n} as const;\n\nexport type PermissionType = typeof PERMISSION_TYPES[keyof typeof PERMISSION_TYPES];\n\n// Session storage table - Required for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table - Required for Replit Auth\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Roles table - RBAC role definitions\nexport const roles = pgTable(\"roles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\", { length: 50 }).notNull().unique(),\n  code: varchar(\"code\", { length: 30 }).notNull().unique(), // technician, department_admin, management\n  description: text(\"description\"),\n  level: integer(\"level\").notNull().default(1), // 1=technician, 2=dept_admin, 3=management\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertRoleSchema = createInsertSchema(roles).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertRole = z.infer<typeof insertRoleSchema>;\nexport type Role = typeof roles.$inferSelect;\n\n// Permissions table - Granular action permissions\nexport const permissions = pgTable(\"permissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\", { length: 100 }).notNull().unique(),\n  code: varchar(\"code\", { length: 50 }).notNull().unique(), // view_tasks, manage_global_users, etc.\n  description: text(\"description\"),\n  category: varchar(\"category\", { length: 50 }), // tasks, users, dashboard, settings\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertPermissionSchema = createInsertSchema(permissions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertPermission = z.infer<typeof insertPermissionSchema>;\nexport type Permission = typeof permissions.$inferSelect;\n\n// Role-Permissions junction table - Many-to-many relationship\nexport const rolePermissions = pgTable(\"role_permissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  roleId: varchar(\"role_id\").notNull().references(() => roles.id, { onDelete: 'cascade' }),\n  permissionId: varchar(\"permission_id\").notNull().references(() => permissions.id, { onDelete: 'cascade' }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport type RolePermission = typeof rolePermissions.$inferSelect;\n\n// Departments table - Company organizational structure\nexport const departments = pgTable(\"departments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\", { length: 50 }).notNull().unique(),\n  code: varchar(\"code\", { length: 10 }).notNull().unique(), // HA, DTV, HHP\n  description: text(\"description\"),\n  status: varchar(\"status\", { length: 20 }).default('active').notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertDepartmentSchema = createInsertSchema(departments).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertDepartment = z.infer<typeof insertDepartmentSchema>;\nexport type Department = typeof departments.$inferSelect;\n\n// Team Members table - Company employees with department assignments and RBAC\nexport const teamMembers = pgTable(\"team_members\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  departmentId: varchar(\"department_id\").notNull().references(() => departments.id),\n  roleId: varchar(\"role_id\").references(() => roles.id),\n  employeeId: varchar(\"employee_id\").unique(),\n  email: varchar(\"email\").notNull().unique(),\n  firstName: varchar(\"first_name\").notNull(),\n  lastName: varchar(\"last_name\").notNull(),\n  role: varchar(\"role\", { length: 50 }).notNull(), // legacy field: admin, technician\n  passwordHash: text(\"password_hash\"), // For local auth\n  phone: varchar(\"phone\", { length: 20 }),\n  status: varchar(\"status\", { length: 20 }).default('active').notNull(),\n  lastLoginAt: timestamp(\"last_login_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTeamMemberSchema = createInsertSchema(teamMembers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertTeamMember = z.infer<typeof insertTeamMemberSchema>;\nexport type TeamMember = typeof teamMembers.$inferSelect;\n\n// Service configurations for external platforms\nexport const serviceConfigs = pgTable(\"service_configs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  serviceName: varchar(\"service_name\", { length: 50 }).notNull().unique(), // metabase, chatwoot, typebot, mailcow\n  apiUrl: text(\"api_url\").notNull(),\n  apiKey: text(\"api_key\").notNull(),\n  enabled: boolean(\"enabled\").default(true).notNull(),\n  lastSyncAt: timestamp(\"last_sync_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertServiceConfigSchema = createInsertSchema(serviceConfigs).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  lastSyncAt: true,\n});\n\nexport type InsertServiceConfig = z.infer<typeof insertServiceConfigSchema>;\nexport type ServiceConfig = typeof serviceConfigs.$inferSelect;\n\n// Managed users across platforms\nexport const managedUsers = pgTable(\"managed_users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").notNull(),\n  fullName: varchar(\"full_name\").notNull(),\n  platform: varchar(\"platform\", { length: 50 }).notNull(), // metabase, chatwoot, typebot, mailcow\n  platformUserId: varchar(\"platform_user_id\"), // ID from the external platform\n  role: varchar(\"role\", { length: 50 }), // admin, agent, viewer, etc.\n  status: varchar(\"status\", { length: 20 }).default('active').notNull(), // active, inactive, suspended\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertManagedUserSchema = createInsertSchema(managedUsers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertManagedUser = z.infer<typeof insertManagedUserSchema>;\nexport type ManagedUser = typeof managedUsers.$inferSelect;\n\n// Activity logs for audit trail\nexport const activityLogs = pgTable(\"activity_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  adminId: varchar(\"admin_id\").notNull().references(() => users.id),\n  action: varchar(\"action\", { length: 100 }).notNull(), // created_user, deleted_user, updated_config, etc.\n  targetType: varchar(\"target_type\", { length: 50 }), // user, config, etc.\n  targetId: varchar(\"target_id\"),\n  platform: varchar(\"platform\", { length: 50 }), // metabase, chatwoot, typebot, mailcow\n  details: jsonb(\"details\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport type ActivityLog = typeof activityLogs.$inferSelect;\n\n// Analytics metrics cache\nexport const analyticsMetrics = pgTable(\"analytics_metrics\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  platform: varchar(\"platform\", { length: 50 }).notNull(), // metabase, chatwoot, typebot, mailcow\n  metricType: varchar(\"metric_type\", { length: 100 }).notNull(), // conversations_count, form_submissions, active_users, etc.\n  metricValue: integer(\"metric_value\").notNull(),\n  metricData: jsonb(\"metric_data\"), // Additional metric details\n  periodStart: timestamp(\"period_start\"),\n  periodEnd: timestamp(\"period_end\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport type AnalyticsMetric = typeof analyticsMetrics.$inferSelect;\n\n// Task status types\nexport const TASK_STATUS = {\n  PENDING: 'pending',\n  IN_PROGRESS: 'in_progress',\n  COMPLETED: 'completed',\n  ON_HOLD: 'on_hold',\n  CANCELLED: 'cancelled',\n} as const;\n\nexport type TaskStatus = typeof TASK_STATUS[keyof typeof TASK_STATUS];\n\n// Task priority types\nexport const TASK_PRIORITY = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  URGENT: 'urgent',\n} as const;\n\nexport type TaskPriority = typeof TASK_PRIORITY[keyof typeof TASK_PRIORITY];\n\n// Tasks table - Technician job/task management\nexport const tasks = pgTable(\"tasks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: varchar(\"title\", { length: 255 }).notNull(),\n  description: text(\"description\"),\n  departmentId: varchar(\"department_id\").notNull().references(() => departments.id),\n  createdById: varchar(\"created_by_id\").notNull().references(() => teamMembers.id),\n  assignedToId: varchar(\"assigned_to_id\").references(() => teamMembers.id),\n  status: varchar(\"status\", { length: 30 }).notNull().default('pending'),\n  priority: varchar(\"priority\", { length: 20 }).notNull().default('medium'),\n  dueDate: timestamp(\"due_date\"),\n  completedAt: timestamp(\"completed_at\"),\n  metadata: jsonb(\"metadata\"), // Additional task data\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTaskSchema = createInsertSchema(tasks).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  completedAt: true,\n});\n\nexport type InsertTask = z.infer<typeof insertTaskSchema>;\nexport type Task = typeof tasks.$inferSelect;\n\n// Task assignments table - Track who is assigned to tasks\nexport const taskAssignments = pgTable(\"task_assignments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  taskId: varchar(\"task_id\").notNull().references(() => tasks.id, { onDelete: 'cascade' }),\n  teamMemberId: varchar(\"team_member_id\").notNull().references(() => teamMembers.id),\n  assignedById: varchar(\"assigned_by_id\").notNull().references(() => teamMembers.id),\n  assignedAt: timestamp(\"assigned_at\").defaultNow(),\n  unassignedAt: timestamp(\"unassigned_at\"),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n});\n\nexport type TaskAssignment = typeof taskAssignments.$inferSelect;\n\n// Task history table - Audit trail for task changes\nexport const taskHistory = pgTable(\"task_history\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  taskId: varchar(\"task_id\").notNull().references(() => tasks.id, { onDelete: 'cascade' }),\n  changedById: varchar(\"changed_by_id\").notNull().references(() => teamMembers.id),\n  action: varchar(\"action\", { length: 50 }).notNull(), // created, updated, assigned, status_changed, completed\n  previousValue: jsonb(\"previous_value\"),\n  newValue: jsonb(\"new_value\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport type TaskHistory = typeof taskHistory.$inferSelect;\n\n// Worklogs table - Technician work time and notes\nexport const worklogs = pgTable(\"worklogs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  taskId: varchar(\"task_id\").notNull().references(() => tasks.id, { onDelete: 'cascade' }),\n  teamMemberId: varchar(\"team_member_id\").notNull().references(() => teamMembers.id),\n  hoursWorked: integer(\"hours_worked\"),\n  minutesWorked: integer(\"minutes_worked\"),\n  description: text(\"description\"),\n  workDate: timestamp(\"work_date\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertWorklogSchema = createInsertSchema(worklogs).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertWorklog = z.infer<typeof insertWorklogSchema>;\nexport type Worklog = typeof worklogs.$inferSelect;\n","size_bytes":13210},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"server/index-dev.ts":{"content":"import \"dotenv/config\";\nimport fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport { nanoid } from \"nanoid\";\nimport { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\n\nimport viteConfig from \"../vite.config\";\nimport runApp from \"./app\";\n\nexport async function setupVite(app: Express, server: Server) {\n  const viteLogger = createLogger();\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\n(async () => {\n  await runApp(setupVite);\n})();\n","size_bytes":1633},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  url: string,\n  method: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"server/db.ts":{"content":"// Database connection setup - Local PostgreSQL\nimport pkg from 'pg';\nconst { Pool } = pkg;\nimport { drizzle } from 'drizzle-orm/node-postgres';\nimport * as schema from \"@shared/schema\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":452},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"server/app.ts":{"content":"import { type Server } from \"node:http\";\n\nimport express, {\n  type Express,\n  type Request,\n  Response,\n  NextFunction,\n} from \"express\";\n\nimport { registerRoutes } from \"./routes\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport const app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\nexport default async function runApp(\n  setup: (app: Express, server: Server) => Promise<void>,\n) {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly run the final setup after setting up all the other routes so\n  // the catch-all route doesn't interfere with the other routes\n  await setup(app, server);\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n    },\n    () => {\n      log(`serving on port ${port}`);\n    }\n  );\n}\n","size_bytes":2483},"server/routes.ts":{"content":"// API routes for admin dashboard\nimport type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\n// Using development auth for local testing\nimport { setupAuth, isAuthenticated, isTeamMemberAuthenticated } from \"./devAuth\";\nimport {\n  insertServiceConfigSchema,\n  insertManagedUserSchema,\n  insertDepartmentSchema,\n  insertTeamMemberSchema,\n  insertTaskSchema,\n  insertWorklogSchema,\n  PERMISSION_TYPES,\n  ROLE_TYPES,\n} from \"@shared/schema\";\nimport {\n  requirePermission,\n  requireAnyPermission,\n  requireRole,\n  requireRoleOrHigher,\n  requireDepartmentAccess,\n  hasPermission,\n  isRole,\n  canAccessDepartment,\n} from \"./rbac\";\nimport bcrypt from \"bcryptjs\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Setup Replit Auth middleware\n  await setupAuth(app);\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Department routes\n  app.get('/api/departments', isAuthenticated, async (req: any, res) => {\n    try {\n      const departments = await storage.getAllDepartments();\n      res.json(departments);\n    } catch (error) {\n      console.error(\"Error fetching departments:\", error);\n      res.status(500).json({ message: \"Failed to fetch departments\" });\n    }\n  });\n\n  app.post('/api/departments', isAuthenticated, async (req: any, res) => {\n    try {\n      const validatedData = insertDepartmentSchema.parse(req.body);\n      const department = await storage.createDepartment(validatedData);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"created_department\",\n        \"department\",\n        department.id\n      );\n\n      res.json(department);\n    } catch (error) {\n      console.error(\"Error creating department:\", error instanceof Error ? error.message : error);\n      const message = error instanceof Error ? error.message : \"Failed to create department\";\n      res.status(400).json({ message, error: message });\n    }\n  });\n\n  app.patch('/api/departments/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const validatedData = insertDepartmentSchema.partial().parse(req.body);\n      const department = await storage.updateDepartment(id, validatedData);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"updated_department\",\n        \"department\",\n        id\n      );\n\n      res.json(department);\n    } catch (error) {\n      console.error(\"Error updating department:\", error);\n      res.status(400).json({ message: \"Failed to update department\" });\n    }\n  });\n\n  app.delete('/api/departments/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.deleteDepartment(id);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"deleted_department\",\n        \"department\",\n        id\n      );\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting department:\", error);\n      res.status(400).json({ message: \"Failed to delete department\" });\n    }\n  });\n\n  // Team Member routes\n  app.get('/api/team-members', isAuthenticated, async (req: any, res) => {\n    try {\n      const { departmentId } = req.query;\n      const members = departmentId \n        ? await storage.getTeamMembersByDepartment(departmentId as string)\n        : await storage.getAllTeamMembers();\n      res.json(members);\n    } catch (error) {\n      console.error(\"Error fetching team members:\", error);\n      res.status(500).json({ message: \"Failed to fetch team members\" });\n    }\n  });\n\n  app.post('/api/team-members', isAuthenticated, async (req: any, res) => {\n    try {\n      const validatedData = insertTeamMemberSchema.parse(req.body);\n      const member = await storage.createTeamMember(validatedData);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"created_team_member\",\n        \"team_member\",\n        member.id,\n        undefined,\n        { employeeId: member.employeeId, role: member.role }\n      );\n\n      res.json(member);\n    } catch (error) {\n      console.error(\"Error creating team member:\", error instanceof Error ? error.message : error);\n      const message = error instanceof Error ? error.message : \"Failed to create team member\";\n      res.status(400).json({ message, error: message });\n    }\n  });\n\n  app.patch('/api/team-members/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const validatedData = insertTeamMemberSchema.partial().parse(req.body);\n      const member = await storage.updateTeamMember(id, validatedData);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"updated_team_member\",\n        \"team_member\",\n        id\n      );\n\n      res.json(member);\n    } catch (error) {\n      console.error(\"Error updating team member:\", error);\n      res.status(400).json({ message: \"Failed to update team member\" });\n    }\n  });\n\n  app.delete('/api/team-members/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.deleteTeamMember(id);\n      \n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"deleted_team_member\",\n        \"team_member\",\n        id\n      );\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting team member:\", error);\n      res.status(400).json({ message: \"Failed to delete team member\" });\n    }\n  });\n\n  // Service configuration routes\n  app.get('/api/services', isAuthenticated, async (req: any, res) => {\n    try {\n      const services = await storage.getAllServices();\n      res.json(services);\n    } catch (error) {\n      console.error(\"Error fetching services:\", error);\n      res.status(500).json({ message: \"Failed to fetch services\" });\n    }\n  });\n\n  app.post('/api/services', isAuthenticated, async (req: any, res) => {\n    try {\n      const validatedData = insertServiceConfigSchema.parse(req.body);\n      \n      // Check if service already exists\n      const existing = await storage.getServiceByName(validatedData.serviceName);\n      if (existing) {\n        return res.status(400).json({ message: \"Service already exists\" });\n      }\n\n      const service = await storage.createService(validatedData);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"created_service_config\",\n        \"service_config\",\n        service.id,\n        validatedData.serviceName\n      );\n\n      res.json(service);\n    } catch (error) {\n      console.error(\"Error creating service:\", error);\n      res.status(400).json({ message: \"Failed to create service\" });\n    }\n  });\n\n  app.patch('/api/services/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const validatedData = insertServiceConfigSchema.partial().parse(req.body);\n      \n      const service = await storage.updateService(id, validatedData);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"updated_service_config\",\n        \"service_config\",\n        id,\n        service.serviceName\n      );\n\n      res.json(service);\n    } catch (error) {\n      console.error(\"Error updating service:\", error);\n      res.status(400).json({ message: \"Failed to update service\" });\n    }\n  });\n\n  app.delete('/api/services/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.deleteService(id);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"deleted_service_config\",\n        \"service_config\",\n        id\n      );\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting service:\", error);\n      res.status(400).json({ message: \"Failed to delete service\" });\n    }\n  });\n\n  app.post('/api/services/:serviceName/test', isAuthenticated, async (req: any, res) => {\n    try {\n      const { serviceName } = req.params;\n      \n      // In a real implementation, this would test the actual API connection\n      // For now, we'll just check if the service is configured\n      const service = await storage.getServiceByName(serviceName);\n      \n      if (!service) {\n        return res.status(404).json({ message: \"Service not configured\" });\n      }\n\n      if (!service.enabled) {\n        return res.status(400).json({ message: \"Service is disabled\" });\n      }\n\n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"tested_service_connection\",\n        \"service_config\",\n        service.id,\n        serviceName\n      );\n\n      res.json({ success: true, message: \"Connection test successful\" });\n    } catch (error) {\n      console.error(\"Error testing service:\", error);\n      res.status(500).json({ message: \"Connection test failed\" });\n    }\n  });\n\n  // Managed user routes\n  app.get('/api/users', isAuthenticated, async (req: any, res) => {\n    try {\n      const users = await storage.getAllManagedUsers();\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  app.post('/api/users', isAuthenticated, async (req: any, res) => {\n    try {\n      const validatedData = insertManagedUserSchema.parse(req.body);\n      const user = await storage.createManagedUser(validatedData);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"created_user\",\n        \"managed_user\",\n        user.id,\n        validatedData.platform,\n        { email: validatedData.email, fullName: validatedData.fullName }\n      );\n\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error creating user:\", error);\n      res.status(400).json({ message: \"Failed to create user\" });\n    }\n  });\n\n  app.patch('/api/users/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const validatedData = insertManagedUserSchema.partial().parse(req.body);\n      \n      const user = await storage.updateManagedUser(id, validatedData);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"updated_user\",\n        \"managed_user\",\n        id,\n        user.platform,\n        { email: user.email }\n      );\n\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error updating user:\", error);\n      res.status(400).json({ message: \"Failed to update user\" });\n    }\n  });\n\n  app.delete('/api/users/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const user = await storage.getManagedUser(id);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      await storage.deleteManagedUser(id);\n      \n      // Log activity\n      await storage.createActivityLog(\n        req.user.claims.sub,\n        \"deleted_user\",\n        \"managed_user\",\n        id,\n        user.platform,\n        { email: user.email, fullName: user.fullName }\n      );\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting user:\", error);\n      res.status(400).json({ message: \"Failed to delete user\" });\n    }\n  });\n\n  // Activity log routes\n  app.get('/api/activity', isAuthenticated, async (req: any, res) => {\n    try {\n      const activities = await storage.getActivityLogs(100);\n      res.json(activities);\n    } catch (error) {\n      console.error(\"Error fetching activities:\", error);\n      res.status(500).json({ message: \"Failed to fetch activities\" });\n    }\n  });\n\n  app.get('/api/activity/recent', isAuthenticated, async (req: any, res) => {\n    try {\n      const activities = await storage.getRecentActivityLogs();\n      res.json(activities);\n    } catch (error) {\n      console.error(\"Error fetching recent activities:\", error);\n      res.status(500).json({ message: \"Failed to fetch recent activities\" });\n    }\n  });\n\n  // Analytics routes\n  app.get('/api/analytics/metrics', isAuthenticated, async (req: any, res) => {\n    try {\n      const metrics = await storage.getAnalyticsMetrics();\n      res.json(metrics);\n    } catch (error) {\n      console.error(\"Error fetching analytics:\", error);\n      res.status(500).json({ message: \"Failed to fetch analytics\" });\n    }\n  });\n\n  // Dashboard stats route\n  app.get('/api/stats', isAuthenticated, async (req: any, res) => {\n    try {\n      const stats = await storage.getStats();\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch stats\" });\n    }\n  });\n\n  // RBAC Routes - Roles and Permissions\n  app.get('/api/roles', isAuthenticated, async (req: any, res) => {\n    try {\n      const allRoles = await storage.getAllRoles();\n      res.json(allRoles);\n    } catch (error) {\n      console.error(\"Error fetching roles:\", error);\n      res.status(500).json({ message: \"Failed to fetch roles\" });\n    }\n  });\n\n  app.get('/api/permissions', isAuthenticated, async (req: any, res) => {\n    try {\n      const allPermissions = await storage.getAllPermissions();\n      res.json(allPermissions);\n    } catch (error) {\n      console.error(\"Error fetching permissions:\", error);\n      res.status(500).json({ message: \"Failed to fetch permissions\" });\n    }\n  });\n\n  app.get('/api/roles/:roleId/permissions', isAuthenticated, async (req: any, res) => {\n    try {\n      const { roleId } = req.params;\n      const rolePermissions = await storage.getPermissionsByRole(roleId);\n      res.json(rolePermissions);\n    } catch (error) {\n      console.error(\"Error fetching role permissions:\", error);\n      res.status(500).json({ message: \"Failed to fetch role permissions\" });\n    }\n  });\n\n  // Task Routes\n  app.get('/api/tasks', isTeamMemberAuthenticated, async (req: any, res) => {\n    try {\n      const member = req.teamMember;\n      const { departmentId } = req.query;\n\n      let taskList;\n      \n      if (isRole(member, ROLE_TYPES.MANAGEMENT) || hasPermission(member, PERMISSION_TYPES.VIEW_ALL_DEPARTMENTS)) {\n        taskList = departmentId \n          ? await storage.getTasksByDepartment(departmentId as string)\n          : await storage.getAllTasks();\n      } else if (isRole(member, ROLE_TYPES.DEPARTMENT_ADMIN)) {\n        taskList = await storage.getTasksByDepartment(member.departmentId);\n      } else {\n        taskList = await storage.getTasksByAssignee(member.id);\n      }\n\n      res.json(taskList);\n    } catch (error) {\n      console.error(\"Error fetching tasks:\", error);\n      res.status(500).json({ message: \"Failed to fetch tasks\" });\n    }\n  });\n\n  app.get('/api/tasks/:id', isTeamMemberAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const task = await storage.getTask(id);\n      \n      if (!task) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      const member = req.teamMember;\n      if (!canAccessDepartment(member, task.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      res.json(task);\n    } catch (error) {\n      console.error(\"Error fetching task:\", error);\n      res.status(500).json({ message: \"Failed to fetch task\" });\n    }\n  });\n\n  app.post('/api/tasks', isTeamMemberAuthenticated, requireAnyPermission(PERMISSION_TYPES.CREATE_TASK, PERMISSION_TYPES.ASSIGN_TASK), async (req: any, res) => {\n    try {\n      const member = req.teamMember;\n      const validatedData = insertTaskSchema.parse({\n        ...req.body,\n        createdById: member.id,\n        departmentId: req.body.departmentId || member.departmentId,\n      });\n\n      if (!canAccessDepartment(member, validatedData.departmentId)) {\n        return res.status(403).json({ message: \"Cannot create task in this department\" });\n      }\n\n      const task = await storage.createTask(validatedData);\n\n      await storage.createTaskHistory(task.id, member.id, \"created\", null, validatedData);\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"created_task\",\n        \"task\",\n        task.id,\n        undefined,\n        { title: task.title, departmentId: task.departmentId }\n      );\n\n      res.json(task);\n    } catch (error) {\n      console.error(\"Error creating task:\", error);\n      res.status(400).json({ message: \"Failed to create task\" });\n    }\n  });\n\n  app.patch('/api/tasks/:id', isTeamMemberAuthenticated, requirePermission(PERMISSION_TYPES.UPDATE_TASK), async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const existingTask = await storage.getTask(id);\n      if (!existingTask) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, existingTask.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      const validatedData = insertTaskSchema.partial().parse(req.body);\n      \n      if (validatedData.status === 'completed' && existingTask.status !== 'completed') {\n        (validatedData as any).completedAt = new Date();\n      }\n\n      const task = await storage.updateTask(id, validatedData);\n\n      await storage.createTaskHistory(task.id, member.id, \"updated\", existingTask, validatedData);\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"updated_task\",\n        \"task\",\n        task.id,\n        undefined,\n        { title: task.title, changes: Object.keys(validatedData) }\n      );\n\n      res.json(task);\n    } catch (error) {\n      console.error(\"Error updating task:\", error);\n      res.status(400).json({ message: \"Failed to update task\" });\n    }\n  });\n\n  app.delete('/api/tasks/:id', isTeamMemberAuthenticated, requirePermission(PERMISSION_TYPES.DELETE_TASK), async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const existingTask = await storage.getTask(id);\n      if (!existingTask) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, existingTask.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      await storage.deleteTask(id);\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"deleted_task\",\n        \"task\",\n        id,\n        undefined,\n        { title: existingTask.title }\n      );\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting task:\", error);\n      res.status(400).json({ message: \"Failed to delete task\" });\n    }\n  });\n\n  // Task Assignment Routes\n  app.post('/api/tasks/:id/assign', isTeamMemberAuthenticated, requirePermission(PERMISSION_TYPES.ASSIGN_TASK), async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const { teamMemberId } = req.body;\n      const member = req.teamMember;\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, task.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      const assignment = await storage.assignTask(id, teamMemberId, member.id);\n      \n      await storage.updateTask(id, { assignedToId: teamMemberId });\n\n      await storage.createTaskHistory(task.id, member.id, \"assigned\", null, { assignedTo: teamMemberId });\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"assigned_task\",\n        \"task\",\n        task.id,\n        undefined,\n        { assignedTo: teamMemberId }\n      );\n\n      res.json(assignment);\n    } catch (error) {\n      console.error(\"Error assigning task:\", error);\n      res.status(400).json({ message: \"Failed to assign task\" });\n    }\n  });\n\n  app.get('/api/tasks/:id/history', isTeamMemberAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, task.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      const history = await storage.getTaskHistory(id);\n      res.json(history);\n    } catch (error) {\n      console.error(\"Error fetching task history:\", error);\n      res.status(500).json({ message: \"Failed to fetch task history\" });\n    }\n  });\n\n  // Worklog Routes\n  app.post('/api/worklogs', isTeamMemberAuthenticated, requirePermission(PERMISSION_TYPES.SUBMIT_WORKLOG), async (req: any, res) => {\n    try {\n      const member = req.teamMember;\n      const validatedData = insertWorklogSchema.parse({\n        ...req.body,\n        teamMemberId: member.id,\n      });\n\n      const task = await storage.getTask(validatedData.taskId);\n      if (!task) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, task.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      const worklog = await storage.createWorklog(validatedData);\n\n      await storage.createTaskHistory(task.id, member.id, \"worklog_added\", null, {\n        hoursWorked: validatedData.hoursWorked,\n        minutesWorked: validatedData.minutesWorked,\n      });\n\n      res.json(worklog);\n    } catch (error) {\n      console.error(\"Error creating worklog:\", error);\n      res.status(400).json({ message: \"Failed to create worklog\" });\n    }\n  });\n\n  app.get('/api/tasks/:id/worklogs', isTeamMemberAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ message: \"Task not found\" });\n      }\n\n      if (!canAccessDepartment(member, task.departmentId)) {\n        return res.status(403).json({ message: \"Access denied to this task\" });\n      }\n\n      const taskWorklogs = await storage.getWorklogsByTask(id);\n      res.json(taskWorklogs);\n    } catch (error) {\n      console.error(\"Error fetching worklogs:\", error);\n      res.status(500).json({ message: \"Failed to fetch worklogs\" });\n    }\n  });\n\n  app.get('/api/my-worklogs', isTeamMemberAuthenticated, async (req: any, res) => {\n    try {\n      const member = req.teamMember;\n      const myWorklogs = await storage.getWorklogsByTeamMember(member.id);\n      res.json(myWorklogs);\n    } catch (error) {\n      console.error(\"Error fetching worklogs:\", error);\n      res.status(500).json({ message: \"Failed to fetch worklogs\" });\n    }\n  });\n\n  // Enhanced Team Member Routes with RBAC\n  app.post('/api/team-members/create-with-password', \n    isTeamMemberAuthenticated, \n    requireAnyPermission(PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS, PERMISSION_TYPES.MANAGE_GLOBAL_USERS), \n    async (req: any, res) => {\n    try {\n      const member = req.teamMember;\n      const { password, ...memberData } = req.body;\n\n      if (!hasPermission(member, PERMISSION_TYPES.MANAGE_GLOBAL_USERS)) {\n        if (memberData.departmentId !== member.departmentId) {\n          return res.status(403).json({ message: \"Can only create members in your department\" });\n        }\n        if (memberData.roleId) {\n          const targetRole = await storage.getRole(memberData.roleId);\n          if (targetRole && targetRole.code === ROLE_TYPES.MANAGEMENT) {\n            return res.status(403).json({ message: \"Cannot create management users\" });\n          }\n        }\n      }\n\n      const validatedData = insertTeamMemberSchema.parse(memberData);\n      \n      let passwordHash = null;\n      if (password) {\n        passwordHash = await bcrypt.hash(password, 10);\n      }\n\n      const newMember = await storage.createTeamMember({\n        ...validatedData,\n        passwordHash,\n      } as any);\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"created_team_member\",\n        \"team_member\",\n        newMember.id,\n        undefined,\n        { email: newMember.email, role: newMember.role }\n      );\n\n      const { passwordHash: _, ...memberWithoutPassword } = newMember;\n      res.json(memberWithoutPassword);\n    } catch (error) {\n      console.error(\"Error creating team member:\", error);\n      res.status(400).json({ message: \"Failed to create team member\" });\n    }\n  });\n\n  app.patch('/api/team-members/:id/deactivate', \n    isTeamMemberAuthenticated, \n    requireAnyPermission(PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS, PERMISSION_TYPES.MANAGE_GLOBAL_USERS), \n    async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const targetMember = await storage.getTeamMember(id);\n      if (!targetMember) {\n        return res.status(404).json({ message: \"Team member not found\" });\n      }\n\n      if (!hasPermission(member, PERMISSION_TYPES.MANAGE_GLOBAL_USERS)) {\n        if (targetMember.departmentId !== member.departmentId) {\n          return res.status(403).json({ message: \"Can only deactivate members in your department\" });\n        }\n      }\n\n      const updated = await storage.updateTeamMember(id, { status: \"inactive\" });\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"deactivated_team_member\",\n        \"team_member\",\n        id,\n        undefined,\n        { email: targetMember.email }\n      );\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error deactivating team member:\", error);\n      res.status(400).json({ message: \"Failed to deactivate team member\" });\n    }\n  });\n\n  app.patch('/api/team-members/:id/activate', \n    isTeamMemberAuthenticated, \n    requireAnyPermission(PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS, PERMISSION_TYPES.MANAGE_GLOBAL_USERS), \n    async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const member = req.teamMember;\n\n      const targetMember = await storage.getTeamMember(id);\n      if (!targetMember) {\n        return res.status(404).json({ message: \"Team member not found\" });\n      }\n\n      if (!hasPermission(member, PERMISSION_TYPES.MANAGE_GLOBAL_USERS)) {\n        if (targetMember.departmentId !== member.departmentId) {\n          return res.status(403).json({ message: \"Can only activate members in your department\" });\n        }\n      }\n\n      const updated = await storage.updateTeamMember(id, { status: \"active\" });\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"activated_team_member\",\n        \"team_member\",\n        id,\n        undefined,\n        { email: targetMember.email }\n      );\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error activating team member:\", error);\n      res.status(400).json({ message: \"Failed to activate team member\" });\n    }\n  });\n\n  app.patch('/api/team-members/:id/change-role', \n    isTeamMemberAuthenticated, \n    requirePermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS), \n    async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const { roleId } = req.body;\n      const member = req.teamMember;\n\n      const targetMember = await storage.getTeamMember(id);\n      if (!targetMember) {\n        return res.status(404).json({ message: \"Team member not found\" });\n      }\n\n      const newRole = await storage.getRole(roleId);\n      if (!newRole) {\n        return res.status(400).json({ message: \"Invalid role\" });\n      }\n\n      const updated = await storage.updateTeamMember(id, { \n        roleId, \n        role: newRole.code,\n      });\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"changed_team_member_role\",\n        \"team_member\",\n        id,\n        undefined,\n        { email: targetMember.email, newRole: newRole.code }\n      );\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error changing team member role:\", error);\n      res.status(400).json({ message: \"Failed to change team member role\" });\n    }\n  });\n\n  app.patch('/api/team-members/:id/change-department', \n    isTeamMemberAuthenticated, \n    requirePermission(PERMISSION_TYPES.MANAGE_GLOBAL_USERS), \n    async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const { departmentId } = req.body;\n      const member = req.teamMember;\n\n      const targetMember = await storage.getTeamMember(id);\n      if (!targetMember) {\n        return res.status(404).json({ message: \"Team member not found\" });\n      }\n\n      const dept = await storage.getDepartment(departmentId);\n      if (!dept) {\n        return res.status(400).json({ message: \"Invalid department\" });\n      }\n\n      const updated = await storage.updateTeamMember(id, { departmentId });\n\n      await storage.createActivityLog(\n        member.userId || member.id,\n        \"changed_team_member_department\",\n        \"team_member\",\n        id,\n        undefined,\n        { email: targetMember.email, newDepartment: dept.code }\n      );\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error changing team member department:\", error);\n      res.status(400).json({ message: \"Failed to change team member department\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":29810},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"server/storage.ts":{"content":"// Storage layer - Database operations using Drizzle ORM\nimport {\n  users,\n  departments,\n  teamMembers,\n  serviceConfigs,\n  managedUsers,\n  activityLogs,\n  analyticsMetrics,\n  roles,\n  permissions,\n  rolePermissions,\n  tasks,\n  taskAssignments,\n  taskHistory,\n  worklogs,\n  type User,\n  type UpsertUser,\n  type Department,\n  type InsertDepartment,\n  type TeamMember,\n  type InsertTeamMember,\n  type ServiceConfig,\n  type InsertServiceConfig,\n  type ManagedUser,\n  type InsertManagedUser,\n  type ActivityLog,\n  type AnalyticsMetric,\n  type Role,\n  type InsertRole,\n  type Permission,\n  type Task,\n  type InsertTask,\n  type TaskAssignment,\n  type TaskHistory,\n  type Worklog,\n  type InsertWorklog,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, sql, and, gte, or, inArray } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations (required for Replit Auth)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n\n  // Role operations\n  getAllRoles(): Promise<Role[]>;\n  getRole(id: string): Promise<Role | undefined>;\n  getRoleByCode(code: string): Promise<Role | undefined>;\n\n  // Permission operations\n  getAllPermissions(): Promise<Permission[]>;\n  getPermissionsByRole(roleId: string): Promise<Permission[]>;\n\n  // Department operations\n  getAllDepartments(): Promise<Department[]>;\n  getDepartment(id: string): Promise<Department | undefined>;\n  getDepartmentByCode(code: string): Promise<Department | undefined>;\n  createDepartment(department: InsertDepartment): Promise<Department>;\n  updateDepartment(id: string, department: Partial<InsertDepartment>): Promise<Department>;\n  deleteDepartment(id: string): Promise<void>;\n\n  // Team Member operations\n  getAllTeamMembers(): Promise<TeamMember[]>;\n  getTeamMembersByDepartment(departmentId: string): Promise<TeamMember[]>;\n  getTeamMember(id: string): Promise<TeamMember | undefined>;\n  getTeamMemberByEmail(email: string): Promise<TeamMember | undefined>;\n  createTeamMember(member: InsertTeamMember): Promise<TeamMember>;\n  updateTeamMember(id: string, member: Partial<InsertTeamMember>): Promise<TeamMember>;\n  deleteTeamMember(id: string): Promise<void>;\n\n  // Task operations\n  getAllTasks(): Promise<Task[]>;\n  getTasksByDepartment(departmentId: string): Promise<Task[]>;\n  getTasksByAssignee(teamMemberId: string): Promise<Task[]>;\n  getTask(id: string): Promise<Task | undefined>;\n  createTask(task: InsertTask): Promise<Task>;\n  updateTask(id: string, task: Partial<InsertTask>): Promise<Task>;\n  deleteTask(id: string): Promise<void>;\n\n  // Task assignment operations\n  getTaskAssignments(taskId: string): Promise<TaskAssignment[]>;\n  assignTask(taskId: string, teamMemberId: string, assignedById: string): Promise<TaskAssignment>;\n  unassignTask(assignmentId: string): Promise<void>;\n\n  // Task history operations\n  createTaskHistory(taskId: string, changedById: string, action: string, previousValue?: any, newValue?: any, notes?: string): Promise<TaskHistory>;\n  getTaskHistory(taskId: string): Promise<TaskHistory[]>;\n\n  // Worklog operations\n  createWorklog(worklog: InsertWorklog): Promise<Worklog>;\n  getWorklogsByTask(taskId: string): Promise<Worklog[]>;\n  getWorklogsByTeamMember(teamMemberId: string): Promise<Worklog[]>;\n\n  // Service configuration operations\n  getAllServices(): Promise<ServiceConfig[]>;\n  getServiceByName(serviceName: string): Promise<ServiceConfig | undefined>;\n  createService(service: InsertServiceConfig): Promise<ServiceConfig>;\n  updateService(id: string, service: Partial<InsertServiceConfig>): Promise<ServiceConfig>;\n  deleteService(id: string): Promise<void>;\n\n  // Managed user operations\n  getAllManagedUsers(): Promise<ManagedUser[]>;\n  getManagedUser(id: string): Promise<ManagedUser | undefined>;\n  createManagedUser(user: InsertManagedUser): Promise<ManagedUser>;\n  updateManagedUser(id: string, user: Partial<InsertManagedUser>): Promise<ManagedUser>;\n  deleteManagedUser(id: string): Promise<void>;\n\n  // Activity log operations\n  createActivityLog(\n    adminId: string,\n    action: string,\n    targetType?: string,\n    targetId?: string,\n    platform?: string,\n    details?: any\n  ): Promise<ActivityLog>;\n  getActivityLogs(limit?: number): Promise<ActivityLog[]>;\n  getRecentActivityLogs(): Promise<ActivityLog[]>;\n\n  // Analytics operations\n  getAnalyticsMetrics(): Promise<any>;\n  getStats(): Promise<{\n    totalUsers: number;\n    activeUsers: number;\n    totalActivities: number;\n    servicesEnabled: number;\n  }>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations (required for Replit Auth)\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // Role operations\n  async getAllRoles(): Promise<Role[]> {\n    return await db.select().from(roles).orderBy(roles.level);\n  }\n\n  async getRole(id: string): Promise<Role | undefined> {\n    const [role] = await db.select().from(roles).where(eq(roles.id, id));\n    return role;\n  }\n\n  async getRoleByCode(code: string): Promise<Role | undefined> {\n    const [role] = await db.select().from(roles).where(eq(roles.code, code));\n    return role;\n  }\n\n  // Permission operations\n  async getAllPermissions(): Promise<Permission[]> {\n    return await db.select().from(permissions).orderBy(permissions.category, permissions.name);\n  }\n\n  async getPermissionsByRole(roleId: string): Promise<Permission[]> {\n    return await db\n      .select({\n        id: permissions.id,\n        name: permissions.name,\n        code: permissions.code,\n        description: permissions.description,\n        category: permissions.category,\n        createdAt: permissions.createdAt,\n      })\n      .from(rolePermissions)\n      .innerJoin(permissions, eq(rolePermissions.permissionId, permissions.id))\n      .where(eq(rolePermissions.roleId, roleId));\n  }\n\n  // Department operations\n  async getAllDepartments(): Promise<Department[]> {\n    return await db.select().from(departments).orderBy(departments.name);\n  }\n\n  async getDepartment(id: string): Promise<Department | undefined> {\n    const [dept] = await db.select().from(departments).where(eq(departments.id, id));\n    return dept;\n  }\n\n  async getDepartmentByCode(code: string): Promise<Department | undefined> {\n    const [dept] = await db.select().from(departments).where(eq(departments.code, code));\n    return dept;\n  }\n\n  async createDepartment(department: InsertDepartment): Promise<Department> {\n    const [created] = await db.insert(departments).values(department).returning();\n    return created;\n  }\n\n  async updateDepartment(id: string, department: Partial<InsertDepartment>): Promise<Department> {\n    const [updated] = await db\n      .update(departments)\n      .set({ ...department, updatedAt: new Date() })\n      .where(eq(departments.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteDepartment(id: string): Promise<void> {\n    await db.delete(departments).where(eq(departments.id, id));\n  }\n\n  // Team Member operations\n  async getAllTeamMembers(): Promise<TeamMember[]> {\n    return await db.select().from(teamMembers).orderBy(desc(teamMembers.createdAt));\n  }\n\n  async getTeamMembersByDepartment(departmentId: string): Promise<TeamMember[]> {\n    return await db\n      .select()\n      .from(teamMembers)\n      .where(eq(teamMembers.departmentId, departmentId))\n      .orderBy(teamMembers.lastName);\n  }\n\n  async getTeamMember(id: string): Promise<TeamMember | undefined> {\n    const [member] = await db.select().from(teamMembers).where(eq(teamMembers.id, id));\n    return member;\n  }\n\n  async getTeamMemberByEmail(email: string): Promise<TeamMember | undefined> {\n    const [member] = await db.select().from(teamMembers).where(eq(teamMembers.email, email));\n    return member;\n  }\n\n  async createTeamMember(member: InsertTeamMember): Promise<TeamMember> {\n    const [created] = await db.insert(teamMembers).values(member).returning();\n    return created;\n  }\n\n  async updateTeamMember(id: string, member: Partial<InsertTeamMember>): Promise<TeamMember> {\n    const [updated] = await db\n      .update(teamMembers)\n      .set({ ...member, updatedAt: new Date() })\n      .where(eq(teamMembers.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteTeamMember(id: string): Promise<void> {\n    await db.delete(teamMembers).where(eq(teamMembers.id, id));\n  }\n\n  // Service configuration operations\n  async getAllServices(): Promise<ServiceConfig[]> {\n    return await db.select().from(serviceConfigs).orderBy(serviceConfigs.serviceName);\n  }\n\n  async getServiceByName(serviceName: string): Promise<ServiceConfig | undefined> {\n    const [service] = await db\n      .select()\n      .from(serviceConfigs)\n      .where(eq(serviceConfigs.serviceName, serviceName));\n    return service;\n  }\n\n  async createService(service: InsertServiceConfig): Promise<ServiceConfig> {\n    const [created] = await db.insert(serviceConfigs).values(service).returning();\n    return created;\n  }\n\n  async updateService(id: string, service: Partial<InsertServiceConfig>): Promise<ServiceConfig> {\n    const [updated] = await db\n      .update(serviceConfigs)\n      .set({ ...service, updatedAt: new Date() })\n      .where(eq(serviceConfigs.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteService(id: string): Promise<void> {\n    await db.delete(serviceConfigs).where(eq(serviceConfigs.id, id));\n  }\n\n  // Managed user operations\n  async getAllManagedUsers(): Promise<ManagedUser[]> {\n    return await db.select().from(managedUsers).orderBy(desc(managedUsers.createdAt));\n  }\n\n  async getManagedUser(id: string): Promise<ManagedUser | undefined> {\n    const [user] = await db.select().from(managedUsers).where(eq(managedUsers.id, id));\n    return user;\n  }\n\n  async createManagedUser(user: InsertManagedUser): Promise<ManagedUser> {\n    const [created] = await db.insert(managedUsers).values(user).returning();\n    return created;\n  }\n\n  async updateManagedUser(id: string, user: Partial<InsertManagedUser>): Promise<ManagedUser> {\n    const [updated] = await db\n      .update(managedUsers)\n      .set({ ...user, updatedAt: new Date() })\n      .where(eq(managedUsers.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteManagedUser(id: string): Promise<void> {\n    await db.delete(managedUsers).where(eq(managedUsers.id, id));\n  }\n\n  // Activity log operations\n  async createActivityLog(\n    adminId: string,\n    action: string,\n    targetType?: string,\n    targetId?: string,\n    platform?: string,\n    details?: any\n  ): Promise<ActivityLog> {\n    const [log] = await db\n      .insert(activityLogs)\n      .values({\n        adminId,\n        action,\n        targetType,\n        targetId,\n        platform,\n        details,\n      })\n      .returning();\n    return log;\n  }\n\n  async getActivityLogs(limit: number = 100): Promise<ActivityLog[]> {\n    return await db\n      .select()\n      .from(activityLogs)\n      .orderBy(desc(activityLogs.createdAt))\n      .limit(limit);\n  }\n\n  async getRecentActivityLogs(): Promise<ActivityLog[]> {\n    const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n    return await db\n      .select()\n      .from(activityLogs)\n      .where(gte(activityLogs.createdAt, oneDayAgo))\n      .orderBy(desc(activityLogs.createdAt))\n      .limit(10);\n  }\n\n  // Analytics operations\n  async getAnalyticsMetrics(): Promise<any> {\n    const usersByPlatform = await db\n      .select({\n        platform: managedUsers.platform,\n        total: sql<number>`count(*)::int`,\n        active: sql<number>`count(*) filter (where ${managedUsers.status} = 'active')::int`,\n      })\n      .from(managedUsers)\n      .groupBy(managedUsers.platform);\n\n    const metrics: any = {\n      metabase: { users: 0, active: 0 },\n      chatwoot: { users: 0, active: 0 },\n      typebot: { users: 0, active: 0 },\n      mailcow: { users: 0, active: 0 },\n    };\n\n    usersByPlatform.forEach((row) => {\n      if (metrics[row.platform]) {\n        metrics[row.platform] = {\n          users: row.total,\n          active: row.active,\n        };\n      }\n    });\n\n    return metrics;\n  }\n\n  async getStats(): Promise<{\n    totalUsers: number;\n    activeUsers: number;\n    totalActivities: number;\n    servicesEnabled: number;\n  }> {\n    const [userStats] = await db\n      .select({\n        total: sql<number>`count(*)::int`,\n        active: sql<number>`count(*) filter (where ${managedUsers.status} = 'active')::int`,\n      })\n      .from(managedUsers);\n\n    const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n    const [activityStats] = await db\n      .select({\n        count: sql<number>`count(*)::int`,\n      })\n      .from(activityLogs)\n      .where(gte(activityLogs.createdAt, oneDayAgo));\n\n    const [serviceStats] = await db\n      .select({\n        enabled: sql<number>`count(*) filter (where ${serviceConfigs.enabled} = true)::int`,\n      })\n      .from(serviceConfigs);\n\n    return {\n      totalUsers: userStats?.total || 0,\n      activeUsers: userStats?.active || 0,\n      totalActivities: activityStats?.count || 0,\n      servicesEnabled: serviceStats?.enabled || 0,\n    };\n  }\n\n  // Task operations\n  async getAllTasks(): Promise<Task[]> {\n    return await db.select().from(tasks).orderBy(desc(tasks.createdAt));\n  }\n\n  async getTasksByDepartment(departmentId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.departmentId, departmentId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  async getTasksByAssignee(teamMemberId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.assignedToId, teamMemberId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  async getTask(id: string): Promise<Task | undefined> {\n    const [task] = await db.select().from(tasks).where(eq(tasks.id, id));\n    return task;\n  }\n\n  async createTask(task: InsertTask): Promise<Task> {\n    const [created] = await db.insert(tasks).values(task).returning();\n    return created;\n  }\n\n  async updateTask(id: string, task: Partial<InsertTask>): Promise<Task> {\n    const [updated] = await db\n      .update(tasks)\n      .set({ ...task, updatedAt: new Date() })\n      .where(eq(tasks.id, id))\n      .returning();\n    return updated;\n  }\n\n  async deleteTask(id: string): Promise<void> {\n    await db.delete(tasks).where(eq(tasks.id, id));\n  }\n\n  // Task assignment operations\n  async getTaskAssignments(taskId: string): Promise<TaskAssignment[]> {\n    return await db\n      .select()\n      .from(taskAssignments)\n      .where(and(eq(taskAssignments.taskId, taskId), eq(taskAssignments.isActive, true)));\n  }\n\n  async assignTask(taskId: string, teamMemberId: string, assignedById: string): Promise<TaskAssignment> {\n    const [assignment] = await db\n      .insert(taskAssignments)\n      .values({\n        taskId,\n        teamMemberId,\n        assignedById,\n        isActive: true,\n      })\n      .returning();\n    return assignment;\n  }\n\n  async unassignTask(assignmentId: string): Promise<void> {\n    await db\n      .update(taskAssignments)\n      .set({ isActive: false, unassignedAt: new Date() })\n      .where(eq(taskAssignments.id, assignmentId));\n  }\n\n  // Task history operations\n  async createTaskHistory(\n    taskId: string,\n    changedById: string,\n    action: string,\n    previousValue?: any,\n    newValue?: any,\n    notes?: string\n  ): Promise<TaskHistory> {\n    const [history] = await db\n      .insert(taskHistory)\n      .values({\n        taskId,\n        changedById,\n        action,\n        previousValue,\n        newValue,\n        notes,\n      })\n      .returning();\n    return history;\n  }\n\n  async getTaskHistory(taskId: string): Promise<TaskHistory[]> {\n    return await db\n      .select()\n      .from(taskHistory)\n      .where(eq(taskHistory.taskId, taskId))\n      .orderBy(desc(taskHistory.createdAt));\n  }\n\n  // Worklog operations\n  async createWorklog(worklog: InsertWorklog): Promise<Worklog> {\n    const [created] = await db.insert(worklogs).values(worklog).returning();\n    return created;\n  }\n\n  async getWorklogsByTask(taskId: string): Promise<Worklog[]> {\n    return await db\n      .select()\n      .from(worklogs)\n      .where(eq(worklogs.taskId, taskId))\n      .orderBy(desc(worklogs.createdAt));\n  }\n\n  async getWorklogsByTeamMember(teamMemberId: string): Promise<Worklog[]> {\n    return await db\n      .select()\n      .from(worklogs)\n      .where(eq(worklogs.teamMemberId, teamMemberId))\n      .orderBy(desc(worklogs.createdAt));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":16859},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"design_guidelines.md":{"content":"# Admin Dashboard Design Guidelines\n\n## Design Approach\n\n**Design System**: Material Design principles with Carbon Design data patterns for enterprise admin functionality. This dashboard prioritizes information density, workflow efficiency, and data clarity over aesthetic appeal.\n\n**Key Principles**:\n- Information hierarchy through clear visual structure\n- Efficient task completion with minimal clicks\n- Scannable data presentation\n- Consistent, predictable interactions\n\n## Typography\n\n**Font Family**: Inter or Roboto via Google Fonts CDN\n\n**Hierarchy**:\n- Page titles: text-3xl font-semibold\n- Section headers: text-xl font-medium\n- Card titles: text-lg font-medium  \n- Body text: text-base font-normal\n- Labels/metadata: text-sm font-normal\n- Table headers: text-xs font-semibold uppercase tracking-wide\n- Metrics/stats: text-4xl font-bold (large numbers)\n\n## Layout System\n\n**Spacing Scale**: Use Tailwind units of 2, 4, 6, and 8 consistently (p-2, p-4, p-6, p-8, gap-4, space-y-6, etc.)\n\n**Grid Structure**:\n- Main container: max-w-7xl mx-auto px-6\n- Dashboard cards: grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\n- Metric cards: grid grid-cols-2 md:grid-cols-4 gap-4\n- Sidebar + content: grid grid-cols-[240px_1fr] gap-6\n\n## Component Library\n\n### Navigation\n**Top Navigation Bar**:\n- Full-width sticky header (h-16)\n- Logo/brand left, user profile/logout right\n- Service switcher dropdown (Metabase, Chatwoot, Typebot, Mailcow)\n\n**Sidebar Navigation** (240px fixed width):\n- Dashboard, User Management, Analytics, Activity Logs, Configuration\n- Active state with visual indicator (border-l-4)\n- Icons from Heroicons (outline style)\n- Collapsible on mobile\n\n### Dashboard Cards\n**Metric Cards**:\n- Compact design with metric value (text-4xl), label (text-sm), and change indicator\n- Grid layout for 4 metrics across desktop\n- Icon in top-right corner\n- min-h-32 for consistency\n\n**Service Status Cards**:\n- Service name, status badge, last sync time, action button\n- 2-column grid on desktop, stack on mobile\n\n### Data Tables\n**User Management Table**:\n- Sticky header row\n- Columns: Avatar, Name, Email, Role, Platform, Status, Actions\n- Row actions: Edit (pencil icon), Deactivate (ban icon), Delete (trash icon)\n- Pagination controls at bottom (10/25/50 per page)\n- Search bar above table (w-full md:w-96)\n- Filter dropdowns (Platform, Role, Status) - inline above table\n\n**Activity Log Table**:\n- Columns: Timestamp, Admin, Action, Target User, Platform, Details\n- Expandable row for detailed logs\n- Date range filter\n\n### Forms\n**User Creation/Edit Modal**:\n- Modal overlay (fixed inset-0)\n- Modal content (max-w-2xl centered)\n- Form fields: Full Name, Email, Role (select), Platform (multi-select checkboxes)\n- Two-button footer: Cancel (secondary), Save (primary)\n\n**Configuration Form**:\n- Accordion sections for each service (Metabase, Chatwoot, Typebot, Mailcow)\n- Fields: API URL, API Key, Enable/Disable toggle\n- Test Connection button per service\n\n### Analytics Components\n**Chart Cards**:\n- Card container with header (title + time range selector)\n- Chart.js or similar library integration areas\n- Types needed: Line charts (conversations over time), Bar charts (user activity), Pie charts (platform distribution)\n- min-h-80 for chart containers\n\n**Stat Comparison Grid**:\n- Side-by-side platform metrics\n- 4-column grid: platform name, active users, conversations/submissions, growth %\n\n### UI Elements\n**Badges**:\n- Status: Active, Inactive, Suspended (rounded-full px-2 py-1 text-xs)\n- Platform tags: rounded px-2 py-1 text-xs\n\n**Buttons**:\n- Primary: px-4 py-2 rounded font-medium\n- Secondary: px-4 py-2 rounded border-2\n- Icon buttons: p-2 rounded (for table actions)\n- Danger: red treatment for delete actions\n\n**Dropdown Menus**:\n- User profile menu (top-right)\n- Action menus in tables (three-dot icon)\n- Filter dropdowns\n\n**Search & Filters**:\n- Search input with magnifying glass icon\n- Filter chips showing active filters (dismissible)\n\n### Empty States\n- Icon + message + action button\n- \"No users found\" - Create First User button\n- \"No activity yet\" - explanatory text\n\n## Page Layouts\n\n**Dashboard Home**:\n- 4 metric cards at top (grid-cols-4)\n- 2-column section: Recent Activity (left) + Quick Actions (right)\n- Service status cards grid below\n\n**User Management**:\n- Page header with title + \"Add User\" button (right-aligned)\n- Search and filters row\n- Data table filling remaining space\n- Pagination footer\n\n**Analytics**:\n- Time range selector (top-right)\n- Platform selector tabs\n- 3-chart layout: 2 side-by-side, 1 full-width below\n- Metric comparison table at bottom\n\n**Activity Logs**:\n- Date range filter + export button\n- Full-width table with detailed view\n\n**Configuration**:\n- Accordion list of services\n- Save button (sticky footer)\n\n## Interaction Patterns\n\n**Modal Workflows**: User creation, editing, deletion confirmations\n**Inline Editing**: Quick role/status changes in tables  \n**Toast Notifications**: Success/error messages (top-right, auto-dismiss)\n**Loading States**: Skeleton screens for tables, spinner for actions\n**Confirmation Dialogs**: For destructive actions (delete user)\n\n## Accessibility\n\n- All interactive elements keyboard accessible\n- ARIA labels on icon-only buttons\n- Focus indicators on all inputs and buttons\n- Sufficient contrast ratios (handled by design system)\n- Table headers properly associated with data\n\n## Images\n\nNo hero images or marketing imagery. This is a pure utility interface. Icons only from Heroicons (outline style for navigation, solid for status indicators).","size_bytes":5569},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User, RoleType, PermissionType } from \"@shared/schema\";\nimport { PERMISSION_TYPES, ROLE_TYPES } from \"@shared/schema\";\n\nexport interface AuthenticatedTeamMember {\n  id: string;\n  userId: string | null;\n  departmentId: string;\n  roleId: string | null;\n  employeeId: string | null;\n  email: string;\n  firstName: string;\n  lastName: string;\n  role: string;\n  phone: string | null;\n  status: string;\n  lastLoginAt: Date | null;\n  createdAt: Date | null;\n  updatedAt: Date | null;\n  roleName?: string;\n  roleCode?: RoleType;\n  roleLevel?: number;\n  departmentCode?: string;\n  departmentName?: string;\n  permissions?: string[];\n}\n\nexport interface AuthUser extends User {\n  teamMember?: AuthenticatedTeamMember | null;\n}\n\nexport function useAuth() {\n  const { data, isLoading, error } = useQuery<AuthUser>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  const user = data;\n  const teamMember = data?.teamMember;\n\n  const hasPermission = (permission: PermissionType): boolean => {\n    if (!teamMember?.permissions) return false;\n    return teamMember.permissions.includes(permission);\n  };\n\n  const hasAnyPermission = (permissions: PermissionType[]): boolean => {\n    if (!teamMember?.permissions) return false;\n    return permissions.some(p => teamMember.permissions?.includes(p));\n  };\n\n  const hasAllPermissions = (permissions: PermissionType[]): boolean => {\n    if (!teamMember?.permissions) return false;\n    return permissions.every(p => teamMember.permissions?.includes(p));\n  };\n\n  const isRole = (roleCode: RoleType): boolean => {\n    return teamMember?.roleCode === roleCode;\n  };\n\n  const isRoleOrHigher = (roleCode: RoleType): boolean => {\n    const roleLevels: Record<RoleType, number> = {\n      [ROLE_TYPES.TECHNICIAN]: 1,\n      [ROLE_TYPES.DEPARTMENT_ADMIN]: 2,\n      [ROLE_TYPES.MANAGEMENT]: 3,\n    };\n    \n    const requiredLevel = roleLevels[roleCode];\n    return (teamMember?.roleLevel ?? 0) >= requiredLevel;\n  };\n\n  const isManagement = isRole(ROLE_TYPES.MANAGEMENT);\n  const isDepartmentAdmin = isRole(ROLE_TYPES.DEPARTMENT_ADMIN);\n  const isTechnician = isRole(ROLE_TYPES.TECHNICIAN);\n\n  return {\n    user,\n    teamMember,\n    isLoading,\n    error,\n    isAuthenticated: !!user,\n    isTeamMember: !!teamMember,\n    hasPermission,\n    hasAnyPermission,\n    hasAllPermissions,\n    isRole,\n    isRoleOrHigher,\n    isManagement,\n    isDepartmentAdmin,\n    isTechnician,\n    PERMISSION_TYPES,\n    ROLE_TYPES,\n  };\n}\n","size_bytes":2506},"server/index-prod.ts":{"content":"import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport express, { type Express } from \"express\";\nimport runApp from \"./app\";\n\nexport async function serveStatic(app: Express, _server: Server) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n\n(async () => {\n  await runApp(serveStatic);\n})();\n","size_bytes":712},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Button } from \"@/components/ui/button\";\nimport { LogOut } from \"lucide-react\";\nimport Landing from \"@/pages/landing\";\nimport Login from \"@/pages/login\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Users from \"@/pages/users\";\nimport Analytics from \"@/pages/analytics\";\nimport ActivityPage from \"@/pages/activity\";\nimport Config from \"@/pages/config\";\nimport Departments from \"@/pages/departments\";\nimport Team from \"@/pages/team\";\nimport Tasks from \"@/pages/tasks\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction AuthenticatedLayout({ children }: { children: React.ReactNode }) {\n  const { user } = useAuth();\n\n  const handleLogout = () => {\n    window.location.href = \"/api/logout\";\n  };\n\n  return (\n    <SidebarProvider\n      style={\n        {\n          \"--sidebar-width\": \"16rem\",\n          \"--sidebar-width-icon\": \"3rem\",\n        } as React.CSSProperties\n      }\n    >\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between gap-2 p-4 border-b border-border bg-background sticky top-0 z-10\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-2\">\n              <ThemeToggle />\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\" data-testid=\"button-user-menu\">\n                    <Avatar className=\"h-9 w-9\">\n                      <AvatarImage src={user?.profileImageUrl || undefined} className=\"object-cover\" />\n                      <AvatarFallback>\n                        {user?.firstName?.[0] || user?.email?.[0]?.toUpperCase() || \"A\"}\n                      </AvatarFallback>\n                    </Avatar>\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuLabel>\n                    <div className=\"flex flex-col\">\n                      <span className=\"font-medium\">\n                        {user?.firstName && user?.lastName\n                          ? `${user.firstName} ${user.lastName}`\n                          : user?.email || \"Admin\"}\n                      </span>\n                      {user?.email && (\n                        <span className=\"text-xs text-muted-foreground\">{user.email}</span>\n                      )}\n                    </div>\n                  </DropdownMenuLabel>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={handleLogout} data-testid=\"button-logout\">\n                    <LogOut className=\"h-4 w-4 mr-2\" />\n                    Logout\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto p-6 bg-background\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"text-lg text-muted-foreground\">Loading...</div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/login\" component={Login} />\n        <Route component={Landing} />\n      </Switch>\n    );\n  }\n\n  return (\n    <AuthenticatedLayout>\n      <Switch>\n        <Route path=\"/\" component={Dashboard} />\n        <Route path=\"/tasks\" component={Tasks} />\n        <Route path=\"/users\" component={Users} />\n        <Route path=\"/departments\" component={Departments} />\n        <Route path=\"/team\" component={Team} />\n        <Route path=\"/analytics\" component={Analytics} />\n        <Route path=\"/activity\" component={ActivityPage} />\n        <Route path=\"/config\" component={Config} />\n        <Route component={NotFound} />\n      </Switch>\n    </AuthenticatedLayout>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Router />\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":5090},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { LayoutDashboard, Eye, EyeOff, AlertCircle, Loader2 } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\nexport default function Login() {\n  const [, setLocation] = useLocation();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loginMutation = useMutation({\n    mutationFn: async (credentials: { email: string; password: string }) => {\n      return await apiRequest(\"/api/auth/login\", \"POST\", credentials);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      setLocation(\"/\");\n    },\n    onError: (err: any) => {\n      const message = err?.message || \"Login failed. Please check your credentials.\";\n      setError(message);\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    \n    if (!email || !password) {\n      setError(\"Please enter both email and password\");\n      return;\n    }\n\n    loginMutation.mutate({ email, password });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col\">\n      <header className=\"border-b border-border\">\n        <div className=\"container mx-auto px-6 py-4\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"flex h-10 w-10 items-center justify-center rounded-md bg-primary text-primary-foreground\">\n              <LayoutDashboard className=\"h-6 w-6\" />\n            </div>\n            <span className=\"text-xl font-semibold\">Admin Hub</span>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"flex-1 flex items-center justify-center px-6 py-12\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"space-y-1\">\n            <CardTitle className=\"text-2xl font-bold text-center\">Sign In</CardTitle>\n            <CardDescription className=\"text-center\">\n              Enter your credentials to access the platform\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  placeholder=\"you@company.com\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  disabled={loginMutation.isPending}\n                  data-testid=\"input-email\"\n                  autoComplete=\"email\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\">Password</Label>\n                <div className=\"relative\">\n                  <Input\n                    id=\"password\"\n                    type={showPassword ? \"text\" : \"password\"}\n                    placeholder=\"Enter your password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    disabled={loginMutation.isPending}\n                    data-testid=\"input-password\"\n                    autoComplete=\"current-password\"\n                    className=\"pr-10\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"absolute right-0 top-0 h-full px-3 hover:bg-transparent\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    data-testid=\"button-toggle-password\"\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-4 w-4 text-muted-foreground\" />\n                    ) : (\n                      <Eye className=\"h-4 w-4 text-muted-foreground\" />\n                    )}\n                  </Button>\n                </div>\n              </div>\n\n              <Button \n                type=\"submit\" \n                className=\"w-full\" \n                disabled={loginMutation.isPending}\n                data-testid=\"button-submit-login\"\n              >\n                {loginMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Signing in...\n                  </>\n                ) : (\n                  \"Sign In\"\n                )}\n              </Button>\n            </form>\n\n            <div className=\"mt-6 text-center text-sm text-muted-foreground\">\n              <p>Demo Accounts (password: admin123)</p>\n              <div className=\"mt-2 space-y-1 text-xs\">\n                <p><strong>Management:</strong> admin@company.com</p>\n                <p><strong>Dept Admin:</strong> ha.admin@company.com</p>\n                <p><strong>Technician:</strong> ha.tech1@company.com</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </main>\n    </div>\n  );\n}\n","size_bytes":5702},"server/seed.ts":{"content":"import { db } from \"./db\";\nimport { \n  roles, \n  permissions, \n  rolePermissions, \n  departments, \n  teamMembers,\n  ROLE_TYPES,\n  PERMISSION_TYPES \n} from \"@shared/schema\";\nimport bcrypt from \"bcryptjs\";\nimport { eq } from \"drizzle-orm\";\n\nasync function seed() {\n  console.log(\"Starting database seed...\");\n\n  try {\n    // Check if already seeded\n    const existingRoles = await db.select().from(roles);\n    if (existingRoles.length > 0) {\n      console.log(\"Database already seeded. Skipping...\");\n      return;\n    }\n\n    // 1. Create Roles\n    console.log(\"Creating roles...\");\n    const rolesData = [\n      { \n        name: \"Technician\", \n        code: ROLE_TYPES.TECHNICIAN, \n        description: \"Field technician with basic task access\", \n        level: 1 \n      },\n      { \n        name: \"Department Admin\", \n        code: ROLE_TYPES.DEPARTMENT_ADMIN, \n        description: \"Department administrator with user management within their department\", \n        level: 2 \n      },\n      { \n        name: \"Management\", \n        code: ROLE_TYPES.MANAGEMENT, \n        description: \"Full access to all departments and global user management\", \n        level: 3 \n      },\n    ];\n\n    const insertedRoles = await db.insert(roles).values(rolesData).returning();\n    console.log(`Created ${insertedRoles.length} roles`);\n\n    const roleMap = {\n      [ROLE_TYPES.TECHNICIAN]: insertedRoles.find(r => r.code === ROLE_TYPES.TECHNICIAN)!,\n      [ROLE_TYPES.DEPARTMENT_ADMIN]: insertedRoles.find(r => r.code === ROLE_TYPES.DEPARTMENT_ADMIN)!,\n      [ROLE_TYPES.MANAGEMENT]: insertedRoles.find(r => r.code === ROLE_TYPES.MANAGEMENT)!,\n    };\n\n    // 2. Create Permissions\n    console.log(\"Creating permissions...\");\n    const permissionsData = [\n      { name: \"View Tasks\", code: PERMISSION_TYPES.VIEW_TASKS, description: \"View assigned tasks\", category: \"tasks\" },\n      { name: \"Create Task\", code: PERMISSION_TYPES.CREATE_TASK, description: \"Create new tasks\", category: \"tasks\" },\n      { name: \"Update Task\", code: PERMISSION_TYPES.UPDATE_TASK, description: \"Update task details and status\", category: \"tasks\" },\n      { name: \"Delete Task\", code: PERMISSION_TYPES.DELETE_TASK, description: \"Delete tasks\", category: \"tasks\" },\n      { name: \"Assign Task\", code: PERMISSION_TYPES.ASSIGN_TASK, description: \"Assign tasks to technicians\", category: \"tasks\" },\n      { name: \"View Own Department\", code: PERMISSION_TYPES.VIEW_OWN_DEPARTMENT, description: \"View own department data\", category: \"dashboard\" },\n      { name: \"View All Departments\", code: PERMISSION_TYPES.VIEW_ALL_DEPARTMENTS, description: \"View all departments data\", category: \"dashboard\" },\n      { name: \"View Department Dashboard\", code: PERMISSION_TYPES.VIEW_DEPARTMENT_DASHBOARD, description: \"View department dashboard\", category: \"dashboard\" },\n      { name: \"View Global Dashboard\", code: PERMISSION_TYPES.VIEW_GLOBAL_DASHBOARD, description: \"View global dashboard with all stats\", category: \"dashboard\" },\n      { name: \"Manage Department Users\", code: PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS, description: \"Add/edit/deactivate users in own department\", category: \"users\" },\n      { name: \"Manage Global Users\", code: PERMISSION_TYPES.MANAGE_GLOBAL_USERS, description: \"Full user management across all departments\", category: \"users\" },\n      { name: \"View Department Logs\", code: PERMISSION_TYPES.VIEW_DEPARTMENT_LOGS, description: \"View activity logs for own department\", category: \"logs\" },\n      { name: \"View All Logs\", code: PERMISSION_TYPES.VIEW_ALL_LOGS, description: \"View all activity logs\", category: \"logs\" },\n      { name: \"Manage Service Config\", code: PERMISSION_TYPES.MANAGE_SERVICE_CONFIG, description: \"Configure external service integrations\", category: \"settings\" },\n      { name: \"View Analytics\", code: PERMISSION_TYPES.VIEW_ANALYTICS, description: \"View analytics and metrics\", category: \"analytics\" },\n      { name: \"Submit Worklog\", code: PERMISSION_TYPES.SUBMIT_WORKLOG, description: \"Submit work time and notes\", category: \"tasks\" },\n    ];\n\n    const insertedPermissions = await db.insert(permissions).values(permissionsData).returning();\n    console.log(`Created ${insertedPermissions.length} permissions`);\n\n    const permMap: Record<string, typeof insertedPermissions[0]> = {};\n    insertedPermissions.forEach(p => {\n      permMap[p.code] = p;\n    });\n\n    // 3. Create Role-Permission mappings\n    console.log(\"Mapping permissions to roles...\");\n    \n    // Technician permissions\n    const technicianPerms = [\n      PERMISSION_TYPES.VIEW_TASKS,\n      PERMISSION_TYPES.UPDATE_TASK,\n      PERMISSION_TYPES.VIEW_OWN_DEPARTMENT,\n      PERMISSION_TYPES.SUBMIT_WORKLOG,\n    ];\n\n    // Department Admin permissions (includes technician perms)\n    const deptAdminPerms = [\n      ...technicianPerms,\n      PERMISSION_TYPES.CREATE_TASK,\n      PERMISSION_TYPES.DELETE_TASK,\n      PERMISSION_TYPES.ASSIGN_TASK,\n      PERMISSION_TYPES.VIEW_DEPARTMENT_DASHBOARD,\n      PERMISSION_TYPES.MANAGE_DEPARTMENT_USERS,\n      PERMISSION_TYPES.VIEW_DEPARTMENT_LOGS,\n      PERMISSION_TYPES.VIEW_ANALYTICS,\n    ];\n\n    // Management permissions (all permissions)\n    const managementPerms = Object.values(PERMISSION_TYPES);\n\n    const rolePermissionsData = [\n      ...technicianPerms.map(perm => ({\n        roleId: roleMap[ROLE_TYPES.TECHNICIAN].id,\n        permissionId: permMap[perm].id,\n      })),\n      ...deptAdminPerms.map(perm => ({\n        roleId: roleMap[ROLE_TYPES.DEPARTMENT_ADMIN].id,\n        permissionId: permMap[perm].id,\n      })),\n      ...managementPerms.map(perm => ({\n        roleId: roleMap[ROLE_TYPES.MANAGEMENT].id,\n        permissionId: permMap[perm].id,\n      })),\n    ];\n\n    await db.insert(rolePermissions).values(rolePermissionsData);\n    console.log(`Created ${rolePermissionsData.length} role-permission mappings`);\n\n    // 4. Create Departments\n    console.log(\"Creating departments...\");\n    const departmentsData = [\n      { name: \"Home Appliances\", code: \"HA\", description: \"Home Appliances Division - Repairs and maintenance\", status: \"active\" as const },\n      { name: \"Home Entertainment Products\", code: \"HHP\", description: \"Home Entertainment Products - TVs, audio systems\", status: \"active\" as const },\n      { name: \"Digital Television\", code: \"DTV\", description: \"Digital Television Services - Installation and support\", status: \"active\" as const },\n    ];\n\n    const insertedDepts = await db.insert(departments).values(departmentsData).returning();\n    console.log(`Created ${insertedDepts.length} departments`);\n\n    const deptMap: Record<string, typeof insertedDepts[0]> = {};\n    insertedDepts.forEach(d => {\n      deptMap[d.code] = d;\n    });\n\n    // 5. Create Default Admin User (Management)\n    console.log(\"Creating default admin user...\");\n    const passwordHash = await bcrypt.hash(\"admin123\", 10);\n    \n    const adminUser = await db.insert(teamMembers).values({\n      departmentId: deptMap[\"HA\"].id,\n      roleId: roleMap[ROLE_TYPES.MANAGEMENT].id,\n      employeeId: \"ADMIN001\",\n      email: \"admin@company.com\",\n      firstName: \"System\",\n      lastName: \"Administrator\",\n      role: \"admin\",\n      passwordHash: passwordHash,\n      phone: \"\",\n      status: \"active\",\n    }).returning();\n\n    console.log(\"Created admin user: admin@company.com / admin123\");\n\n    // 6. Create sample users for each role/department\n    console.log(\"Creating sample users...\");\n    \n    const sampleUsers = [\n      // Department Admins for each department\n      {\n        departmentId: deptMap[\"HA\"].id,\n        roleId: roleMap[ROLE_TYPES.DEPARTMENT_ADMIN].id,\n        employeeId: \"HA-ADMIN\",\n        email: \"ha.admin@company.com\",\n        firstName: \"HA\",\n        lastName: \"Admin\",\n        role: \"admin\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n      {\n        departmentId: deptMap[\"HHP\"].id,\n        roleId: roleMap[ROLE_TYPES.DEPARTMENT_ADMIN].id,\n        employeeId: \"HHP-ADMIN\",\n        email: \"hhp.admin@company.com\",\n        firstName: \"HHP\",\n        lastName: \"Admin\",\n        role: \"admin\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n      {\n        departmentId: deptMap[\"DTV\"].id,\n        roleId: roleMap[ROLE_TYPES.DEPARTMENT_ADMIN].id,\n        employeeId: \"DTV-ADMIN\",\n        email: \"dtv.admin@company.com\",\n        firstName: \"DTV\",\n        lastName: \"Admin\",\n        role: \"admin\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n      // Technicians for each department\n      {\n        departmentId: deptMap[\"HA\"].id,\n        roleId: roleMap[ROLE_TYPES.TECHNICIAN].id,\n        employeeId: \"HA-TECH1\",\n        email: \"ha.tech1@company.com\",\n        firstName: \"John\",\n        lastName: \"Smith\",\n        role: \"technician\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n      {\n        departmentId: deptMap[\"HHP\"].id,\n        roleId: roleMap[ROLE_TYPES.TECHNICIAN].id,\n        employeeId: \"HHP-TECH1\",\n        email: \"hhp.tech1@company.com\",\n        firstName: \"Jane\",\n        lastName: \"Doe\",\n        role: \"technician\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n      {\n        departmentId: deptMap[\"DTV\"].id,\n        roleId: roleMap[ROLE_TYPES.TECHNICIAN].id,\n        employeeId: \"DTV-TECH1\",\n        email: \"dtv.tech1@company.com\",\n        firstName: \"Mike\",\n        lastName: \"Johnson\",\n        role: \"technician\",\n        passwordHash: passwordHash,\n        status: \"active\" as const,\n      },\n    ];\n\n    await db.insert(teamMembers).values(sampleUsers);\n    console.log(`Created ${sampleUsers.length} sample users`);\n\n    console.log(\"\\n=== Seed Complete ===\");\n    console.log(\"\\nTest Accounts (password: admin123):\");\n    console.log(\"Management: admin@company.com\");\n    console.log(\"HA Dept Admin: ha.admin@company.com\");\n    console.log(\"HHP Dept Admin: hhp.admin@company.com\");\n    console.log(\"DTV Dept Admin: dtv.admin@company.com\");\n    console.log(\"HA Technician: ha.tech1@company.com\");\n    console.log(\"HHP Technician: hhp.tech1@company.com\");\n    console.log(\"DTV Technician: dtv.tech1@company.com\");\n\n  } catch (error) {\n    console.error(\"Seed error:\", error);\n    throw error;\n  }\n}\n\nseed()\n  .then(() => {\n    console.log(\"Seed completed successfully\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"Seed failed:\", error);\n    process.exit(1);\n  });\n","size_bytes":10406}},"version":2}